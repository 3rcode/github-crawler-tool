Index,Message,Description,Message Abstract,Description Abstract
1,Add missing shortcut in documentation,MOD+Backspace also triggers BACK.,Add missing shortcut in documentation,MOD+Backspace also triggers BACK.
2,Document installation via winget on Windows,PR #4005 https://github.com/Genymobile/scrcpy/pull/4005 Refs #1444 https://github.com/Genymobile/scrcpy/issues/1444 Refs #3932 https://github.com/Genymobile/scrcpy/issues/3932 Signed-off-by: Romain Vimont rom@rom1v.com,Document installation via winget on Windows,PR #4005 link Refs #1444 link Refs #3932 link Signed-off-by: Romain Vimont rom@rom1v.com
3,Clarify API versions that support Audio Forwarding,Reword the supported API versions for audio forwarding sentence to clarify that it supports API >= 30 PR #3949 https://github.com/Genymobile/scrcpy/pull/3949 Signed-off-by: Romain Vimont rom@rom1v.com,Clarify API versions that support Audio Forwarding,Reword the supported API versions for audio forwarding sentence to clarify that it supports API >= 30 PR #3949 link Signed-off-by: Romain Vimont rom@rom1v.com
4,Specify in README that OTG does not require adb,,Specify in README that OTG does not require adb,
5,Fix documentation link in FAQ,,Fix documentation link in FAQ,
6,Fix typo in FAQ,,Fix typo in FAQ,
7,Mention necessary reboot,"After setting ""USB debugging (security settings)"", a reboot is necessary.",Mention necessary reboot,"After setting ""USB debugging (security settings)"", a reboot is necessary."
8,Reference FAQ from HID/OTG documentation,"Reference the FAQ section about ""HID/OTG issues on Windows"" from the HID/OTG documentation.",Reference FAQ from HID/OTG documentation,"Reference the FAQ section about ""HID/OTG issues on Windows"" from the HID/OTG documentation."
9,"Replace ""bit-rate"" with ""bit rate""",,"Replace ""bit-rate"" with ""bit rate""",
10,Fix typo in doc/audio.md,"The documentation is about audio bit rate, not video bit rate. PR #3839 https://github.com/Genymobile/scrcpy/pull/3839 Signed-off-by: Romain Vimont rom@rom1v.com",Fix typo in doc/audio.md,"The documentation is about audio bit rate, not video bit rate. PR #3839 link Signed-off-by: Romain Vimont rom@rom1v.com"
11,Clarify V4L2 feature in README,The previous formulation could suggest that the device camera could be used as a webcam. This is not the case (yet?).,Clarify V4L2 feature in README,The previous formulation could suggest that the device camera could be used as a webcam. This is not the case (yet?).
12,Document missing Opus encoder error,And how to solve it.,Document missing Opus encoder error,And how to solve it.
13,Update Gentoo instructions,"scrcpy is available directly in the distro, drop link to the overlay (which only contains older versions). PR #3816 https://github.com/Genymobile/scrcpy/pull/3816 Signed-off-by: Romain Vimont rom@rom1v.com",Update Gentoo instructions,"scrcpy is available directly in the distro, drop link to the overlay (which only contains older versions). PR #3816 link Signed-off-by: Romain Vimont rom@rom1v.com"
14,Update broken link in documentation,The Android documentation has been updated.,Update broken link in documentation,The Android documentation has been updated.
15,Replace link to enable USB debugging in README,Link to a more relevant page in the official documentation to enable USB debugging.,Replace link to enable USB debugging in README,Link to a more relevant page in the official documentation to enable USB debugging.
16,Add references to prerequisites,"Users sometimes only read the OS-specific instructions, they must be aware of the prerequisites.",Add references to prerequisites,"Users sometimes only read the OS-specific instructions, they must be aware of the prerequisites."
17,Add blogpost link about scrcpy 2.0,,Add blogpost link about scrcpy 2.0,
18,Fix v4l2 sink,"The codec id to write as codec parameters is the one from the v4l2 encoder, not from the decoder. Regression introduced by be985b8242e0626288674b84c5039725170f8f0c. Fixes #3795 https://github.com/Genymobile/scrcpy/issues/3795",Fix v4l2 sink,"The codec id to write as codec parameters is the one from the v4l2 encoder, not from the decoder. Regression introduced by be985b8242e0626288674b84c5039725170f8f0c. Fixes #3795 link"
19,Fix build issue on FFmpeg < 5.1,An include was missing. Fixes #3783 https://github.com/Genymobile/scrcpy/issues/3783,Fix build issue on FFmpeg < 5.1,An include was missing. Fixes #3783 link
20,Fix comparison warning,An int was compared with an unsigned: ../app/src/audio_player.c:290:27: warning: comparison of integers of different signs: 'int' and 'unsigned int' [-Wsign-compare]             if (abs(diff) < ap->sample_rate / 1000) {                 ~~~~~~~~~ ^ ~~~~~~~~~~~~~~~~~~~~~~,Fix comparison warning,An int was compared with an unsigned: ../app/src/audio_player.c:290:27: warning: comparison of integers of different signs: 'int' and 'unsigned int' [-Wsign-compare]             if (abs(diff) < ap->sample_rate / 1000) {                 ~~~~~~~~~ ^ ~~~~~~~~~~~~~~~~~~~~~~
21,"Fix an ""expected expression"" error","In C, a label can only be followed by a statement, not a declaration. An error in app/src/screen.c violated this, and led to a build error with an error message similar to the one below: ../app/src/screen.c:821:13: error: expected expression             bool ok = sc_screen_init_size(screen);             ^ /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/13.0.0/include/stdbool.h:15:14: note: expanded from macro 'bool' #define bool _Bool              ^ ../app/src/screen.c:822:18: error: use of undeclared identifier 'ok'             if (!ok) {                  ^ 2 errors generated.  This could be fixed by introducing a new block (or compound statement; as is already being done in the next case). That is a statement. Fixes #3785 https://github.com/Genymobile/scrcpy/issues/3785 PR #3787 https://github.com/Genymobile/scrcpy/pull/3787 Signed-off-by: Ruoyu Zhong zhongruoyu@outlook.com Signed-off-by: Romain Vimont rom@rom1v.com","Fix an ""expected expression"" error","In C, a label can only be followed by a statement, not a declaration. An error in app/src/screen.c violated this, and led to a build error with an error message similar to the one below: ../app/src/screen.c:821:13: error: expected expression             bool ok = sc_screen_init_size(screen);             ^ /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/13.0.0/include/stdbool.h:15:14: note: expanded from macro 'bool' define bool _Bool module ../app/src/screen.c:822:18: error: use of undeclared identifier 'ok'             if (!ok) {                  ^ 2 errors generated. This could be fixed by introducing a new block (or compound statement; as is already being done in the next case). That is a statement. Fixes #3785 link PR #3787 link Signed-off-by: Ruoyu Zhong zhongruoyu@outlook.com Signed-off-by: Romain Vimont rom@rom1v.com"
22,Fix broken link in Windows download page,,Fix broken link in Windows download page,
23,Fix broken link in shortcuts documentation,,Fix broken link in shortcuts documentation,
24,Update links to v2.0,,Update links to v2.0,
25,Bump version to 2.0,,Bump version to 2.0,
26,Merge branch 'master' into dev,,Merge branch 'master' into dev,
27,Rework README and documentation,The README.md page is HUGE. Split it up. Also document audio forwarding and improve installation instructions for each platform and user documentation. PR #3774 https://github.com/Genymobile/scrcpy/pull/3774,Rework README and documentation,The README.md page is HUGE. Split it up. Also document audio forwarding and improve installation instructions for each platform and user documentation. PR #3774 link
28,Happy new year 2023!,,Happy new year 2023!,
29,Document audio player,Add some high-level documentation on the audio player implementation.,Document audio player,Add some high-level documentation on the audio player implementation.
30,Apply new compensation only if it changed,"If the compensation is the same (typically when it is 0), do not reapply it.",Apply new compensation only if it changed,"If the compensation is the same (typically when it is 0), do not reapply it."
31,Disable clock drift compensation for tiny values,"For less than 1ms, the estimated drift is just noise.",Disable clock drift compensation for tiny values,"For less than 1ms, the estimated drift is just noise."
32,Fail on deprecated options,Suggest the video and audio specific options instead.,Fail on deprecated options,Suggest the video and audio specific options instead.
33,Remove dead code about the deprecated -F option,The -F option was already removed.,Remove dead code about the deprecated -F option,The -F option was already removed.
34,Remove deprecated option --render-expired-frames,This option did nothing since it was deprecated. Totally remove it.,Remove deprecated option --render-expired-frames,This option did nothing since it was deprecated. Totally remove it.
35,Upgrade platform-tools (34.0.1) for Windows,Include the latest version of adb in Windows releases.,Upgrade platform-tools (34.0.1) for Windows,Include the latest version of adb in Windows releases.
36,Upgrade SDL (2.26.4) for Windows,Include the latest version of SDL in Windows releases.,Upgrade SDL (2.26.4) for Windows,Include the latest version of SDL in Windows releases.
37,Remove unused IOException,IOException may not be thrown from this method.,Remove unused IOException,IOException may not be thrown from this method.
38,Compute buffering and compensation without lock,"Once underflow has been read with a lock, the buffering and compensation may be performed without shared variables.",Compute buffering and compensation without lock,"Once underflow has been read with a lock, the buffering and compensation may be performed without shared variables."
39,Do not read avg_buffering from the player thread,"On buffer underflow, the average buffering must be updated, but it is intended to be accessed only from the receiver thread. Make the player and the receiver thread communicate the underflow via a new field (ap->underflow).",Do not read avg_buffering from the player thread,"On buffer underflow, the average buffering must be updated, but it is intended to be accessed only from the receiver thread. Make the player and the receiver thread communicate the underflow via a new field (ap->underflow)."
40,Simplify bytebuf naming,Rename read_available to can_read and write_available to can_write. This is more readable.,Simplify bytebuf naming,Rename read_available to can_read and write_available to can_write. This is more readable.
41,Add audio sample ring-buffer,"Add a thin wrapper around bytebuf to handle samples instead of bytes. This simplifies the audio player, which mostly handles samples.",Add audio sample ring-buffer,"Add a thin wrapper around bytebuf to handle samples instead of bytes. This simplifies the audio player, which mostly handles samples."
42,Define the audio output buffer in milliseconds,"In theory, this buffer must be dimensioned for a target duration, so its size in bytes should depend on the sample rate.",Define the audio output buffer in milliseconds,"In theory, this buffer must be dimensioned for a target duration, so its size in bytes should depend on the sample rate."
43,Pass video size as codec metadata,"On initial connection, scrcpy sent some device metadata:  - the device name (to be used as window title)  - the initial video size (before any frame or even SPS/PPS) But it is better to provide the initial video size as part as the video stream, so that it can be demuxed and exposed via AVCodecContext to sinks. This avoids to pass an explicit ""initial frame size"" for the screen, the recorder and the v4l2 sink.",Pass video size as codec metadata,"On initial connection, scrcpy sent some device metadata:  - the device name (to be used as window title)  - the initial video size (before any frame or even SPS/PPS) But it is better to provide the initial video size as part as the video stream, so that it can be demuxed and exposed via AVCodecContext to sinks. This avoids to pass an explicit ""initial frame size"" for the screen, the recorder and the v4l2 sink."
44,Report errors on screen event error,Make scrcpy fail if an important screen event (like frame update) fails.,Report errors on screen event error,Make scrcpy fail if an important screen event (like frame update) fails.
45,Rename sendCodecId to sendCodecMeta,This will allow the codec header to contain more than the codec id.,Rename sendCodecId to sendCodecMeta,This will allow the codec header to contain more than the codec id.
46,Copy codec parameters from context,"Now that the recorder have access to the codec context, it may automatically initialize the stream codec parameters. The V4L2 sink could do the same.",Copy codec parameters from context,"Now that the recorder have access to the codec context, it may automatically initialize the stream codec parameters. The V4L2 sink could do the same."
47,Simplify recorder,"After the refactor performed by the previous commit, the functions to wait the video stream and the audio stream could be inlined.",Simplify recorder,"After the refactor performed by the previous commit, the functions to wait the video stream and the audio stream could be inlined."
48,Create recorder streams from packet sinks ops,"Previously, the packet sink push() implementation just set the codec and notified a wait condition. Then the recorder thread read the codec and created the AVStream. But this was racy: an AVFrame could be pushed before the creation of the AVStream, causing its video_stream_index or audio_stream_index to be initialized to -1. Also, in the future, the AVStream initialization might need data provided by the packet sink open(), so initialize it there (with a mutex).",Create recorder streams from packet sinks ops,"Previously, the packet sink push() implementation just set the codec and notified a wait condition. Then the recorder thread read the codec and created the AVStream. But this was racy: an AVFrame could be pushed before the creation of the AVStream, causing its video_stream_index or audio_stream_index to be initialized to -1. Also, in the future, the AVStream initialization might need data provided by the packet sink open(), so initialize it there (with a mutex)."
49,Pass AVCodecContext to packet sinks,"Create the codec context from the demuxer, so that it can fill context data for the decoder and recorder.",Pass AVCodecContext to packet sinks,"Create the codec context from the demuxer, so that it can fill context data for the decoder and recorder."
50,Enable log signaling buffering threshold exceeded,It is as important as underflow logs.,Enable log signaling buffering threshold exceeded,It is as important as underflow logs.
51,Stop and join sc_file_pusher only if initialized,"The sc_file_pusher is lazy-initialized, but it was stopped and joined in all cases (accessing uninitialized values). Detected by poisoning the struct scrcpy instance with ASAN enabled.",Stop and join sc_file_pusher only if initialized,"The sc_file_pusher is lazy-initialized, but it was stopped and joined in all cases (accessing uninitialized values). Detected by poisoning the struct scrcpy instance with ASAN enabled."
52,Initialize interrupted field explicitly,The field sc_fps_counter.interrupted was never initialized explicitly. Signed-off-by: Romain Vimont rom@rom1v.com,Initialize interrupted field explicitly,The field sc_fps_counter.interrupted was never initialized explicitly. Signed-off-by: Romain Vimont rom@rom1v.com
53,Decrease recorder thread priority,"Recording is background task, writing the packets to a file is not urgent.",Decrease recorder thread priority,"Recording is background task, writing the packets to a file is not urgent."
54,Increase audio thread priority,The audio demuxer thread is the one filling the audio buffer read by the SDL audio thread. It is time critical to avoid buffer underflow.,Increase audio thread priority,The audio demuxer thread is the one filling the audio buffer read by the SDL audio thread. It is time critical to avoid buffer underflow.
55,Add thread priority API,Expose an API to change the priority of the current thread.,Add thread priority API,Expose an API to change the priority of the current thread.
56,Print info logs to stdout,"All server logs were printed to stdout, while all client logs were printed to stderr. Instead, use stderr for warnings and errors, stdout for the others:  - stdout: verbose, debug, info  - stderr: warn, error",Print info logs to stdout,"All server logs were printed to stdout, while all client logs were printed to stderr. Instead, use stderr for warnings and errors, stdout for the others:  - stdout: verbose, debug, info  - stderr: warn, error"
57,Print server logs and newline in one call,"System.out.println() first prints the message, then the new line. Between these two calls, the client might print a message, breaking formatting. Instead, call System.out.print() with '\n' appended to the message.",Print server logs and newline in one call,"System.out.println() first prints the message, then the new line. Between these two calls, the client might print a message, breaking formatting. Instead, call System.out.print() with '\n' appended to the message."
58,Warn on ignored audio options,"For raw audio codec, some audio options are ignored. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Warn on ignored audio options,"For raw audio codec, some audio options are ignored. PR #3757 link"
59,Add --audio-codec=raw option,Add support for raw (PCM S16 LE) audio codec (a raw decoder is included in FFmpeg). PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Add --audio-codec=raw option,Add support for raw (PCM S16 LE) audio codec (a raw decoder is included in FFmpeg). PR #3757 link
60,Add raw audio recorder,Add an alternative AudioRecorder to stream raw packets without encoding. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Add raw audio recorder,Add an alternative AudioRecorder to stream raw packets without encoding. PR #3757 link
61,Extract async processor interface,"On the server side, several components are started, stopped and joined. Extract an interface to handle them generically. This will help to support both encoded and raw audio stream, because they will be two different concrete components, but implementing the same interface. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Extract async processor interface,"On the server side, several components are started, stopped and joined. Extract an interface to handle them generically. This will help to support both encoded and raw audio stream, because they will be two different concrete components, but implementing the same interface. PR #3757 link"
62,Extract audio capture,"The audio capture was implemented in AudioEncoder. In order to reuse it without encoding, extract it to a separate class. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Extract audio capture,"The audio capture was implemented in AudioEncoder. In order to reuse it without encoding, extract it to a separate class. PR #3757 link"
63,Stop on decoder frame push error,"On push, frame sinks report downstream errors to stop upstream components. Do not ignore the error.",Stop on decoder frame push error,"On push, frame sinks report downstream errors to stop upstream components. Do not ignore the error."
64,Add --audio-buffer,Expose an option to add a buffering delay (in milliseconds) before playing audio. This is similar to the options --display-buffer and --v4l2-buffer for video frames. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Add --audio-buffer,Expose an option to add a buffering delay (in milliseconds) before playing audio. This is similar to the options --display-buffer and --v4l2-buffer for video frames. PR #3757 link
65,Add compat support for FFmpeg < 5.1,The new chlayout API has been introduced in FFmpeg 5.1. Use the old channel_layout API on older versions. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Add compat support for FFmpeg < 5.1,The new chlayout API has been introduced in FFmpeg 5.1. Use the old channel_layout API on older versions. PR #3757 link
66,Add audio player,"Play the decoded audio using SDL. The audio player frame sink receives the audio frames, resample them and write them to a byte buffer (introduced by this commit). On SDL audio callback (from an internal SDL thread), copy samples from this byte buffer to the SDL audio buffer. The byte buffer is protected by the SDL_AudioDeviceLock(), but it has been designed so that the producer and the consumer may write and read in parallel, provided that they don't access the same slices of the ring-buffer buffer. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757 Co-authored-by: Simon Chan 1330321+yume-chan@users.noreply.github.com",Add audio player,"Play the decoded audio using SDL. The audio player frame sink receives the audio frames, resample them and write them to a byte buffer (introduced by this commit). On SDL audio callback (from an internal SDL thread), copy samples from this byte buffer to the SDL audio buffer. The byte buffer is protected by the SDL_AudioDeviceLock(), but it has been designed so that the producer and the consumer may write and read in parallel, provided that they don't access the same slices of the ring-buffer buffer. PR #3757 link Co-authored-by: Simon Chan 1330321+yume-chan@users.noreply.github.com"
67,Optionally do not delay the first frame,"A delay buffer delayed all the frames except the first one, to open the scrcpy window immediately and get a picture. Make this feature optional, so that the delay buffer might also be used for audio (especially for simulating a high delay for debugging). PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Optionally do not delay the first frame,"A delay buffer delayed all the frames except the first one, to open the scrcpy window immediately and get a picture. Make this feature optional, so that the delay buffer might also be used for audio (especially for simulating a high delay for debugging). PR #3757 link"
68,Accept clock estimation with a single point,"If there is only one point, assume the slope is 1. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Accept clock estimation with a single point,"If there is only one point, assume the slope is 1. PR #3757 link"
69,Remove anonymous struct in delay buffer,"For clarity, the fields used only when a delay was set were wrapped in an anonymous structure. Now that the delay buffer has been extracted to a separate component, the delay is necessarily set (it may not be 0), so the fields are always used. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Remove anonymous struct in delay buffer,"For clarity, the fields used only when a delay was set were wrapped in an anonymous structure. Now that the delay buffer has been extracted to a separate component, the delay is necessarily set (it may not be 0), so the fields are always used. PR #3757 link"
70,Use delay buffer as a frame source/sink,"The components needing delayed frames (sc_screen and sc_v4l2_sink) managed a sc_video_buffer instance, which itself embedded a sc_frame_buffer instance (to keep only the most recent frame). In theory, these components should not be aware of delaying: they should just receive AVFrames later, and only handle a sc_frame_buffer. Therefore, refactor sc_delay_buffer as a frame source (it consumes) frames) and a frame sink (it produces frames, after some delay), and plug an instance in the pipeline only when a delay is requested. This also removes the need for a specific sc_video_buffer. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Use delay buffer as a frame source/sink,"The components needing delayed frames (sc_screen and sc_v4l2_sink) managed a sc_video_buffer instance, which itself embedded a sc_frame_buffer instance (to keep only the most recent frame). In theory, these components should not be aware of delaying: they should just receive AVFrames later, and only handle a sc_frame_buffer. Therefore, refactor sc_delay_buffer as a frame source (it consumes) frames) and a frame sink (it produces frames, after some delay), and plug an instance in the pipeline only when a delay is requested. This also removes the need for a specific sc_video_buffer. PR #3757 link"
71,Use frame source trait in decoder,,Use frame source trait in decoder,
72,Introduce frame source trait,"There was a frame sink trait, implemented by components able to receive AVFrames, but each frame source had to manually send frame to sinks. In order to mutualise sink management, add a frame sink trait.",Introduce frame source trait,"There was a frame sink trait, implemented by components able to receive AVFrames, but each frame source had to manually send frame to sinks. In order to mutualise sink management, add a frame sink trait."
73,Use packet source trait in demuxer,,Use packet source trait in demuxer,
74,Introduce packet source trait,"There was a packet sink trait, implemented by components able to receive AVPackets, but each packet source had to manually send packets to sinks. In order to mutualise sink management, add a packet source trait.",Introduce packet source trait,"There was a packet sink trait, implemented by components able to receive AVPackets, but each packet source had to manually send packets to sinks. In order to mutualise sink management, add a packet source trait."
75,Extract sc_delay_buffer,"A video buffer had 2 responsibilities:  - handle the frame delaying mechanism (queuing packets and pushing them    after the expected delay);  - keep only the most recent frame (using a sc_frame_buffer). In order to be able to reuse only the frame delaying mechanism, extract it to a separate component, sc_delay_buffer.",Extract sc_delay_buffer,"A video buffer had 2 responsibilities:  - handle the frame delaying mechanism (queuing packets and pushing them    after the expected delay);  - keep only the most recent frame (using a sc_frame_buffer). In order to be able to reuse only the frame delaying mechanism, extract it to a separate component, sc_delay_buffer."
76,Fix buffering pts conversion,"The mistake had no effect, because tick is also internally expressed in microseconds.",Fix buffering pts conversion,"The mistake had no effect, because tick is also internally expressed in microseconds."
77,Report video buffer downstream errors,Make the video buffer stop if its consumer could not receive a frame.,Report video buffer downstream errors,Make the video buffer stop if its consumer could not receive a frame.
78,Stop the video buffer on error,"If an error occurs from the video buffer thread (typically an out-of-memory error), then stop.",Stop the video buffer on error,"If an error occurs from the video buffer thread (typically an out-of-memory error), then stop."
79,Fix possible race condition on video_buffer end,"The video_buffer thread clears the queue once it is stopped, but new frames might still be pushed asynchronously. To avoid the problem, do not push any frame once the video_buffer is stopped.",Fix possible race condition on video_buffer end,"The video_buffer thread clears the queue once it is stopped, but new frames might still be pushed asynchronously. To avoid the problem, do not push any frame once the video_buffer is stopped."
80,Remove sc_queue,All uses have been replaced by VecDeque.,Remove sc_queue,All uses have been replaced by VecDeque.
81,Remove cbuf,All uses have been replaced by VecDeque.,Remove cbuf,All uses have been replaced by VecDeque.
82,Use VecDeque in aoa_hid,Replace cbuf by VecDeque in aoa_hid,Use VecDeque in aoa_hid,Replace cbuf by VecDeque in aoa_hid
83,Use VecDeque in file_pusher,"Replace cbuf by VecDeque in file_pusher. As a side-effect, the new implementation does not limit the queue to an arbitrary value.",Use VecDeque in file_pusher,"Replace cbuf by VecDeque in file_pusher. As a side-effect, the new implementation does not limit the queue to an arbitrary value."
84,Use VecDeque in controller,Replace cbuf by VecDeque in controller.,Use VecDeque in controller,Replace cbuf by VecDeque in controller.
85,Use VecDeque in video_buffer,"The packets queued for buffering were wrapped in a dynamically allocated structure with a ""next"" field. To avoid this additional layer of allocation and indirection, use a VecDeque.",Use VecDeque in video_buffer,"The packets queued for buffering were wrapped in a dynamically allocated structure with a ""next"" field. To avoid this additional layer of allocation and indirection, use a VecDeque."
86,Use VecDeque in recorder,"The packets queued for recording were wrapped in a dynamically allocated structure with a ""next"" field. To avoid this additional layer of allocation and indirection, use a VecDeque.",Use VecDeque in recorder,"The packets queued for recording were wrapped in a dynamically allocated structure with a ""next"" field. To avoid this additional layer of allocation and indirection, use a VecDeque."
87,Introduce VecDeque,Introduce a double-ended queue implemented with a growable ring buffer. Inspired from the Rust VecDeque type: https://doc.rust-lang.org/std/collections/struct.VecDeque.html,Introduce VecDeque,Introduce a double-ended queue implemented with a growable ring buffer. Inspired from the Rust VecDeque type: link
88,Add sc_allocarray() util,"Add a function to allocate an array, which fails safely in the case where the multiplication would overflow.",Add sc_allocarray() util,"Add a function to allocate an array, which fails safely in the case where the multiplication would overflow."
89,Use reallocarray() in sc_vector,This fails safely in case of overflow.,Use reallocarray() in sc_vector,This fails safely in case of overflow.
90,Add compat for reallocarray(),This function fails safely in the case where the multiplication would overflow.,Add compat for reallocarray(),This function fails safely in the case where the multiplication would overflow.
91,Call avcodec_receive_frame() in a loop,"Since in scrcpy a video packet passed to avcodec_send_packet() is always a complete video frame, it is sufficient to call avcodec_receive_frame() exactly once. In practice, it also works for audio packets: the decoder produces exactly 1 frame for 1 input packet. In theory, it is an implementation detail though, so avcodec_receive_frame() should be called in a loop.",Call avcodec_receive_frame() in a loop,"Since in scrcpy a video packet passed to avcodec_send_packet() is always a complete video frame, it is sufficient to call avcodec_receive_frame() exactly once. In practice, it also works for audio packets: the decoder produces exactly 1 frame for 1 input packet. In theory, it is an implementation detail though, so avcodec_receive_frame() should be called in a loop."
92,Add --require-audio,"By default, scrcpy mirrors only the video when audio capture fails on the device. Add an option to force scrcpy to fail if audio is enabled but does not work. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Add --require-audio,"By default, scrcpy mirrors only the video when audio capture fails on the device. Add an option to force scrcpy to fail if audio is enabled but does not work. PR #3757 link"
93,Add workaround to capture audio on Android 11,"On Android 11, it is possible to start the capture only when the running app is in foreground. But scrcpy is not an app, it's a Java application started from shell. As a workaround, start an existing Android shell existing activity just to start the capture, then close it immediately. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757 Co-authored-by: Romain Vimont rom@rom1v.com Signed-off-by: Romain Vimont rom@rom1v.com",Add workaround to capture audio on Android 11,"On Android 11, it is possible to start the capture only when the running app is in foreground. But scrcpy is not an app, it's a Java application started from shell. As a workaround, start an existing Android shell existing activity just to start the capture, then close it immediately. PR #3757 link Co-authored-by: Romain Vimont rom@rom1v.com Signed-off-by: Romain Vimont rom@rom1v.com"
94,Add two-step write feature to bytebuf,"If there is exactly one producer, then it can assume that the remaining space in the buffer will only increase until it writes something. This assumption may allow the producer to write to the buffer (up to a known safe size) without any synchronization mechanism, thus allowing to read and write different parts of the buffer in parallel. The producer can then commit the write with a lock held, and update its knowledge of the safe empty remaining space. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Add two-step write feature to bytebuf,"If there is exactly one producer, then it can assume that the remaining space in the buffer will only increase until it writes something. This assumption may allow the producer to write to the buffer (up to a known safe size) without any synchronization mechanism, thus allowing to read and write different parts of the buffer in parallel. The producer can then commit the write with a lock held, and update its knowledge of the safe empty remaining space. PR #3757 link"
95,Introduce bytebuf util,Add a ring-buffer for bytes. It will be useful for audio buffering. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Introduce bytebuf util,Add a ring-buffer for bytes. It will be useful for audio buffering. PR #3757 link
96,Pass AVCodecContext to frame sinks,Frame consumers may need details about the frame format. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Pass AVCodecContext to frame sinks,Frame consumers may need details about the frame format. PR #3757 link
97,Add an audio decoder,PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Add an audio decoder,PR #3757 link
98,Give a name to decoder instances,This will be useful in logs. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Give a name to decoder instances,This will be useful in logs. PR #3757 link
99,Rename decoder to video_decoder,This prepares the introduction of audio_decoder. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Rename decoder to video_decoder,This prepares the introduction of audio_decoder. PR #3757 link
100,Log display sizes in display list,This is more convenient than just the display id alone.,Log display sizes in display list,This is more convenient than just the display id alone.
101,Add --list-displays,Add an option to list the device displays properly.,Add --list-displays,Add an option to list the device displays properly.
102,Move log message helpers to LogUtils,This class will also contain other log helpers.,Move log message helpers to LogUtils,This class will also contain other log helpers.
103,Quit on audio configuration failure,"When audio capture fails on the device, scrcpy continues mirroring the video stream. This allows to enable audio by default only when supported. However, if an audio configuration occurs (for example the user explicitly selected an unknown audio encoder), this must be treated as an error and scrcpy must exit. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Quit on audio configuration failure,"When audio capture fails on the device, scrcpy continues mirroring the video stream. This allows to enable audio by default only when supported. However, if an audio configuration occurs (for example the user explicitly selected an unknown audio encoder), this must be treated as an error and scrcpy must exit. PR #3757 link"
104,Add --list-encoders,Add an option to list the device encoders properly. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Add --list-encoders,Add an option to list the device encoders properly. PR #3757 link
105,Move await_for_server() logs,Print the logs on the caller side. This will allow to call the function in another context without printing the logs. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Move await_for_server() logs,Print the logs on the caller side. This will allow to call the function in another context without printing the logs. PR #3757 link
106,Add --audio-encoder,"Similar to --video-encoder, but for audio. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Add --audio-encoder,"Similar to --video-encoder, but for audio. PR #3757 link"
107,Extract unknown encoder error message,This will allow to reuse the same code for audio encoder selection. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Extract unknown encoder error message,This will allow to reuse the same code for audio encoder selection. PR #3757 link
108,Add --audio-codec-options,"Similar to --video-codec-options, but for audio. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Add --audio-codec-options,"Similar to --video-codec-options, but for audio. PR #3757 link"
109,Extract application of codec options,This will allow to reuse the same code for audio codec options. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Extract application of codec options,This will allow to reuse the same code for audio codec options. PR #3757 link
110,Add support for AAC audio codec,Add option --audio-codec=aac. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Add support for AAC audio codec,Add option --audio-codec=aac. PR #3757 link
111,Add --audio-codec,Introduce the selection mechanism. Alternative codecs will be added later. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Add --audio-codec,Introduce the selection mechanism. Alternative codecs will be added later. PR #3757 link
112,Add --audio-bit-rate,Add an option to configure the audio bit-rate. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Add --audio-bit-rate,Add an option to configure the audio bit-rate. PR #3757 link
113,Disable MethodLength checkstyle on createOptions(),This method will grow as needed to initialize options. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Disable MethodLength checkstyle on createOptions(),This method will grow as needed to initialize options. PR #3757 link
114,Rename --encoder to --video-encoder,This prepares the introduction of --audio-encoder. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Rename --encoder to --video-encoder,This prepares the introduction of --audio-encoder. PR #3757 link
115,Rename --codec-options to --video-codec-options,This prepares the introduction of --audio-codec-options. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Rename --codec-options to --video-codec-options,This prepares the introduction of --audio-codec-options. PR #3757 link
116,Rename --bit-rate to --video-bit-rate,This prepares the introduction of --audio-bit-rate. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Rename --bit-rate to --video-bit-rate,This prepares the introduction of --audio-bit-rate. PR #3757 link
117,Rename --codec to --video-codec,This prepares the introduction of --audio-codec. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Rename --codec to --video-codec,This prepares the introduction of --audio-codec. PR #3757 link
118,Remove default bit-rate on client side,"If no bit-rate is passed, let the server use the default value (8Mbps). This avoids to define a default value on both sides, and to pass the default bit-rate as an argument when starting the server. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Remove default bit-rate on client side,"If no bit-rate is passed, let the server use the default value (8Mbps). This avoids to define a default value on both sides, and to pass the default bit-rate as an argument when starting the server. PR #3757 link"
119,Record at least video packets on stop,"If the recorder is stopped while it has not received any audio packet yet, make sure the video stream is correctly recorded. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Record at least video packets on stop,"If the recorder is stopped while it has not received any audio packet yet, make sure the video stream is correctly recorded. PR #3757 link"
120,Disable audio before Android 11,"The permission ""android.permission.RECORD_AUDIO"" has been added for shell in Android 11. Moreover, on lower versions, it may make the server segfault on the device (happened on a Nexus 5 with Android 6.0.1). Refs https://android.googlesource.com/platform/frameworks/base/+/4feeee88911503cc365b223a712437abcd91c94f%5E%21/ PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Disable audio before Android 11,"The permission ""android.permission.RECORD_AUDIO"" has been added for shell in Android 11. Moreover, on lower versions, it may make the server segfault on the device (happened on a Nexus 5 with Android 6.0.1). Refs link/ PR #3757 link"
121,Disable audio on initialization error,"By default, audio is enabled (--no-audio must be explicitly passed to disable it). However, some devices may not support audio capture (typically devices below Android 11, or Android 11 when the shell application is not foreground on start). In that case, make the server notify the client to dynamically disable audio forwarding so that it does not wait indefinitely for an audio stream. Also disable audio on unknown codec or missing decoder on the client-side, for the same reasons. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Disable audio on initialization error,"By default, audio is enabled (--no-audio must be explicitly passed to disable it). However, some devices may not support audio capture (typically devices below Android 11, or Android 11 when the shell application is not foreground on start). In that case, make the server notify the client to dynamically disable audio forwarding so that it does not wait indefinitely for an audio stream. Also disable audio on unknown codec or missing decoder on the client-side, for the same reasons. PR #3757 link"
122,Add audio recording support,"Make the recorder accept two input sources (video and audio), and mux them into a single file. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Add audio recording support,"Make the recorder accept two input sources (video and audio), and mux them into a single file. PR #3757 link"
123,Rename video-specific variables in recorder,This paves the way to add audio-specific variables. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Rename video-specific variables in recorder,This paves the way to add audio-specific variables. PR #3757 link
124,Do not merge config audio packets,"For video streams (at least H.264 and H.265), the config packet containing SPS/PPS must be prepended to the next packet (the following keyframe). For audio streams (at least OPUS), they must not be merged. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Do not merge config audio packets,"For video streams (at least H.264 and H.265), the config packet containing SPS/PPS must be prepended to the next packet (the following keyframe). For audio streams (at least OPUS), they must not be merged. PR #3757 link"
125,Add an audio demuxer,Add a demuxer which will read the stream from the audio socket. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Add an audio demuxer,Add a demuxer which will read the stream from the audio socket. PR #3757 link
126,Force --no-audio if no display and no recording,"The client does not use the audio stream if there is no display and no recording (i.e. only V4L2), so disable audio so that the device does not attempt to capture it. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Force --no-audio if no display and no recording,"The client does not use the audio stream if there is no display and no recording (i.e. only V4L2), so disable audio so that the device does not attempt to capture it. PR #3757 link"
127,Give a name to demuxer instances,This will be useful in logs. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Give a name to demuxer instances,This will be useful in logs. PR #3757 link
128,Rename demuxer to video_demuxer,There will be another demuxer instance for audio. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Rename demuxer to video_demuxer,There will be another demuxer instance for audio. PR #3757 link
129,Extract OPUS extradata,"For OPUS codec, FFmpeg expects the raw extradata, but MediaCodec wraps it in some structure. Fix the config packet to send only the raw extradata. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Extract OPUS extradata,"For OPUS codec, FFmpeg expects the raw extradata, but MediaCodec wraps it in some structure. Fix the config packet to send only the raw extradata. PR #3757 link"
130,Use a streamer to send the audio stream,Send each encoded audio packet using a streamer. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Use a streamer to send the audio stream,Send each encoded audio packet using a streamer. PR #3757 link
131,Encode recorded audio on the device,"For now, the encoded packets are just logged into the console. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Encode recorded audio on the device,"For now, the encoded packets are just logged into the console. PR #3757 link"
132,Make streamer more generic,Expose a method to write a packet from raw metadata (without BufferInfo).,Make streamer more generic,Expose a method to write a packet from raw metadata (without BufferInfo).
133,Capture device audio,"Create an AudioRecorder to capture the audio source REMOTE_SUBMIX. For now, the captured packets are just logged into the console. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757 Co-authored-by: Romain Vimont rom@rom1v.com Signed-off-by: Romain Vimont rom@rom1v.com",Capture device audio,"Create an AudioRecorder to capture the audio source REMOTE_SUBMIX. For now, the captured packets are just logged into the console. PR #3757 link Co-authored-by: Romain Vimont rom@rom1v.com Signed-off-by: Romain Vimont rom@rom1v.com"
134,Add a new socket for audio stream,"When audio is enabled, open a new socket to send the audio stream from the device to the client. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757 Co-authored-by: Romain Vimont rom@rom1v.com Signed-off-by: Romain Vimont rom@rom1v.com",Add a new socket for audio stream,"When audio is enabled, open a new socket to send the audio stream from the device to the client. PR #3757 link Co-authored-by: Romain Vimont rom@rom1v.com Signed-off-by: Romain Vimont rom@rom1v.com"
135,Add --no-audio option,Audio will be enabled by default (when supported). Add an option to disable it. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757 Co-authored-by: Romain Vimont rom@rom1v.com Signed-off-by: Romain Vimont rom@rom1v.com,Add --no-audio option,Audio will be enabled by default (when supported). Add an option to disable it. PR #3757 link Co-authored-by: Romain Vimont rom@rom1v.com Signed-off-by: Romain Vimont rom@rom1v.com
136,Use FakeContext for Application instance,This will expose the correct package name and UID to the application context. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Use FakeContext for Application instance,This will expose the correct package name and UID to the application context. PR #3757 link
137,Use shell package name for workarounds,For consistency. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Use shell package name for workarounds,For consistency. PR #3757 link
138,Use ROOT_UID from FakeContext,"Remove USER_ID from ServiceManager, and replace it by a constant in FakeContext. This is the same as android.os.Process.ROOT_UID, but this constant has been introduced in API 29. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Use ROOT_UID from FakeContext,"Remove USER_ID from ServiceManager, and replace it by a constant in FakeContext. This is the same as android.os.Process.ROOT_UID, but this constant has been introduced in API 29. PR #3757 link"
139,Use PACKAGE_NAME from FakeContext,Remove duplicated constant. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Use PACKAGE_NAME from FakeContext,Remove duplicated constant. PR #3757 link
140,Use AttributionSource from FakeContext,FakeContext already provides an AttributeSource instance. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757 Co-authored-by: Simon Chan 1330321+yume-chan@users.noreply.github.com,Use AttributionSource from FakeContext,FakeContext already provides an AttributeSource instance. PR #3757 link Co-authored-by: Simon Chan 1330321+yume-chan@users.noreply.github.com
141,Add a fake Android Context,"Since scrcpy-server is not an Android application (it's a java executable), it has no Context. Some features will require a Context instance to get the package name and the UID. Add a FakeContext for this purpose. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757 Co-authored-by: Romain Vimont rom@rom1v.com Signed-off-by: Romain Vimont rom@rom1v.com",Add a fake Android Context,"Since scrcpy-server is not an Android application (it's a java executable), it has no Context. Some features will require a Context instance to get the package name and the UID. Add a FakeContext for this purpose. PR #3757 link Co-authored-by: Romain Vimont rom@rom1v.com Signed-off-by: Romain Vimont rom@rom1v.com"
142,Improve error message for unknown encoder,The provided encoder name depends on the selected codec. Improve the error message and the suggestions. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757,Improve error message for unknown encoder,The provided encoder name depends on the selected codec. Improve the error message and the suggestions. PR #3757 link
143,"Rename ""codec"" variable to ""mediaCodec""","This will allow to use ""codec"" for the Codec type. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757","Rename ""codec"" variable to ""mediaCodec""","This will allow to use ""codec"" for the Codec type. PR #3757 link"
144,Make streamer independent of codec type,"Rename VideoStreamer to Streamer, and extract a Codec interface which will also support audio codecs. PR #3757 https://github.com/Genymobile/scrcpy/pull/3757",Make streamer independent of codec type,"Rename VideoStreamer to Streamer, and extract a Codec interface which will also support audio codecs. PR #3757 link"
145,Pass all args to ScreenEncoder constructor,There is no good reason to pass some of them in the constructor and some others as parameters of the streamScreen() method.,Pass all args to ScreenEncoder constructor,There is no good reason to pass some of them in the constructor and some others as parameters of the streamScreen() method.
146,Move screen encoder initialization,This prepares further refactors.,Move screen encoder initialization,This prepares further refactors.
147,Write streamer header from ScreenEncoder,The screen encoder is responsible for writing data to the video streamer.,Write streamer header from ScreenEncoder,The screen encoder is responsible for writing data to the video streamer.
148,Use VideoStreamer directly from ScreenEncoder,"The Callbacks interface notifies new packets. But in addition, the screen encoder will need to write headers on start. We could add a function onStart(), but for simplicity, just remove the interface, which brings no value, and call the streamer directly. Refs 87972e2022686b1176bfaf0c678e703856c2b027",Use VideoStreamer directly from ScreenEncoder,"The Callbacks interface notifies new packets. But in addition, the screen encoder will need to write headers on start. We could add a function onStart(), but for simplicity, just remove the interface, which brings no value, and call the streamer directly. Refs 87972e2022686b1176bfaf0c678e703856c2b027"
149,Simplify error handling on socket creation,"On any error, all previously opened sockets must be closed. Handle these errors in a single catch-block. Currently, there are only 2 sockets, but this will simplify even more with more sockets. Note: this commit is better displayed with --ignore-space-change (-b).",Simplify error handling on socket creation,"On any error, all previously opened sockets must be closed. Handle these errors in a single catch-block. Currently, there are only 2 sockets, but this will simplify even more with more sockets. Note: this commit is better displayed with --ignore-space-change (-b)."
150,Reorder initialization,"Initialize components in the pipeline order: demuxer first, decoder and recorder second.",Reorder initialization,"Initialize components in the pipeline order: demuxer first, decoder and recorder second."
151,Refactor recorder logic,Process the initial config packet (necessary to write the header) separately.,Refactor recorder logic,Process the initial config packet (necessary to write the header) separately.
152,Move last packet recording,Write the last packet at the end.,Move last packet recording,Write the last packet at the end.
153,Add start() function for recorder,"For consistency with the other components, do not start the internal thread from an init() function.",Add start() function for recorder,"For consistency with the other components, do not start the internal thread from an init() function."
154,Open recording file from the recorder thread,"The recorder opened the target file from the packet sink open() callback, called by the demuxer. Only then the recorder thread was started. One golden rule for the recorder is to never block the demuxer for I/O, because it would impact mirroring. This rule is respected on recording packets, but not for the initial recorder opening. Therefore, start the recorder thread from sc_recorder_init(), open the file immediately from the recorder thread, then make it wait for the stream to start (on packet sink open()). Now that the recorder can report errors directly (rather than making the demuxer call fail), it is possible to report file opening error even before the packet sink is open.",Open recording file from the recorder thread,"The recorder opened the target file from the packet sink open() callback, called by the demuxer. Only then the recorder thread was started. One golden rule for the recorder is to never block the demuxer for I/O, because it would impact mirroring. This rule is respected on recording packets, but not for the initial recorder opening. Therefore, start the recorder thread from sc_recorder_init(), open the file immediately from the recorder thread, then make it wait for the stream to start (on packet sink open()). Now that the recorder can report errors directly (rather than making the demuxer call fail), it is possible to report file opening error even before the packet sink is open."
155,Inline packet_sink impl in recorder,Remove useless wrappers.,Inline packet_sink impl in recorder,Remove useless wrappers.
156,Initialize recorder fields from init(),"The recorder has two initialization phases: one to initialize the concrete recorder object, and one to open its packet_sink trait. Initialize mutex and condvar as part of the object initialization. If there were several packet_sink traits (spoiler: one for video, one for audio), then the mutex and condvar would still be initialized only once.",Initialize recorder fields from init(),"The recorder has two initialization phases: one to initialize the concrete recorder object, and one to open its packet_sink trait. Initialize mutex and condvar as part of the object initialization. If there were several packet_sink traits (spoiler: one for video, one for audio), then the mutex and condvar would still be initialized only once."
157,Report recorder errors,"Stop scrcpy on recorder errors. It was previously indirectly stopped by the demuxer, which failed to push packets to a recorder in error. Report it directly instead:  - it avoids to wait for the next demuxer call;  - it will allow to open the target file from a separate thread and stop    immediately on any I/O error.",Report recorder errors,"Stop scrcpy on recorder errors. It was previously indirectly stopped by the demuxer, which failed to push packets to a recorder in error. Report it directly instead:  - it avoids to wait for the next demuxer call;  - it will allow to open the target file from a separate thread and stop    immediately on any I/O error."
158,Move previous packet to a local variable,It is only used from run_recorder().,Move previous packet to a local variable,It is only used from run_recorder().
159,Move pts_origin to a local variable,It is only used from run_recorder().,Move pts_origin to a local variable,It is only used from run_recorder().
160,Change PTS origin type from uint64_t to int64_t,"It is initialized from AVPacket.pts, which is an int64_t.",Change PTS origin type from uint64_t to int64_t,"It is initialized from AVPacket.pts, which is an int64_t."
161,Fix --encoder documentation,Mention that it depends on the codec provided by --codec (which is not necessarily H264 anymore).,Fix --encoder documentation,Mention that it depends on the codec provided by --codec (which is not necessarily H264 anymore).
162,Do not print stacktraces when unnecessary,"User-friendly error messages are printed on specific configuration exceptions. In that case, do not print the stacktrace. Also handle the user-friendly error message directly where the error occurs, and print multiline messages in a single log call, to avoid confusing interleaving.",Do not print stacktraces when unnecessary,"User-friendly error messages are printed on specific configuration exceptions. In that case, do not print the stacktrace. Also handle the user-friendly error message directly where the error occurs, and print multiline messages in a single log call, to avoid confusing interleaving."
163,Fix --no-clipboard-autosync bash completion,Fix typo.,Fix --no-clipboard-autosync bash completion,Fix typo.
164,Split server stop() and join(),"For consistency with the other components, call stop() and join() separately. This allows to stop all components, then join them all.",Split server stop() and join(),"For consistency with the other components, call stop() and join() separately. This allows to stop all components, then join them all."
165,Print FFmpeg logs,FFmpeg logs are redirected to a specific SDL log category. Initialize the log level for this category to print them as expected.,Print FFmpeg logs,FFmpeg logs are redirected to a specific SDL log category. Initialize the log level for this category to print them as expected.
166,Move FFmpeg callback initialization,Configure FFmpeg log redirection on start from a log helper.,Move FFmpeg callback initialization,Configure FFmpeg log redirection on start from a log helper.
167,Upgrade FFmpeg custom builds for Windows,"Use a build which includes the pcm_s16le decoder, to support RAW audio. Refs https://github.com/rom1v/scrcpy-deps/commits/6.0-scrcpy-2",Upgrade FFmpeg custom builds for Windows,"Use a build which includes the pcm_s16le decoder, to support RAW audio. Refs link"
168,Upgrade FFmpeg (6.0) for Windows,Use the latest version (specifically built for scrcpy). Refs https://www.ffmpeg.org/download.html#release_6.0,Upgrade FFmpeg (6.0) for Windows,Use the latest version (specifically built for scrcpy). Refs link
169,Use minimal prebuilt FFmpeg for Windows,"On the scrcpy-deps repo, I built FFmpeg 5.1.2 binaries for Windows with only the features used by scrcpy. For comparison, here are the sizes of the dll for FFmpeg 5.1.2:  - before: 89M  - after: 4.7M It also allows to upgrade the old FFmpeg version (4.3.1) used for win32. Refs https://github.com/rom1v/scrcpy-deps Refs https://github.com/Genymobile/scrcpy/issues/1753",Use minimal prebuilt FFmpeg for Windows,"On the scrcpy-deps repo, I built FFmpeg 5.1.2 binaries for Windows with only the features used by scrcpy. For comparison, here are the sizes of the dll for FFmpeg 5.1.2:  - before: 89M  - after: 4.7M It also allows to upgrade the old FFmpeg version (4.3.1) used for win32. Refs link Refs link"
170,Simplify libusb prebuilt scripts,"In theory, include/ might be slightly different for win32 and win64 builds. Use each one separately to simplify.",Simplify libusb prebuilt scripts,"In theory, include/ might be slightly different for win32 and win64 builds. Use each one separately to simplify."
171,Silence lint warning about constant in API 29,"MediaFormat.MIMETYPE_VIDEO_AV1 has been added in API 29, but it is not a problem to inline the constant in older versions.",Silence lint warning about constant in API 29,"MediaFormat.MIMETYPE_VIDEO_AV1 has been added in API 29, but it is not a problem to inline the constant in older versions."
172,Remove manifest package name,"As reported by gradle:  Setting the namespace via a source AndroidManifest.xml's package attribute is deprecated. Please instead set the namespace (or testNamespace) in the module's build.gradle file, as described here: https://developer.android.com/studio/build/configure-app-module#set-namespace",Remove manifest package name,"As reported by gradle: Setting the namespace via a source AndroidManifest.xml's package attribute is deprecated. Please instead set the namespace (or testNamespace) in the module's build.gradle file, as described here: link"
173,Upgrade gradle build tools to 7.4.0,Plugin version 7.4.0. Gradle version 7.5. Refs https://developer.android.com/studio/releases/gradle-plugin#updating-gradle,Upgrade gradle build tools to 7.4.0,Plugin version 7.4.0. Gradle version 7.5. Refs link
174,Fix useless garbage initialization,"The variable p was initialized with a garbage value (a const char ** casted to char *). Fortunately, it was never read. Refs https://github.com/Genymobile/scrcpy/issues/3765",Fix useless garbage initialization,"The variable p was initialized with a garbage value (a const char ** casted to char *). Fortunately, it was never read. Refs link"
175,Fix MIN/MAX macros,"Expressions like ""x < MAX(y, z)"" were broken.",Fix MIN/MAX macros,"Expressions like ""x < MAX(y, z)"" were broken."
176,Initialize server->serial in all cases,"Running scrcpy --tcpip on a device already connected via TCP/IP did not initialize server->serial. As a consequence, in debug mode, an assertion failed: scrcpy: ../app/src/server.c:770: run_server: Assertion `server->serial' failed.  In release mode, scrcpy failed with this error: adb: -s requires an argument",Initialize server->serial in all cases,"Running scrcpy --tcpip on a device already connected via TCP/IP did not initialize server->serial. As a consequence, in debug mode, an assertion failed: scrcpy: ../app/src/server.c:770: run_server: Assertion `server->serial' failed. In release mode, scrcpy failed with this error: adb: -s requires an argument"
177,Fix error message on icon loading failure,,Fix error message on icon loading failure,
178,Do not use avformat network,Scrcpy does not use FFmpeg network features. Initialize network locally instead (useful only for Windows). The include block has been moved to fix the following warning: Please include winsock2.h before windows.h,Do not use avformat network,Scrcpy does not use FFmpeg network features. Initialize network locally instead (useful only for Windows). The include block has been moved to fix the following warning: Please include winsock2.h before windows.h
179,Accept Windows Sockets from version 1.1,Version 2.2 is probably not necessary (1.1 is the version required by FFmpeg when network is enabled). Refs https://github.com/FFmpeg/FFmpeg/blob/891ed24f77da99c6d41bb7c116ba5925e3206ce2/libavformat/network.c#L63 Refs https://learn.microsoft.com/en-us/windows/win32/api/winsock/nf-winsock-wsastartup,Accept Windows Sockets from version 1.1,Version 2.2 is probably not necessary (1.1 is the version required by FFmpeg when network is enabled). Refs link Refs link
180,Fix WSAStartup() error check on Windows,,Fix WSAStartup() error check on Windows,
181,Fix --bit-rate option in bash completion script,"The option is --bit-rate, not --bitrate.",Fix --bit-rate option in bash completion script,"The option is --bit-rate, not --bitrate."
182,Add auto-completion for --codec option,Add missing command to bash and zsh completion scripts.,Add auto-completion for --codec option,Add missing command to bash and zsh completion scripts.
183,Use enum for long options constants,This avoids to manually assign values.,Use enum for long options constants,This avoids to manually assign values.
184,Initialize mouse_input_mode explicitly,The explicit initialization was missing. It had no consequences because SC_MOUSE_INPUT_MODE_INJECT == 0. Fixes #3749 https://github.com/Genymobile/scrcpy/issues/3749,Initialize mouse_input_mode explicitly,The explicit initialization was missing. It had no consequences because SC_MOUSE_INPUT_MODE_INJECT == 0. Fixes #3749 link
185,Accept muxing AV1 into MP4 container,MP4 supports AV1. Refs d2dce5103832d6a9fc29f56a9795c22e44ceafa1,Accept muxing AV1 into MP4 container,MP4 supports AV1. Refs d2dce5103832d6a9fc29f56a9795c22e44ceafa1
186,Fix inconsistent quotes,The encoder name started with a simple quote but ended with a double quote. Use a single quote for both.,Fix inconsistent quotes,The encoder name started with a simple quote but ended with a double quote. Use a single quote for both.
187,Suggest commands with an explicit '=',,Suggest commands with an explicit '=',
188,Move finally-block to fix deadlock on stop,"DesktopConnection implements Closeable, so it is implicitly closed after its try-with-resources block. Closing the DesktopConnection shutdowns the sockets, so it is necessary in particular to wake up blocking read() calls from the controller. But the controller thread was joined before the DesktopConnection was closed, causing a deadlock. To fix the problem, join the controller thread only after the DesktopConnection is closed. Refs 400a1c69b198103feff9682895529529890c1acc",Move finally-block to fix deadlock on stop,"DesktopConnection implements Closeable, so it is implicitly closed after its try-with-resources block. Closing the DesktopConnection shutdowns the sockets, so it is necessary in particular to wake up blocking read() calls from the controller. But the controller thread was joined before the DesktopConnection was closed, causing a deadlock. To fix the problem, join the controller thread only after the DesktopConnection is closed. Refs 400a1c69b198103feff9682895529529890c1acc"
189,Remove unnecessary error logs,"When a call to a packet or frame sink fails, do not log the error on the caller side: either the ""failure"" is expected (explicitly stopped) or it must be logged by the packet or frame sink implementation.",Remove unnecessary error logs,"When a call to a packet or frame sink fails, do not log the error on the caller side: either the ""failure"" is expected (explicitly stopped) or it must be logged by the packet or frame sink implementation."
190,Document default video codec,"Mention the default option value, like for other commands.",Document default video codec,"Mention the default option value, like for other commands."
191,Fix command-line help typo,,Fix command-line help typo,
192,Prefix receiver by sc_,Like all other components in scrcpy.,Prefix receiver by sc_,Like all other components in scrcpy.
193,Fix demuxer error message,"Now that there are several possible codecs, do not hardcode H.264 in the error message. Refs 3e517cd40eb50f8afb5137f39b0676fead58902a",Fix demuxer error message,"Now that there are several possible codecs, do not hardcode H.264 in the error message. Refs 3e517cd40eb50f8afb5137f39b0676fead58902a"
194,Log non-EPIPE I/O exceptions,"On close, the client closes the socket. This wakes up socket blocking calls on the server-side, by throwing an exception. Since this exception is expected, it was not logged. However, other IOExceptions might occur, which must not be ignored. For that purpose, log only IOException when they are not caused by an EPIPE error.",Log non-EPIPE I/O exceptions,"On close, the client closes the socket. This wakes up socket blocking calls on the server-side, by throwing an exception. Since this exception is expected, it was not logged. However, other IOExceptions might occur, which must not be ignored. For that purpose, log only IOException when they are not caused by an EPIPE error."
195,Rename 'uid' to 'scid',A random identifier is generated to differentiate multiple running scrcpy instances. Rename it from 'uid' to 'scid' (scrcpy id) not to confuse it with Linux UID. Fixes #3729 https://github.com/Genymobile/scrcpy/issues/3729 Refs 4315be164823d2c8fc44b475b52af79bfee98ff1,Rename 'uid' to 'scid',A random identifier is generated to differentiate multiple running scrcpy instances. Rename it from 'uid' to 'scid' (scrcpy id) not to confuse it with Linux UID. Fixes #3729 link Refs 4315be164823d2c8fc44b475b52af79bfee98ff1
196,Extract packet merging,Config packets must be prepended to the next media packet. Extract the logic to a new sc_packet_merger helper to simplify the demuxer code.,Extract packet merging,Config packets must be prepended to the next media packet. Extract the logic to a new sc_packet_merger helper to simplify the demuxer code.
197,Remove unused parser,"Since 1c02b58412db2646ba6e57a7e305d26482b9bc0d, the parser is not used anymore.",Remove unused parser,"Since 1c02b58412db2646ba6e57a7e305d26482b9bc0d, the parser is not used anymore."
198,Log component stopped in finally clause,The message must be logged even when no exception occurs.,Log component stopped in finally clause,The message must be logged even when no exception occurs.
199,Join all threads before end of main,Some calls from separate threads may throw exceptions once the main() method has returned.,Join all threads before end of main,Some calls from separate threads may throw exceptions once the main() method has returned.
200,Properly report demuxer errors,"All demuxer errors were reported as ""device disconnected"", even if the failure was not related to device socket read.",Properly report demuxer errors,"All demuxer errors were reported as ""device disconnected"", even if the failure was not related to device socket read."
201,Prefix UI events constants by SC_,,Prefix UI events constants by SC_,
202,Split codec_id reading,Receive codec id and convert it to AVCodecID separately. This will allow the caller to distinguish between EOS and unknown codec id.,Split codec_id reading,Receive codec id and convert it to AVCodecID separately. This will allow the caller to distinguish between EOS and unknown codec id.
203,Fix error return value,"The function returns an enum AVCodecID, not a bool.",Fix error return value,"The function returns an enum AVCodecID, not a bool."
204,Fix demuxer error message,"The message applies to all packets, not only config packets.",Fix demuxer error message,"The message applies to all packets, not only config packets."
205,Remove unused codec context,The demuxer does not need any codec context.,Remove unused codec context,The demuxer does not need any codec context.
206,Remove unused constant,This line was committed by error. Refs 3e517cd40eb50f8afb5137f39b0676fead58902a,Remove unused constant,This line was committed by error. Refs 3e517cd40eb50f8afb5137f39b0676fead58902a
207,Add Fedora instructions in README,Add the command to install the scrcpy package for Fedora directly. PR #3715 https://github.com/Genymobile/scrcpy/pull/3715 Signed-off-by: Romain Vimont rom@rom1v.com,Add Fedora instructions in README,Add the command to install the scrcpy package for Fedora directly. PR #3715 link Signed-off-by: Romain Vimont rom@rom1v.com
208,Set power mode on all physical displays,Android 10 and above support multiple physical displays. Apply power mode to all of them. Fixes #3716 https://github.com/Genymobile/scrcpy/issues/3716,Set power mode on all physical displays,Android 10 and above support multiple physical displays. Apply power mode to all of them. Fixes #3716 link
209,Add support for AV1,Add option --codec=av1. PR #3713 https://github.com/Genymobile/scrcpy/pull/3713,Add support for AV1,Add option --codec=av1. PR #3713 link
210,Add support for H265,Add option --codec=h265. PR #3713 https://github.com/Genymobile/scrcpy/pull/3713 Fixes #3092 https://github.com/Genymobile/scrcpy/issues/3092,Add support for H265,Add option --codec=h265. PR #3713 link Fixes #3092 link
211,Add option to select video codec,Introduce the selection mechanism. Alternative codecs will be added in further commits. PR #3713 https://github.com/Genymobile/scrcpy/pull/3713,Add option to select video codec,Introduce the selection mechanism. Alternative codecs will be added in further commits. PR #3713 link
212,Simplify server info initialization,Use sc_read16be() to read 16-bit integer fields.,Simplify server info initialization,Use sc_read16be() to read 16-bit integer fields.
213,Extract video streaming to a separate class,ScreenEncoder handled both capture/encoding and sending over the network. Move the streaming part to a separate VideoStreamer.,Extract video streaming to a separate class,ScreenEncoder handled both capture/encoding and sending over the network. Move the streaming part to a separate VideoStreamer.
214,Move variable assignment,Computing eof flag is not necessary if rotation changed.,Move variable assignment,Computing eof flag is not necessary if rotation changed.
215,Compute relative PTS on the client-side,"The PTS received from MediaCodec are expressed relative to an arbitrary clock origin. We consider the PTS of the first frame to be 0, and the PTS of every other frame is relative to this first PTS (note that the PTS is only used for recording, it is ignored for mirroring). For simplicity, this relative PTS was computed on the server-side. To prepare support for multiple stream (video and audio), send the packet with its original PTS, and handle the PTS offset on the client-side (by the recorder). Since we can't know in advance which stream will produce the first packet with the lowest PTS (a packet received later on one stream may have a PTS lower than a packet received earlier on another stream), computing the PTS on the server-side would require unnecessary waiting.",Compute relative PTS on the client-side,"The PTS received from MediaCodec are expressed relative to an arbitrary clock origin. We consider the PTS of the first frame to be 0, and the PTS of every other frame is relative to this first PTS (note that the PTS is only used for recording, it is ignored for mirroring). For simplicity, this relative PTS was computed on the server-side. To prepare support for multiple stream (video and audio), send the packet with its original PTS, and handle the PTS offset on the client-side (by the recorder). Since we can't know in advance which stream will produce the first packet with the lowest PTS (a packet received later on one stream may have a PTS lower than a packet received earlier on another stream), computing the PTS on the server-side would require unnecessary waiting."
216,Improve workarounds call comments,,Improve workarounds call comments,
217,Move Workarounds call,Workarounds are not specific to the screen encoder. Co-authored-by: Simon Chan 1330321+yume-chan@users.noreply.github.com,Move Workarounds call,Workarounds are not specific to the screen encoder. Co-authored-by: Simon Chan 1330321+yume-chan@users.noreply.github.com
218,Do not expose controller threads,The way the controller executes its events asynchronously is an implementation detail.,Do not expose controller threads,The way the controller executes its events asynchronously is an implementation detail.
219,Fix manpage formatting,Only the option arguments must be underlined.,Fix manpage formatting,Only the option arguments must be underlined.
220,Inject additional ACTION_BUTTON_* events for mouse,"On mouse click events:  - the first button pressed must first generate ACTION_DOWN;  - all button pressed (including the first one) must generate    ACTION_BUTTON_PRESS;  - all button released (including the last one) must generate    ACTION_BUTTON_RELEASE;  - the last button released must in addition generate ACTION_UP. Otherwise, Chrome does not work properly. Fixes #3635 https://github.com/Genymobile/scrcpy/issues/3635 Signed-off-by: Romain Vimont rom@rom1v.com",Inject additional ACTION_BUTTON_* events for mouse,"On mouse click events:  - the first button pressed must first generate ACTION_DOWN;  - all button pressed (including the first one) must generate    ACTION_BUTTON_PRESS;  - all button released (including the last one) must generate    ACTION_BUTTON_RELEASE;  - the last button released must in addition generate ACTION_UP. Otherwise, Chrome does not work properly. Fixes #3635 link Signed-off-by: Romain Vimont rom@rom1v.com"
221,Fix mouse pointer state update,"If the pointer is a mouse, the pointer is UP only when no buttons are pressed (not when a button is released, because there might be other buttons still pressed). Refs #3635 https://github.com/Genymobile/scrcpy/issues/3635 Signed-off-by: Romain Vimont rom@rom1v.com",Fix mouse pointer state update,"If the pointer is a mouse, the pointer is UP only when no buttons are pressed (not when a button is released, because there might be other buttons still pressed). Refs #3635 link Signed-off-by: Romain Vimont rom@rom1v.com"
222,Forward action button to device,"On click event, only the whole buttons state was passed to the device. In addition, on ACTION_DOWN and ACTION_UP, pass the button associated to the action. Refs #3635 https://github.com/Genymobile/scrcpy/issues/3635 Co-authored-by: Romain Vimont rom@rom1v.com Signed-off-by: Romain Vimont rom@rom1v.com",Forward action button to device,"On click event, only the whole buttons state was passed to the device. In addition, on ACTION_DOWN and ACTION_UP, pass the button associated to the action. Refs #3635 link Co-authored-by: Romain Vimont rom@rom1v.com Signed-off-by: Romain Vimont rom@rom1v.com"
223,Retry on spurious error,"MediaCodec may fail spuriously, typically when stopping an encoding and starting a new one immediately (for example on device rotation). In that case, retry a few times, in many cases it should work. Refs #3693 https://github.com/Genymobile/scrcpy/issues/3693",Retry on spurious error,"MediaCodec may fail spuriously, typically when stopping an encoding and starting a new one immediately (for example on device rotation). In that case, retry a few times, in many cases it should work. Refs #3693 link"
224,Extract retry handling,Move the code to downscale and retry on error out of the catch-block. Refs 26b4104844fb9516be13ff1f2be34e2945090e79,Extract retry handling,Move the code to downscale and retry on error out of the catch-block. Refs 26b4104844fb9516be13ff1f2be34e2945090e79
225,Move local variables declarations,This makes it clear that these local variables are only passed to setDisplaySurface().,Move local variables declarations,This makes it clear that these local variables are only passed to setDisplaySurface().
226,Remove useless setSize() method,Inline its content. It makes the logic of internalStreamScreen() more readable (it reduces the number of indirections).,Remove useless setSize() method,Inline its content. It makes the logic of internalStreamScreen() more readable (it reduces the number of indirections).
227,Remove useless configure() method,Inline its single call.,Remove useless configure() method,Inline its single call.
228,Keep the same MediaCodec instance across sessions,Calling codec.reset() is sufficient.,Keep the same MediaCodec instance across sessions,Calling codec.reset() is sufficient.
229,Remove useless destroyDisplay() method,The method made exactly one simple call. Just make the call directly.,Remove useless destroyDisplay() method,The method made exactly one simple call. Just make the call directly.
230,Keep the same display binder across sessions,Do not destroy/recreate the display when starting a new encoding session (on device rotation for example).,Keep the same display binder across sessions,Do not destroy/recreate the display when starting a new encoding session (on device rotation for example).
231,Terminate loop explicitly on interrupted,Make explicit that the loop terminates when the current thread is interrupted.,Terminate loop explicitly on interrupted,Make explicit that the loop terminates when the current thread is interrupted.
232,Use Java lambdas where possible,,Use Java lambdas where possible,
233,Support Java lambdas in build_without_gradle.sh,Building Java source code using lambdas requires core-lambda-stubs.jar. Refs #3657 https://github.com/Genymobile/scrcpy/issues/3657,Support Java lambdas in build_without_gradle.sh,Building Java source code using lambdas requires core-lambda-stubs.jar. Refs #3657 link
234,Add missing final modifiers,,Add missing final modifiers,
235,Use try-with-resources,Replace an explicit try-finally by a try-with-resources block.,Use try-with-resources,Replace an explicit try-finally by a try-with-resources block.
236,Use random name for device socket,"For the initial connection between the device and the computer, an adb tunnel is established (with ""adb reverse"" or ""adb forward""). The device-side of the tunnel is a local socket having the hard-coded name ""scrcpy"". This may cause issues when several scrcpy instances are started in a few seconds for the same device, since they will try to bind the same name. To avoid conflicts, make the client generate a random UID, and append this UID to the local socket name (""scrcpy_01234567"").",Use random name for device socket,"For the initial connection between the device and the computer, an adb tunnel is established (with ""adb reverse"" or ""adb forward""). The device-side of the tunnel is a local socket having the hard-coded name ""scrcpy"". This may cause issues when several scrcpy instances are started in a few seconds for the same device, since they will try to bind the same name. To avoid conflicts, make the client generate a random UID, and append this UID to the local socket name (""scrcpy_01234567"")."
237,Add random util,Add a user-friendly tool to generate random numbers.,Add random util,Add a user-friendly tool to generate random numbers.
238,Add jrand48()/nrand48() compat functions,These functions are not available on all platforms.,Add jrand48()/nrand48() compat functions,These functions are not available on all platforms.
239,Use separate gen dir to build without gradle,The generated source files were written to the classes dir. Use a separate gen dir instead.,Use separate gen dir to build without gradle,The generated source files were written to the classes dir. Use a separate gen dir instead.
240,"Remove ""on Linux"" in FAQ",HID now works on all platforms.,"Remove ""on Linux"" in FAQ",HID now works on all platforms.
241,Add FAQ section about HID/OTG on Windows,Refs #3654 https://github.com/Genymobile/scrcpy/issues/3654,Add FAQ section about HID/OTG on Windows,Refs #3654 link
242,Avoid unnecessary copy on config packets demuxing,"Use av_packet_ref() to reference the packet without copy. This also simplifies the logic, by making the ""offset"" variable and the memcpy() call local to the if-block.",Avoid unnecessary copy on config packets demuxing,"Use av_packet_ref() to reference the packet without copy. This also simplifies the logic, by making the ""offset"" variable and the memcpy() call local to the if-block."
243,"Revert ""Remove continuous resizing workaround for Windows""","This reverts commit 18082f60697ae8edad2db950637638c8bb6bf0d2. I can't reproduce, but it seems the workaround improves the behavior on some Windows versions. Fixes #3640 https://github.com/Genymobile/scrcpy/issues/3640 Refs #3458 https://github.com/Genymobile/scrcpy/issues/3458","Revert ""Remove continuous resizing workaround for Windows""","This reverts commit 18082f60697ae8edad2db950637638c8bb6bf0d2. I can't reproduce, but it seems the workaround improves the behavior on some Windows versions. Fixes #3640 link Refs #3458 link"
244,"Use ""meson setup"" from install_release.sh",Refs 64821466a1ddcdf7f0a50fa39067f066284ef9ca,"Use ""meson setup"" from install_release.sh",Refs 64821466a1ddcdf7f0a50fa39067f066284ef9ca
245,Update links to v1.25,,Update links to v1.25,
246,Bump version to 1.25,,Bump version to 1.25,
247,Upgrade FFmpeg (5.1.2) for Windows 64-bit,Use the latest version of FFmpeg in Windows 64-bit releases.,Upgrade FFmpeg (5.1.2) for Windows 64-bit,Use the latest version of FFmpeg in Windows 64-bit releases.
248,Upgrade SDL (2.26.1) for Windows,Include the latest version of SDL in Windows releases.,Upgrade SDL (2.26.1) for Windows,Include the latest version of SDL in Windows releases.
249,Upgrade platform-tools (33.0.3) for Windows,Include the latest version of adb in Windows releases.,Upgrade platform-tools (33.0.3) for Windows,Include the latest version of adb in Windows releases.
250,Merge branch 'master' into dev,,Merge branch 'master' into dev,
251,Force mouse source when --forward-all-clicks,"Right click and middle click require the source device to be a mouse, not a touchscreen. Therefore, the source device was changed only when a button other than the primary button was pressed (see adc547fa6e8e6167cd9633a97d98de6665b8c23a). However, this led to inconsistencies between the ACTION_DOWN when a secondary button is pressed (with a mouse as source device) and the matching ACTION_UP when the secondary button is released (with a touchscreen as source device, because then there is no button pressed). To avoid the problem in all cases, force a mouse as source device when --forward-all-clicks is set. Concretely, for mouse events in --forward-all-clicks mode:  - device source is set to InputDevice.SOURCE_MOUSE;  - motion event toolType is set to MotionEvent.TOOL_TYPE_MOUSE; Otherwise (when --forward-all-clicks is unset, or for real touch events), finger events are injected:  - device source is set to InputDevice.SOURCE_TOUCHSCREEN;  - motion event toolType is set to MotionEvent.TOOL_TYPE_FINGER. Fixes #3568 https://github.com/Genymobile/scrcpy/issues/3568 PR #3579 https://github.com/Genymobile/scrcpy/pull/3579 Co-authored-by: Romain Vimont rom@rom1v.com Signed-off-by: Romain Vimont rom@rom1v.com",Force mouse source when --forward-all-clicks,"Right click and middle click require the source device to be a mouse, not a touchscreen. Therefore, the source device was changed only when a button other than the primary button was pressed (see adc547fa6e8e6167cd9633a97d98de6665b8c23a). However, this led to inconsistencies between the ACTION_DOWN when a secondary button is pressed (with a mouse as source device) and the matching ACTION_UP when the secondary button is released (with a touchscreen as source device, because then there is no button pressed). To avoid the problem in all cases, force a mouse as source device when --forward-all-clicks is set. Concretely, for mouse events in --forward-all-clicks mode:  - device source is set to InputDevice.SOURCE_MOUSE;  - motion event toolType is set to MotionEvent.TOOL_TYPE_MOUSE; Otherwise (when --forward-all-clicks is unset, or for real touch events), finger events are injected:  - device source is set to InputDevice.SOURCE_TOUCHSCREEN;  - motion event toolType is set to MotionEvent.TOOL_TYPE_FINGER. Fixes #3568 link PR #3579 link Co-authored-by: Romain Vimont rom@rom1v.com Signed-off-by: Romain Vimont rom@rom1v.com"
252,Remove continuous resizing workaround for Windows,It turns out that the workaround only worked for MacOS. Refs #3458 https://github.com/Genymobile/scrcpy/issues/3458 Refs SDL/#1059 https://github.com/libsdl-org/SDL/issues/1059,Remove continuous resizing workaround for Windows,It turns out that the workaround only worked for MacOS. Refs #3458 link Refs SDL/#1059 link
253,Add parent directory in release zipfile,This avoids to mistakenly extract all the files in the current directory.,Add parent directory in release zipfile,This avoids to mistakenly extract all the files in the current directory.
254,"Use ""meson setup""",This fixes the following warning:  WARNING: Running the setup command as meson [options] instead of meson setup [options] is ambiguous and deprecated.,"Use ""meson setup""",This fixes the following warning: WARNING: Running the setup command as meson [options] instead of meson setup [options] is ambiguous and deprecated.
255,Adapt ClipboardManager for Android 13,"A new ""attributionTag"" parameter has been added to the methods getPrimaryClip(), setPrimaryClip() and addPrimaryClipChangedListener() of IClipboard.aidl. Refs https://android.googlesource.com/platform/frameworks/base.git/+/0e3e509b3bf4d561c26d87213387a290dfd688e3%5E%21/ Fixes #3497 https://github.com/Genymobile/scrcpy/issues/3497",Adapt ClipboardManager for Android 13,"A new ""attributionTag"" parameter has been added to the methods getPrimaryClip(), setPrimaryClip() and addPrimaryClipChangedListener() of IClipboard.aidl. Refs link/ Fixes #3497 link"
256,Upgrade junit to 4.13.2,,Upgrade junit to 4.13.2,
257,Use current adb port (if any) for --tcpip,"If the current adb port is not 5555 (typically 0 because it is not in TCP/IP mode), --tcpip automatically executes (among other commands): adb tcpip 5555  In case adb was already listening on another port, this command forced to listen on 5555, and the connection should still succeed. But this reconfiguration might be inconvenient for the user. If adb is already in TCP/IP mode, use the current enabled port without reconfiguration. Fixes #3591 https://github.com/Genymobile/scrcpy/issues/3591",Use current adb port (if any) for --tcpip,"If the current adb port is not 5555 (typically 0 because it is not in TCP/IP mode), --tcpip automatically executes (among other commands): adb tcpip 5555 In case adb was already listening on another port, this command forced to listen on 5555, and the connection should still succeed. But this reconfiguration might be inconvenient for the user. If adb is already in TCP/IP mode, use the current enabled port without reconfiguration. Fixes #3591 link"
258,Fix CommandParserTest code style,Make checkstyle happy.,Fix CommandParserTest code style,Make checkstyle happy.
259,Always use --key=value in README,"Mandatory arguments may be passed in either of these two forms:  1. --key value  2. --key=value Optional argument may only be passed in the second form. For consistency, always document using --key=value. Refs f76fe2c0d4847d0e40d8708f97591abf3fa22ea5",Always use --key=value in README,"Mandatory arguments may be passed in either of these two forms:  1. --key value  2. --key=value Optional argument may only be passed in the second form. For consistency, always document using --key=value. Refs f76fe2c0d4847d0e40d8708f97591abf3fa22ea5"
260,Fix DisplayInfo parsing for Android Q,The DisplayInfo dump format has slightly changed in AOSP: https://android.googlesource.com/platform/frameworks/base.git/+/1039ea50f3e1944f5d670cfdeadfdb17b3442ed7 PR #3573 https://github.com/Genymobile/scrcpy/pull/3573 Ref #3416 https://github.com/Genymobile/scrcpy/pull/3416 Signed-off-by: Romain Vimont rom@rom1v.com,Fix DisplayInfo parsing for Android Q,The DisplayInfo dump format has slightly changed in AOSP: link PR #3573 link Ref #3416 link Signed-off-by: Romain Vimont rom@rom1v.com
261,Support wchar_t in argv for Windows,PR #3547 https://github.com/Genymobile/scrcpy/pull/3547 Fixes #2932 https://github.com/Genymobile/scrcpy/issues/2932 Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com,Support wchar_t in argv for Windows,PR #3547 link Fixes #2932 link Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com
262,Avoid string concatenation in crossfiles,This feature is not supported on older meson versions: ERROR: Malformed value in cross file variable prebuilt_libusb.  Refs https://github.com/mesonbuild/meson/issues/3878 PR #3546 https://github.com/Genymobile/scrcpy/pull/3546 Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com,Avoid string concatenation in crossfiles,This feature is not supported on older meson versions: ERROR: Malformed value in cross file variable prebuilt_libusb. Refs link PR #3546 link Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com
263,Build log.c for test_cli,"On Windows, sc_log_windows_error() is called from net.c, so log.c must also be compiled. Fixes #3542 https://github.com/Genymobile/scrcpy/issues/3542",Build log.c for test_cli,"On Windows, sc_log_windows_error() is called from net.c, so log.c must also be compiled. Fixes #3542 link"
264,Add missing include  for strlen(),,Add missing include  for strlen(),
265,Add missing include  for memmove(),,Add missing include  for memmove(),
266,Add -s auto-completion for zsh,Fixes #3522 https://github.com/Genymobile/scrcpy/pull/3522 PR #3523 https://github.com/Genymobile/scrcpy/pull/3523 Signed-off-by: Romain Vimont rom@rom1v.com,Add -s auto-completion for zsh,Fixes #3522 link PR #3523 link Signed-off-by: Romain Vimont rom@rom1v.com
267,Add -s auto-completion for bash,Fixes #3522 https://github.com/Genymobile/scrcpy/pull/3522 PR #3523 https://github.com/Genymobile/scrcpy/pull/3523 Signed-off-by: Romain Vimont rom@rom1v.com,Add -s auto-completion for bash,Fixes #3522 link PR #3523 link Signed-off-by: Romain Vimont rom@rom1v.com
268,Make ServiceManager and Settings methods static,"There were exactly one instance of ServiceManager and Settings, stored in Device. Since a Device instance is not created by the CleanUp executable, it was not straightforward to call wrapper methods on cleanup. Remove this artificial restriction and expose them publicly via static methods (this is equivalent to expose a singleton, but less verbose).",Make ServiceManager and Settings methods static,"There were exactly one instance of ServiceManager and Settings, stored in Device. Since a Device instance is not created by the CleanUp executable, it was not straightforward to call wrapper methods on cleanup. Remove this artificial restriction and expose them publicly via static methods (this is equivalent to expose a singleton, but less verbose)."
269,Fix typo in logs,,Fix typo in logs,
270,Add fallback to get DisplayInfo,PR #3416 https://github.com/Genymobile/scrcpy/pull/3416 Signed-off-by: Romain Vimont rom@rom1v.com,Add fallback to get DisplayInfo,PR #3416 link Signed-off-by: Romain Vimont rom@rom1v.com
271,Use /dev/null instead of closing fds,"Some adb commands do not like when stdin, stdout or stderr are closed (they hang forever). Open /dev/null for each.",Use /dev/null instead of closing fds,"Some adb commands do not like when stdin, stdout or stderr are closed (they hang forever). Open /dev/null for each."
272,Extract $BUILD_TOOLS_DIR,"In the script to build without gradle, the build-tools full path is used at several places. Use a separate variable for readability.",Extract $BUILD_TOOLS_DIR,"In the script to build without gradle, the build-tools full path is used at several places. Use a separate variable for readability."
273,Add scrcpy-console.desktop,"Add a launcher which opens a terminal, and keep it open in case of errors (so that the user has time to read error messages). The behavior is the same as scrcpy-console.bat on Windows. PR #3351 https://github.com/Genymobile/scrcpy/pull/3351",Add scrcpy-console.desktop,"Add a launcher which opens a terminal, and keep it open in case of errors (so that the user has time to read error messages). The behavior is the same as scrcpy-console.bat on Windows. PR #3351 link"
274,Use shell environment to execute launcher,Make Exec= compatible with $PATH configured in .bashrc or .zshrc PR #3351 https://github.com/Genymobile/scrcpy/pull/3351 Refs #296 https://github.com/Genymobile/scrcpy/pull/296#discussion_r224987002 Signed-off-by: Romain Vimont rom@rom1v.com,Use shell environment to execute launcher,Make Exec= compatible with $PATH configured in .bashrc or .zshrc PR #3351 link Refs #296 link Signed-off-by: Romain Vimont rom@rom1v.com
275,Add desktop entry file for Linux app launchers,Refs https://specifications.freedesktop.org/desktop-entry-spec/desktop-entry-spec-latest.html PR #3351 https://github.com/Genymobile/scrcpy/pull/3351 Replaces PR #296 https://github.com/Genymobile/scrcpy/pull/296 Fixes #295 https://github.com/Genymobile/scrcpy/issues/295 Fixes #748 https://github.com/Genymobile/scrcpy/issues/748 Fixes #1636 https://github.com/Genymobile/scrcpy/issues/1636 Co-authored-by: Chih-Hsuan Yen yan12125@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com,Add desktop entry file for Linux app launchers,Refs link PR #3351 link Replaces PR #296 link Fixes #295 link Fixes #748 link Fixes #1636 link Co-authored-by: Chih-Hsuan Yen yan12125@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com
276,Replace hardcoded 'share/' by datadir variable,Meson defines a variable for the data directory. PR #3351 https://github.com/Genymobile/scrcpy/pull/3351,Replace hardcoded 'share/' by datadir variable,Meson defines a variable for the data directory. PR #3351 link
277,Upgrade Android SDK to 33,,Upgrade Android SDK to 33,
278,Upgrade gradle build tools to 7.2.2,Plugin version 7.2.2. Gradle version 7.3.3. Refs: https://developer.android.com/studio/releases/gradle-plugin#updating-gradle,Upgrade gradle build tools to 7.2.2,Plugin version 7.2.2. Gradle version 7.3.3. Refs: link
279,Move from jcenter() to mavenCentral(),Refs https://developer.android.com/studio/build/jcenter-migration Refs https://jfrog.com/blog/into-the-sunset-bintray-jcenter-gocenter-and-chartcenter/,Move from jcenter() to mavenCentral(),Refs link Refs link/
280,Use precise scrolling values,"Since SDL 2.0.18, the amount scrolled horizontally or vertically is exposed as a float (between 0 and 1). Forward a precise value to the Android device when possible. Refs https://wiki.libsdl.org/SDL_MouseWheelEvent Fixes #3363 https://github.com/Genymobile/scrcpy/issues/3363 PR #3369 https://github.com/Genymobile/scrcpy/pull/3369 Signed-off-by: Romain Vimont rom@rom1v.com",Use precise scrolling values,"Since SDL 2.0.18, the amount scrolled horizontally or vertically is exposed as a float (between 0 and 1). Forward a precise value to the Android device when possible. Refs link Fixes #3363 link PR #3369 link Signed-off-by: Romain Vimont rom@rom1v.com"
281,Add conversion from float to fixed-point i16,To encode float values between -1 and 1. PR #3369 https://github.com/Genymobile/scrcpy/pull/3369,Add conversion from float to fixed-point i16,To encode float values between -1 and 1. PR #3369 link
282,Add unit test for float encoding,PR #3369 https://github.com/Genymobile/scrcpy/pull/3369,Add unit test for float encoding,PR #3369 link
283,Extract conversion from float to u16 fixed-point,PR #3369 https://github.com/Genymobile/scrcpy/pull/3369,Extract conversion from float to u16 fixed-point,PR #3369 link
284,Rename buffer_util.h to binary.h,It will allow to expose more binary util functions not related to buffers. PR #3369 https://github.com/Genymobile/scrcpy/pull/3369,Rename buffer_util.h to binary.h,It will allow to expose more binary util functions not related to buffers. PR #3369 link
285,Add unit test for float decoding,PR #3369 https://github.com/Genymobile/scrcpy/pull/3369,Add unit test for float decoding,PR #3369 link
286,Extract conversion from u16 fixed-point to float,PR #3369 https://github.com/Genymobile/scrcpy/pull/3369,Extract conversion from u16 fixed-point to float,PR #3369 link
287,Move toUnsigned() to a Binary util class,PR #3369 https://github.com/Genymobile/scrcpy/pull/3369,Move toUnsigned() to a Binary util class,PR #3369 link
288,Remove deprecated meson.source_root(),"This method is deprecated since Meson 0.56.0: https://mesonbuild.com/Release-notes-for-0-56-0.html#mesonbuild_root-and-mesonsource_root-are-deprecated We could replace it with meson.project_source_root(), but this would make Meson 0.56 or above mandatory. Since the path in always computed from the server/ directory, just add '..' to reference the root project directory. Refs c456e3826470753bdaefcffc93e9ae1bf25b12f7",Remove deprecated meson.source_root(),"This method is deprecated since Meson 0.56.0: link We could replace it with meson.project_source_root(), but this would make Meson 0.56 or above mandatory. Since the path in always computed from the server/ directory, just add '..' to reference the root project directory. Refs c456e3826470753bdaefcffc93e9ae1bf25b12f7"
289,Move README and FAQ translations to the wiki,"This lowers the barrier to contribute to translations, and frees up my maintenance time used to review and merge translations and their updates in many languages.",Move README and FAQ translations to the wiki,"This lowers the barrier to contribute to translations, and frees up my maintenance time used to review and merge translations and their updates in many languages."
290,Fix FAQ formatting,,Fix FAQ formatting,
291,Use DisplayManagerGlobal instance,Use the client instance to communicate with the DisplayManager server. Fixes #3446 https://github.com/Genymobile/scrcpy/issues/3446 Signed-off-by: Romain Vimont rom@rom1v.com,Use DisplayManagerGlobal instance,Use the client instance to communicate with the DisplayManager server. Fixes #3446 link Signed-off-by: Romain Vimont rom@rom1v.com
292,Rename net_listen() parameter,"For consistency with net_accept(), which necessarily uses a server socket, name the net_listen() parameter ""server_socket"".",Rename net_listen() parameter,"For consistency with net_accept(), which necessarily uses a server socket, name the net_listen() parameter ""server_socket""."
293,Replace '%g' by '%f' as printf format,"For some reason, '%g' does not work correctly with MinGW. Refs #3369 https://github.com/Genymobile/scrcpy/pull/3369 PR #3399 https://github.com/Genymobile/scrcpy/pull/3399",Replace '%g' by '%f' as printf format,"For some reason, '%g' does not work correctly with MinGW. Refs #3369 link PR #3399 link"
294,Detect Windows using _WIN32 in network util,"For consistency, always use _WIN32 instead of a mix of WINDOWS and _WIN32.",Detect Windows using _WIN32 in network util,"For consistency, always use _WIN32 instead of a mix of WINDOWS and _WIN32."
295,Fix protocol documentation in comments,"Flags were in the correct order in the schema, but their description were reversed.",Fix protocol documentation in comments,"Flags were in the correct order in the schema, but their description were reversed."
296,Add missing allocation failure check,,Add missing allocation failure check,
297,Add missing LOG_OOM() on malloc failure,,Add missing LOG_OOM() on malloc failure,
298,Remove useless dependencies reference,There is no libs/ directory with local jar files.,Remove useless dependencies reference,There is no libs/ directory with local jar files.
299,Document envvars for all platforms,"Document how to set environment variables from the terminal for bash, cmd and PowerShell.",Document envvars for all platforms,"Document how to set environment variables from the terminal for bash, cmd and PowerShell."
300,Fix environment variable configuration in FAQ,"In bash, the variable is set using ""export"".",Fix environment variable configuration in FAQ,"In bash, the variable is set using ""export""."
301,Remove unused stream.h,The file was not removed by 7dec225cebbf208cf1d607bd45fb49e3a9fa1167.,Remove unused stream.h,The file was not removed by 7dec225cebbf208cf1d607bd45fb49e3a9fa1167.
302,Rename function to simplify,"For consistency with sc_adb_parse_device(), do not include ""from_output"" in the function name.",Rename function to simplify,"For consistency with sc_adb_parse_device(), do not include ""from_output"" in the function name."
303,Add missing return 0 in tests,,Add missing return 0 in tests,
304,Fix function declarations,Add missing void in function parameters list.,Fix function declarations,Add missing void in function parameters list.
305,Reduce SHA-256 size in README and BUILD,This avoids breaking the page layout on GitHub.,Reduce SHA-256 size in README and BUILD,This avoids breaking the page layout on GitHub.
306,Update links to v1.24,,Update links to v1.24,
307,Bump version to 1.24,,Bump version to 1.24,
308,Merge branch 'master' into dev,,Merge branch 'master' into dev,
309,"Revert ""Make OTG window resizable""","On Windows and macOS, resizing blocks the event loop. Handling it properly would require the same workaround as done in screen.c. This reverts commit 436b368f9df4469274502f29626586b48db44a0c.","Revert ""Make OTG window resizable""","On Windows and macOS, resizing blocks the event loop. Handling it properly would require the same workaround as done in screen.c. This reverts commit 436b368f9df4469274502f29626586b48db44a0c."
310,Fix inverted check,SDL_RenderSetLogicalSize() returns 0 on success. Refs fc8942aa03dd18b20d6b2e450b13ba56d2c3489e,Fix inverted check,SDL_RenderSetLogicalSize() returns 0 on success. Refs fc8942aa03dd18b20d6b2e450b13ba56d2c3489e
311,Fix release script for platform-tools 33.0.1,These paths were not updated by commit b8d78743f7fbe7aefed957f41e68efc4791573ba.,Fix release script for platform-tools 33.0.1,These paths were not updated by commit b8d78743f7fbe7aefed957f41e68efc4791573ba.
312,Use quotes for commands in documentation,,Use quotes for commands in documentation,
313,Update installed files list in BUILD documentation,,Update installed files list in BUILD documentation,
314,Upgrade FFmpeg (5.0.1) for Windows 64-bit,Use the latest version of FFmpeg in Windows 64-bit releases.,Upgrade FFmpeg (5.0.1) for Windows 64-bit,Use the latest version of FFmpeg in Windows 64-bit releases.
315,Upgrade SDL (2.0.22) for Windows,Include the latest version of SDL in Windows releases.,Upgrade SDL (2.0.22) for Windows,Include the latest version of SDL in Windows releases.
316,Enable linear filtering in OTG mode,This improves the icon quality with non-standard window size. PR #3219 https://github.com/Genymobile/scrcpy/pull/3219,Enable linear filtering in OTG mode,This improves the icon quality with non-standard window size. PR #3219 link
317,Make OTG window resizable,PR #3219 https://github.com/Genymobile/scrcpy/pull/3219,Make OTG window resizable,PR #3219 link
318,Apply requested window size in OTG mode,Fixes #3099 https://github.com/Genymobile/scrcpy/issues/3099 PR #3219 https://github.com/Genymobile/scrcpy/pull/3219,Apply requested window size in OTG mode,Fixes #3099 link PR #3219 link
319,Create OTG window with HIGHDPI flag,This will avoid poor quality with HiDPI displays. PR #3219 https://github.com/Genymobile/scrcpy/pull/3219,Create OTG window with HIGHDPI flag,This will avoid poor quality with HiDPI displays. PR #3219 link
320,Add option to not power on on start,"By default, on start, the device is powered on. To prevent this behavior, add a new option --no-power-on. Fixes #3148 https://github.com/Genymobile/scrcpy/issues/3148 PR #3210 https://github.com/Genymobile/scrcpy/pull/3210",Add option to not power on on start,"By default, on start, the device is powered on. To prevent this behavior, add a new option --no-power-on. Fixes #3148 link PR #3210 link"
321,Add missing mouse shortcuts in --help,Document 4th-click and 5th-click shortcuts. Fixes #3122 https://github.com/Genymobile/scrcpy/issues/3122,Add missing mouse shortcuts in --help,Document 4th-click and 5th-click shortcuts. Fixes #3122 link
322,Fix GitHub case in BUILD,"Replace ""Github"" with ""GitHub"". PR #3218 https://github.com/Genymobile/scrcpy/pull/3218 Signed-off-by: Romain Vimont rom@rom1v.com",Fix GitHub case in BUILD,"Replace ""Github"" with ""GitHub"". PR #3218 link Signed-off-by: Romain Vimont rom@rom1v.com"
323,Fix typo in German README,"Replace ""Wifi"" with ""Wi-Fi"", as in English and other translations. PR #3217 https://github.com/Genymobile/scrcpy/pull/3217 Signed-off-by: Romain Vimont rom@rom1v.com",Fix typo in German README,"Replace ""Wifi"" with ""Wi-Fi"", as in English and other translations. PR #3217 link Signed-off-by: Romain Vimont rom@rom1v.com"
324,Fix typos in Indonesian README,Fix code blocks. PR #3216 https://github.com/Genymobile/scrcpy/pull/3216 Signed-off-by: Romain Vimont rom@rom1v.com,Fix typos in Indonesian README,Fix code blocks. PR #3216 link Signed-off-by: Romain Vimont rom@rom1v.com
325,Upgrade libusb (1.0.26) for Windows,Upgrade and enable libusb support for Windows 32-bit builds. Refs #3011 https://github.com/Genymobile/scrcpy/pull/3011 Fixes #3204 https://github.com/Genymobile/scrcpy/issues/3204 PR #3206 https://github.com/Genymobile/scrcpy/pull/3206,Upgrade libusb (1.0.26) for Windows,Upgrade and enable libusb support for Windows 32-bit builds. Refs #3011 link Fixes #3204 link PR #3206 link
326,Upgrade platform-tools (33.0.1) for Windows,PR #3206 https://github.com/Genymobile/scrcpy/pull/3206,Upgrade platform-tools (33.0.1) for Windows,PR #3206 link
327,Remove obsolete alternative injection method,"The previous commit replaced the IInterface instance (the ""input"" service) by the InputManager instance (retrieved by InputManager.getInstance()). Both define an ""injectInputEvent"" method, but the alternate version (probably) does not concern the InputManager. This reverts commit b7a06278fee0dbfbb18b651ad563d9fb0797c8bc. PR #3190 https://github.com/Genymobile/scrcpy/pull/3190",Remove obsolete alternative injection method,"The previous commit replaced the IInterface instance (the ""input"" service) by the InputManager instance (retrieved by InputManager.getInstance()). Both define an ""injectInputEvent"" method, but the alternate version (probably) does not concern the InputManager. This reverts commit b7a06278fee0dbfbb18b651ad563d9fb0797c8bc. PR #3190 link"
328,Adapt event injection to Android 13,"Using the ""input"" service results in a permission error in Android 13. Use the InputManager instance (retrieved by InputManager.getInstance()) instead. Fixes #3186 https://github.com/Genymobile/scrcpy/issues/3186 PR #3190 https://github.com/Genymobile/scrcpy/pull/3190",Adapt event injection to Android 13,"Using the ""input"" service results in a permission error in Android 13. Use the InputManager instance (retrieved by InputManager.getInstance()) instead. Fixes #3186 link PR #3190 link"
329,Improve README,"Improve clarity, grammar, consistency, punctuation, and formatting. PR #3177 https://github.com/Genymobile/scrcpy/pull/3177 Signed-off-by: Romain Vimont rom@rom1v.com",Improve README,"Improve clarity, grammar, consistency, punctuation, and formatting. PR #3177 link Signed-off-by: Romain Vimont rom@rom1v.com"
330,Fix typos/grammar issues in README,PR #3174 https://github.com/Genymobile/scrcpy/pull/3174 Signed-off-by: Romain Vimont rom@rom1v.com,Fix typos/grammar issues in README,PR #3174 link Signed-off-by: Romain Vimont rom@rom1v.com
331,Update README.it.md to v1.23,PR #3151 https://github.com/Genymobile/scrcpy/pull/3151 Signed-off-by: Romain Vimont rom@rom1v.com,Update README.it.md to v1.23,PR #3151 link Signed-off-by: Romain Vimont rom@rom1v.com
332,Add missing SC_ prefix to header guards,,Add missing SC_ prefix to header guards,
333,Add missing include,Refs c3d45c8397b7886d9071ccd69f04e2c9245fb8e7,Add missing include,Refs c3d45c8397b7886d9071ccd69f04e2c9245fb8e7
334,Fix reference to FAQ in README,PR #3065 https://github.com/Genymobile/scrcpy/pull/3065 Signed-off-by: Romain Vimont rom@rom1v.com,Fix reference to FAQ in README,PR #3065 link Signed-off-by: Romain Vimont rom@rom1v.com
335,Fix icon path in ./run,The data/ directory has been moved to app/data/. Refs 36c75e15b8e9eeb01bd287a42fa3f1513a728ebb,Fix icon path in ./run,The data/ directory has been moved to app/data/. Refs 36c75e15b8e9eeb01bd287a42fa3f1513a728ebb
336,Fix OpenGL ES prefix skip,,Fix OpenGL ES prefix skip,
337,Improve README.zh-Hans.md,"Fix misleading zoom instruction, which gave opposite action steps. PR #3126 https://github.com/Genymobile/scrcpy/pull/3126 Signed-off-by: Romain Vimont rom@rom1v.com",Improve README.zh-Hans.md,"Fix misleading zoom instruction, which gave opposite action steps. PR #3126 link Signed-off-by: Romain Vimont rom@rom1v.com"
338,Consider emulators as TCP/IP devices,"Emulators were wrongly considered as USB devices, so they were selected using -d instead of -e (which was inconsistent with the adb behavior). Refs #3005 https://github.com/Genymobile/scrcpy/issues/3005 Refs #3137 https://github.com/Genymobile/scrcpy/issues/3137",Consider emulators as TCP/IP devices,"Emulators were wrongly considered as USB devices, so they were selected using -d instead of -e (which was inconsistent with the adb behavior). Refs #3005 link Refs #3137 link"
339,Log an error on unexpected device state,Refs #3129 https://github.com/Genymobile/scrcpy/issues/3129,Log an error on unexpected device state,Refs #3129 link
340,Use $ANDROID_SERIAL if no selector is specified,"Like adb, read the ANDROID_SERIAL environment variable to select a device by serial if no explicit selection (-s, -d, -e or --tcpip=) is provided via the command line. Fixes #3111 https://github.com/Genymobile/scrcpy/issues/3111 PR #3113 https://github.com/Genymobile/scrcpy/pull/3113",Use $ANDROID_SERIAL if no selector is specified,"Like adb, read the ANDROID_SERIAL environment variable to select a device by serial if no explicit selection (-s, -d, -e or --tcpip=) is provided via the command line. Fixes #3111 link PR #3113 link"
341,Document exit status in --help,Refs #3085 https://github.com/Genymobile/scrcpy/pull/3085,Document exit status in --help,Refs #3085 link
342,Add specific exit code for device disconnection,"Modify the return logic such that exit code 1 is used when the initial connection fails, but if a session is established, and then the device disconnects, exit code 2 is emitted. Fixes #3083 https://github.com/Genymobile/scrcpy/issues/3083 PR #3085 https://github.com/Genymobile/scrcpy/pull/3085 Signed-off-by: martin f. krafft madduck@madduck.net Signed-off-by: Romain Vimont rom@rom1v.com",Add specific exit code for device disconnection,"Modify the return logic such that exit code 1 is used when the initial connection fails, but if a session is established, and then the device disconnects, exit code 2 is emitted. Fixes #3083 link PR #3085 link Signed-off-by: martin f. krafft madduck@madduck.net Signed-off-by: Romain Vimont rom@rom1v.com"
343,Report server connection state,"We must distinguish 3 cases for await_for_server():  - an error occurred  - no error occurred, the device is connected  - no error occurred, the device is not connected (user requested to    quit) For this purpose, use an additional output parameter to indicate if the device is connected (only set when no error occurs). Refs #3085 https://github.com/Genymobile/scrcpy/pull/3085",Report server connection state,"We must distinguish 3 cases for await_for_server():  - an error occurred  - no error occurred, the device is connected  - no error occurred, the device is not connected (user requested to    quit) For this purpose, use an additional output parameter to indicate if the device is connected (only set when no error occurs). Refs #3085 link"
344,Improve HID event push error message,"On HID event push failure, add the event type in the error message.",Improve HID event push error message,"On HID event push failure, add the event type in the error message."
345,Fix typo in error message,,Fix typo in error message,
346,Add libusb error log,Log libusb_get_string_descriptor_ascii() errors. Refs #3050 https://github.com/Genymobile/scrcpy/issues/3050,Add libusb error log,Log libusb_get_string_descriptor_ascii() errors. Refs #3050 link
347,Fix icon path in README,The data/ directory was moved to app/data/. Refs 36c75e15b8e9eeb01bd287a42fa3f1513a728ebb,Fix icon path in README,The data/ directory was moved to app/data/. Refs 36c75e15b8e9eeb01bd287a42fa3f1513a728ebb
348,Update links to v1.23,,Update links to v1.23,
349,Bump version to 1.23,,Bump version to 1.23,
350,Merge branch 'master' into dev,,Merge branch 'master' into dev,
351,Add missing include for vector,Include stdlib.h for realloc().,Add missing include for vector,Include stdlib.h for realloc().
352,Add contact links to the README,Add Reddit and Twitter links (and an additional link to the GitHub issues).,Add contact links to the README,Add Reddit and Twitter links (and an additional link to the GitHub issues).
353,Add Bash completion script,Fixes #2930 https://github.com/Genymobile/scrcpy/issues/2930 Refs #3012 https://github.com/Genymobile/scrcpy/pull/3012,Add Bash completion script,Fixes #2930 link Refs #3012 link
354,Add ZSH completion script,PR #3012 https://github.com/Genymobile/scrcpy/pull/3012 Signed-off-by: Romain Vimont rom@rom1v.com,Add ZSH completion script,PR #3012 link Signed-off-by: Romain Vimont rom@rom1v.com
355,"Move ""Device unauthorized"" in FAQ","Put ""Device not detected"" first.","Move ""Device unauthorized"" in FAQ","Put ""Device not detected"" first."
356,Update FAQ to match the latest version,,Update FAQ to match the latest version,
357,Remove spurious empty line,,Remove spurious empty line,
358,Mention adb wireless option for Android 11+,Add a paragraph about toggling an option to bypass having to physically connect the device to the user's computer. PR #1303 https://github.com/Genymobile/scrcpy/pull/1303 Signed-off-by: Romain Vimont rom@rom1v.com,Mention adb wireless option for Android 11+,Add a paragraph about toggling an option to bypass having to physically connect the device to the user's computer. PR #1303 link Signed-off-by: Romain Vimont rom@rom1v.com
359,Make step more explicit in wireless section,PR #1303 https://github.com/Genymobile/scrcpy/pull/1303 Signed-off-by: Romain Vimont rom@rom1v.com,Make step more explicit in wireless section,PR #1303 link Signed-off-by: Romain Vimont rom@rom1v.com
360,Add troubleshooting in wireless section,"Add a small troubleshooting section since wireless might add some complexity, and to lessen incoming relevant issue posts. PR #1303 https://github.com/Genymobile/scrcpy/pull/1303 Signed-off-by: Romain Vimont rom@rom1v.com",Add troubleshooting in wireless section,"Add a small troubleshooting section since wireless might add some complexity, and to lessen incoming relevant issue posts. PR #1303 link Signed-off-by: Romain Vimont rom@rom1v.com"
361,Improve phrasing in wireless section,PR #1303 https://github.com/Genymobile/scrcpy/pull/1303 Signed-off-by: Romain Vimont rom@rom1v.com,Improve phrasing in wireless section,PR #1303 link Signed-off-by: Romain Vimont rom@rom1v.com
362,Renumber steps in wireless section,"The actual numbers are ignored by markdown, but start at 1 for consistency. PR #1303 https://github.com/Genymobile/scrcpy/pull/1303 Signed-off-by: Romain Vimont rom@rom1v.com",Renumber steps in wireless section,"The actual numbers are ignored by markdown, but start at 1 for consistency. PR #1303 link Signed-off-by: Romain Vimont rom@rom1v.com"
363,Add an explicit first step in wireless section,"Mention that the device must be plugged via USB before configuring TCP/IP connections. It wasn't obvious that the device should be first plugged before running scrcpy wirelessly, especially to those who aren't very familiar with adb. Note from committer: add this new step with index 0 to make the diff readable, the next commit will renumber all the steps. PR #1303 https://github.com/Genymobile/scrcpy/pull/1303 Signed-off-by: Romain Vimont rom@rom1v.com",Add an explicit first step in wireless section,"Mention that the device must be plugged via USB before configuring TCP/IP connections. It wasn't obvious that the device should be first plugged before running scrcpy wirelessly, especially to those who aren't very familiar with adb. Note from committer: add this new step with index 0 to make the diff readable, the next commit will renumber all the steps. PR #1303 link Signed-off-by: Romain Vimont rom@rom1v.com"
364,Update HID/OTG features in README,HID/OTG features are not limited to Linux anymore. Refs 82a99f69ec464a0637a16bdccfe5ff806777e942,Update HID/OTG features in README,HID/OTG features are not limited to Linux anymore. Refs 82a99f69ec464a0637a16bdccfe5ff806777e942
365,Reorder --tcpip option in cli,To keep options in alphabetic order.,Reorder --tcpip option in cli,To keep options in alphabetic order.
366,Also retry on IllegalArgumentException,MediaCodec.configure() may throw an IllegalArgumentException if it does not support the requested size. Also retry on this exception. Fixes #2993 https://github.com/Genymobile/scrcpy/issues/2993 Refs #2947 https://github.com/Genymobile/scrcpy/pull/2947 Refs #2990 https://github.com/Genymobile/scrcpy/pull/2990 PR #3043 https://github.com/Genymobile/scrcpy/pull/3043,Also retry on IllegalArgumentException,MediaCodec.configure() may throw an IllegalArgumentException if it does not support the requested size. Also retry on this exception. Fixes #2993 link Refs #2947 link Refs #2990 link PR #3043 link
367,Increase adb devices -l max output size,"For simplicity, the parsing of adb devices -l output is performed in a single pass on the whole output. This output was limited to 4096 bytes. Since there are about 100 chars per device line, this limited the number of connected devices to ~40. Increase to 65536 bytes to avoid a limitation in practice. PR #3035 https://github.com/Genymobile/scrcpy/pull/3035",Increase adb devices -l max output size,"For simplicity, the parsing of adb devices -l output is performed in a single pass on the whole output. This output was limited to 4096 bytes. Since there are about 100 chars per device line, this limited the number of connected devices to ~40. Increase to 65536 bytes to avoid a limitation in practice. PR #3035 link"
368,Use vector for listing ADB devices,This avoids the hardcoded maximum number of ADB devices detected (16). Refs #3029 https://github.com/Genymobile/scrcpy/pull/3029 PR #3035 https://github.com/Genymobile/scrcpy/pull/3035 Co-authored-by: Daniel Ansorregui d.ansorregui@samsung.com,Use vector for listing ADB devices,This avoids the hardcoded maximum number of ADB devices detected (16). Refs #3029 link PR #3035 link Co-authored-by: Daniel Ansorregui d.ansorregui@samsung.com
369,Use vector for listing USB devices,This avoids the hardcoded maximum number of USB devices detected (16). Refs #3029 https://github.com/Genymobile/scrcpy/pull/3029 PR #3035 https://github.com/Genymobile/scrcpy/pull/3035,Use vector for listing USB devices,This avoids the hardcoded maximum number of USB devices detected (16). Refs #3029 link PR #3035 link
370,Add sc_vector,"Adapt vlc_vector 1, that I initially wrote while implementing the VLC playlist 2. Change the implementation to use ""statement expressions"" 3, which are forbidden in VLC because ""non-standard"", but:  - they are supported by gcc and clang;  - they are already used in the scrcpy codebase;  - they avoid implementation hacks (VLC_VECTOR_FAILFLAG_);  - they allow a better API (sc_vector_index_of() may return the result    without an output parameter). PR #3035 https://github.com/Genymobile/scrcpy/pull/3035",Add sc_vector,"Adapt vlc_vector 1, that I initially wrote while implementing the VLC playlist 2. Change the implementation to use ""statement expressions"" 3, which are forbidden in VLC because ""non-standard"", but:  - they are supported by gcc and clang;  - they are already used in the scrcpy codebase;  - they avoid implementation hacks (VLC_VECTOR_FAILFLAG_);  - they allow a better API (sc_vector_index_of() may return the result    without an output parameter). PR #3035 link"
371,Move data/ to app/,The files in data/ are specific to the client app (not the server). This also avoids to reference the parent directory (../) from app/meson.build. Refs 8d583d36e259ba7f5f21d7a703cca73184200aa9,Move data/ to app/,The files in data/ are specific to the client app (not the server). This also avoids to reference the parent directory (../) from app/meson.build. Refs 8d583d36e259ba7f5f21d7a703cca73184200aa9
372,Disable USB features for win32,"Currently, there is an issue with the libusb prebuilt dll. Refs libusb/#1049 https://github.com/libusb/libusb/issues/1049 PR #3011 https://github.com/Genymobile/scrcpy/pull/3011",Disable USB features for win32,"Currently, there is an issue with the libusb prebuilt dll. Refs libusb/#1049 link PR #3011 link"
373,Forbid HID input without OTG on Windows,"On Windows, if the adb daemon is running, opening the USB device will necessarily fail, so HID input is not possible. Refs #2773 https://github.com/Genymobile/scrcpy/issues/2773 PR #3011 https://github.com/Genymobile/scrcpy/pull/3011",Forbid HID input without OTG on Windows,"On Windows, if the adb daemon is running, opening the USB device will necessarily fail, so HID input is not possible. Refs #2773 link PR #3011 link"
374,Kill adb daemon in OTG mode on Windows,"On Windows, it is not possible to open a USB device from several process, so HID events may only work if no adb daemon is running. PR #3011 https://github.com/Genymobile/scrcpy/pull/3011",Kill adb daemon in OTG mode on Windows,"On Windows, it is not possible to open a USB device from several process, so HID events may only work if no adb daemon is running. PR #3011 link"
375,Make intr optional for adb commands,"All adb commands are executed with an ""interruptor"", so that they can be interrupted on Ctrl+C. Make this interruptor optional, so that we could call ""adb kill-server"" in OTG mode. This command always returns almost immediately anyway. Ideally, we should make all blocking calls interruptible (including libusb calls, by using the asynchronous API), but it's a lot of work, and in practice it works well enough. PR #3011 https://github.com/Genymobile/scrcpy/pull/3011",Make intr optional for adb commands,"All adb commands are executed with an ""interruptor"", so that they can be interrupted on Ctrl+C. Make this interruptor optional, so that we could call ""adb kill-server"" in OTG mode. This command always returns almost immediately anyway. Ideally, we should make all blocking calls interruptible (including libusb calls, by using the asynchronous API), but it's a lot of work, and in practice it works well enough. PR #3011 link"
376,Remove obsolete text in error message,The HID/OTG features are now available on all platforms. PR #3011 https://github.com/Genymobile/scrcpy/pull/3011,Remove obsolete text in error message,The HID/OTG features are now available on all platforms. PR #3011 link
377,Build for Windows with libusb support,Fixes #2773 https://github.com/Genymobile/scrcpy/issues/2773 PR #3011 https://github.com/Genymobile/scrcpy/pull/3011,Build for Windows with libusb support,Fixes #2773 link PR #3011 link
378,Fix libusb callback for Windows,Add LIBUSB_CALL so that the callback has the correct signature on Windows (including attribute((stdcall))). PR #3011 https://github.com/Genymobile/scrcpy/pull/3011,Fix libusb callback for Windows,Add LIBUSB_CALL so that the callback has the correct signature on Windows (including attribute((stdcall))). PR #3011 link
379,Avoid PRIx16 printf format on Windows,"Convert uint16_t to unsigned to avoid using PRIx16, which may not exist on Windows. PR #3011 https://github.com/Genymobile/scrcpy/pull/3011",Avoid PRIx16 printf format on Windows,"Convert uint16_t to unsigned to avoid using PRIx16, which may not exist on Windows. PR #3011 link"
380,Remove USB hotplug callback error log,"If it fails, the error is already logged by sc_usb_register_callback(). PR #3011 https://github.com/Genymobile/scrcpy/pull/3011",Remove USB hotplug callback error log,"If it fails, the error is already logged by sc_usb_register_callback(). PR #3011 link"
381,Report USB device disconnection when detected,"USB device disconnection is detected via a hotplug callback when it is supported. In addition, report disconnection on libusb calls returning LIBUSB_ERROR_NO_DEVICE or LIBUSB_ERROR_NOT_FOUND. This allows to detect disconnection after a libusb call when hotplug is not available. PR #3011 https://github.com/Genymobile/scrcpy/pull/3011",Report USB device disconnection when detected,"USB device disconnection is detected via a hotplug callback when it is supported. In addition, report disconnection on libusb calls returning LIBUSB_ERROR_NO_DEVICE or LIBUSB_ERROR_NOT_FOUND. This allows to detect disconnection after a libusb call when hotplug is not available. PR #3011 link"
382,Work around mouse capture SDL bug on macOS,"On macOS, SDL relative mouse mode does not work correctly when the cursor is outside the window. As a workaround, move the cursor inside the window before setting the relative mouse mode. Refs SDL/#5340 https://github.com/libsdl-org/SDL/issues/5340 PR #3031 https://github.com/Genymobile/scrcpy/pull/3031",Work around mouse capture SDL bug on macOS,"On macOS, SDL relative mouse mode does not work correctly when the cursor is outside the window. As a workaround, move the cursor inside the window before setting the relative mouse mode. Refs SDL/#5340 link PR #3031 link"
383,Pass screen instance to mouse capture functions,Using the screen instance or not in these functions is an implementation detail. Further changes will require the screen instance. Refs 7848a387c8281cb156f0e0da6bbbb05cda31db22 PR #3031 https://github.com/Genymobile/scrcpy/pull/3031,Pass screen instance to mouse capture functions,Using the screen instance or not in these functions is an implementation detail. Further changes will require the screen instance. Refs 7848a387c8281cb156f0e0da6bbbb05cda31db22 PR #3031 link
384,"Remove ""linux-only"" mentions for HID/OTG features",HID/OTG features are not limited to Linux anymore. PR #3031 https://github.com/Genymobile/scrcpy/pull/3031,"Remove ""linux-only"" mentions for HID/OTG features",HID/OTG features are not limited to Linux anymore. PR #3031 link
385,Build on macOS with libusb support,Fixes #2774 https://github.com/Genymobile/scrcpy/issues/2774 PR #3031 https://github.com/Genymobile/scrcpy/pull/3031,Build on macOS with libusb support,Fixes #2774 link PR #3031 link
386,Fix typo,,Fix typo,
387,Remove useless '\n' in log,,Remove useless '\n' in log,
388,Remove fprintf() in tests,It was committed by mistake.,Remove fprintf() in tests,It was committed by mistake.
389,Add --print-fps to enable FPS counter on start,The FPS counter could be enabled/disabled via MOD+i. Add a command line option to enable it on start. This is consistent with other features like --turn-screen-off or --fullscreen. Fixes #468 https://github.com/Genymobile/scrcpy/issues/468 PR #3030 https://github.com/Genymobile/scrcpy/pull/3030,Add --print-fps to enable FPS counter on start,The FPS counter could be enabled/disabled via MOD+i. Add a command line option to enable it on start. This is consistent with other features like --turn-screen-off or --fullscreen. Fixes #468 link PR #3030 link
390,Move FPS counter start/stop logs,This will allow to print the same logs for every start/stop call. PR #3030 https://github.com/Genymobile/scrcpy/pull/3030,Move FPS counter start/stop logs,This will allow to print the same logs for every start/stop call. PR #3030 link
391,Update FAQ about Windows scaling behavior,Recommend to update to v1.22 before suggesting manual configuration. Fixes #3028 https://github.com/Genymobile/scrcpy/issues/3028 PR #3032 https://github.com/Genymobile/scrcpy/pull/3032,Update FAQ about Windows scaling behavior,Recommend to update to v1.22 before suggesting manual configuration. Fixes #3028 link PR #3032 link
392,Use sc_prefix for fps counter,,Use sc_prefix for fps counter,
393,Fix links in German README,There were three links that weren't displayed correctly due to incorrect references:  - the Windows release link to README.md#windows  - 2 links that expected a German reference but got an English reference PR #3026 https://github.com/Genymobile/scrcpy/pull/3026 Signed-off-by: Romain Vimont rom@rom1v.com,Fix links in German README,There were three links that weren't displayed correctly due to incorrect references:  - the Windows release link to README.md#windows  - 2 links that expected a German reference but got an English reference PR #3026 link Signed-off-by: Romain Vimont rom@rom1v.com
394,Enforce deadline reached on timeout,"The value of sc_tick_now() has microsecond precision, but sc_cond_timedwait() has only millisecond precision. To guarantee that sc_tick_now() >= deadline when sc_cond_timedwait() returns due to timeout, round up to the next millisecond. This avoids to call a non-blocking sc_cond_timedwait() in a loop for no reason until a target deadline during up to 1 millisecond. Refs 682a6911735cb8f6dccd9653ce30b72f267235c6",Enforce deadline reached on timeout,"The value of sc_tick_now() has microsecond precision, but sc_cond_timedwait() has only millisecond precision. To guarantee that sc_tick_now() >= deadline when sc_cond_timedwait() returns due to timeout, round up to the next millisecond. This avoids to call a non-blocking sc_cond_timedwait() in a loop for no reason until a target deadline during up to 1 millisecond. Refs 682a6911735cb8f6dccd9653ce30b72f267235c6"
395,Fix fps_counter tick type,"The type uint32_t is not sufficient to store the result of sc_tick_now(). As a consequence, the FPS counter entered a live loop and caused a lock starvation (deadlock in practice). Refs ec871dd3f596a8183e37982821645ac5a5791fe0 Refs 682a6911735cb8f6dccd9653ce30b72f267235c6",Fix fps_counter tick type,"The type uint32_t is not sufficient to store the result of sc_tick_now(). As a consequence, the FPS counter entered a live loop and caused a lock starvation (deadlock in practice). Refs ec871dd3f596a8183e37982821645ac5a5791fe0 Refs 682a6911735cb8f6dccd9653ce30b72f267235c6"
396,Add German translation of README.md,PR #3023 https://github.com/Genymobile/scrcpy/pull/3023 Signed-off-by: Romain Vimont rom@rom1v.com,Add German translation of README.md,PR #3023 link Signed-off-by: Romain Vimont rom@rom1v.com
397,Add --no-cleanup option,"It might be useful not to cleanup on exit, for example to leave the screen turned off, or keep the server binary on the device (via the server option ""cleanup=false""). Fixes #1764 https://github.com/Genymobile/scrcpy/issues/1764 PR #3020 https://github.com/Genymobile/scrcpy/pull/3020",Add --no-cleanup option,"It might be useful not to cleanup on exit, for example to leave the screen turned off, or keep the server binary on the device (via the server option ""cleanup=false""). Fixes #1764 link PR #3020 link"
398,Fix order of options,"In alphabetic order, ""no-clipboard-autosync"" is before ""no-downsize-on-error"".",Fix order of options,"In alphabetic order, ""no-clipboard-autosync"" is before ""no-downsize-on-error""."
399,Add compilation flag for USB features,This allows to disable HID/OTG features on Linux to build without libusb.,Add compilation flag for USB features,This allows to disable HID/OTG features on Linux to build without libusb.
400,Add compilation flag for V4L2 feature,This allows to disable V4L2 support on Linux to build without libavdevice.,Add compilation flag for V4L2 feature,This allows to disable V4L2 support on Linux to build without libavdevice.
401,Fix double adb tunnel closing,"On error, close the adb tunnel only if it has not already been closed beforehand.",Fix double adb tunnel closing,"On error, close the adb tunnel only if it has not already been closed beforehand."
402,Rename buffer util functions with sc_ prefix,,Rename buffer util functions with sc_ prefix,
403,Rename HEADER_SIZE to SC_PACKET_HEADER_SIZE,Prefix the constant for consistency.,Rename HEADER_SIZE to SC_PACKET_HEADER_SIZE,Prefix the constant for consistency.
404,Remove unused BUFSIZE,,Remove unused BUFSIZE,
405,Remove sc_demuxer_parse(),"Now that the key frame flag is known, parsing the packet is useless.",Remove sc_demuxer_parse(),"Now that the key frame flag is known, parsing the packet is useless."
406,Pass key frame flag from the device,MediaCodec indicates when a packet is a key frame. Transmit it to the client.,Pass key frame flag from the device,MediaCodec indicates when a packet is a key frame. Transmit it to the client.
407,Store packet flags in PTS most significant bits,"A special PTS value was used to encode a config packet. To prepare for adding more flags, use the most significant bits of the PTS field to store flags.",Store packet flags in PTS most significant bits,"A special PTS value was used to encode a config packet. To prepare for adding more flags, use the most significant bits of the PTS field to store flags."
408,Indent ifdef for clarity,Make it explicit that the ifdef is an inner block.,Indent ifdef for clarity,Make it explicit that the ifdef is an inner block.
409,Improve error message for unsupported usb hotplug,,Improve error message for unsupported usb hotplug,
410,Do not duplicate relative mouse mode state,"The relative mouse mode is tracked by SDL, and accessible via SDL_GetRelativeMouseMode(). This is more robust in case SDL changes the relative mouse mode on its own.",Do not duplicate relative mouse mode state,"The relative mouse mode is tracked by SDL, and accessible via SDL_GetRelativeMouseMode(). This is more robust in case SDL changes the relative mouse mode on its own."
411,Fix USB device leak on connection error,"If sc_usb_connect() failed, then the sc_usb_device was never destroyed. The assignment was mistakenly removed by commit 61969aeb80093d0777c7716a61698cbdaf9ddd71.",Fix USB device leak on connection error,"If sc_usb_connect() failed, then the sc_usb_device was never destroyed. The assignment was mistakenly removed by commit 61969aeb80093d0777c7716a61698cbdaf9ddd71."
412,Move prebuilt-deps/ to app/,The prebuilt dependencies are specific to the client app (not the server). This also avoids to reference the parent directory (../) from app/meson.build.,Move prebuilt-deps/ to app/,The prebuilt dependencies are specific to the client app (not the server). This also avoids to reference the parent directory (../) from app/meson.build.
413,Reorder release.mk recipes,Group prepare-deps for win32 and win64.,Reorder release.mk recipes,Group prepare-deps for win32 and win64.
414,Pass --buildtype=release as a single meson arg,For consistency with the other arguments,Pass --buildtype=release as a single meson arg,For consistency with the other arguments
415,Print libusb version on --version,,Print libusb version on --version,
416,Print both compiled and linked versions of libs,"On --version, print both the version scrcpy had been compiled against, and the version linked at runtime.",Print both compiled and linked versions of libs,"On --version, print both the version scrcpy had been compiled against, and the version linked at runtime."
417,Move version handling to a separate file,This will avoid to include all dependencies headers from main.c.,Move version handling to a separate file,This will avoid to include all dependencies headers from main.c.
418,Log device opening errors during listing,"Without this log, the user would have no way to know that a USB device is rejected because it could not be opened (typically due to insufficient permissions).",Log device opening errors during listing,"Without this log, the user would have no way to know that a USB device is rejected because it could not be opened (typically due to insufficient permissions)."
419,Mention --select-usb and --select-tcpip in README,PR #3005 https://github.com/Genymobile/scrcpy/pull/3005,Mention --select-usb and --select-tcpip in README,PR #3005 link
420,Add option to select USB or TCP/IP devices,"If several devices are connected (as listed by adb devices), it was necessary to provide the explicit serial via -s/--serial. If only one device is connected via USB (respectively, via TCP/IP), it might be convenient to select it automatically. For this purpose, two new options are introduced:  - -d/--select-usb: select the single device connected over USB  - -e/--select-tcpip: select the single device connected over TCP/IP PR #3005 https://github.com/Genymobile/scrcpy/pull/3005",Add option to select USB or TCP/IP devices,"If several devices are connected (as listed by adb devices), it was necessary to provide the explicit serial via -s/--serial. If only one device is connected via USB (respectively, via TCP/IP), it might be convenient to select it automatically. For this purpose, two new options are introduced:  - -d/--select-usb: select the single device connected over USB  - -e/--select-tcpip: select the single device connected over TCP/IP PR #3005 link"
421,Introduce adb device selector,"Currently, a device is selected either from a specific serial, or if it is the only one connected. In order to support selecting the only device connected via USB or via TCP/IP separately, introduce a new selection structure. PR #3005 https://github.com/Genymobile/scrcpy/pull/3005",Introduce adb device selector,"Currently, a device is selected either from a specific serial, or if it is the only one connected. In order to support selecting the only device connected via USB or via TCP/IP separately, introduce a new selection structure. PR #3005 link"
422,Execute adb start-server,"This does nothing if the adb daemon is already started, but allows to print any output/errors to the console. Otherwise, the daemon starting would occur during adb devices, which does not output to the console because the result is parsed. PR #3005 https://github.com/Genymobile/scrcpy/pull/3005",Execute adb start-server,"This does nothing if the adb daemon is already started, but allows to print any output/errors to the console. Otherwise, the daemon starting would occur during adb devices, which does not output to the console because the result is parsed. PR #3005 link"
423,Remove sc_adb_get_serialno(),"The device serial is now retrieved from adb devices -l, adb get-serialno is not called anymore. PR #3005 https://github.com/Genymobile/scrcpy/pull/3005",Remove sc_adb_get_serialno(),"The device serial is now retrieved from adb devices -l, adb get-serialno is not called anymore. PR #3005 link"
424,Allow selecting a device from IP without port,"Since the previous commit, if a serial is given via -s/--serial (either a real USB serial or an IP:port), a device is selected if its serial matches exactly. In addition, if the user pass an IP without a port, then select any device with this IP, regardless of the port (so that ""192.168.1.1"" matches any ""192.168.1.1:port""). This is also the default behavior of adb. PR #3005 https://github.com/Genymobile/scrcpy/pull/3005",Allow selecting a device from IP without port,"Since the previous commit, if a serial is given via -s/--serial (either a real USB serial or an IP:port), a device is selected if its serial matches exactly. In addition, if the user pass an IP without a port, then select any device with this IP, regardless of the port (so that ""192.168.1.1"" matches any ""192.168.1.1:port""). This is also the default behavior of adb. PR #3005 link"
425,Expose simple API to select a single adb device,Select an adb device from the output of adb device -l. PR #3005 https://github.com/Genymobile/scrcpy/pull/3005,Expose simple API to select a single adb device,Select an adb device from the output of adb device -l. PR #3005 link
426,Expose function to test if a serial is TCP/IP,"In practice, it just tests if the serial contains a ':', which is sufficient to distinguish ip:port from a real USB serial. PR #3005 https://github.com/Genymobile/scrcpy/pull/3005",Expose function to test if a serial is TCP/IP,"In practice, it just tests if the serial contains a ':', which is sufficient to distinguish ip:port from a real USB serial. PR #3005 link"
427,Add adb devices parser,"Add a parser of adb device -l output, to extract a list of devices with their serial, state and model. PR #3005 https://github.com/Genymobile/scrcpy/pull/3005",Add adb devices parser,"Add a parser of adb device -l output, to extract a list of devices with their serial, state and model. PR #3005 link"
428,Refactor device configuration,"Depending on the parameters passed to scrcpy, either the initial device serial is necessary or not. Reorganize to simplify the logic. PR #3005 https://github.com/Genymobile/scrcpy/pull/3005",Refactor device configuration,"Depending on the parameters passed to scrcpy, either the initial device serial is necessary or not. Reorganize to simplify the logic. PR #3005 link"
429,List and select USB devices separately,"List all USB devices in a first step, then select the matching one(s). This allows to report a user-friendly log message containing the list of devices, with the matching one(s) highlighted. PR #3005 https://github.com/Genymobile/scrcpy/pull/3005",List and select USB devices separately,"List all USB devices in a first step, then select the matching one(s). This allows to report a user-friendly log message containing the list of devices, with the matching one(s) highlighted. PR #3005 link"
430,Expose simple API to select a single USB device,The caller just wants a single device. Handle all cases and error messages internally. PR #3005 https://github.com/Genymobile/scrcpy/pull/3005,Expose simple API to select a single USB device,The caller just wants a single device. Handle all cases and error messages internally. PR #3005 link
431,Add move-function for sc_usb_device,"Add a function to ""move"" a sc_usb_device into another instance. This will avoid unnecessary copies. PR #3005 https://github.com/Genymobile/scrcpy/pull/3005",Add move-function for sc_usb_device,"Add a function to ""move"" a sc_usb_device into another instance. This will avoid unnecessary copies. PR #3005 link"
432,Move SC_PRIsizet to compat.h,Define the printf format macro for size_t in compat.h so that it can be used from anywhere. PR #3005 https://github.com/Genymobile/scrcpy/pull/3005,Move SC_PRIsizet to compat.h,Define the printf format macro for size_t in compat.h so that it can be used from anywhere. PR #3005 link
433,Rename function to destroy a list of USB devices,"Rename from ""usb_device_"" to ""usb_devices_"". PR #3005 https://github.com/Genymobile/scrcpy/pull/3005",Rename function to destroy a list of USB devices,"Rename from ""usb_device_"" to ""usb_devices_"". PR #3005 link"
434,Add generic LOG() macro with level parameter,"One log macro was provided for each log level (LOGV(), LOGD(), LOGI(), LOGW(), LOGE()). Add a generic macro LOG(LEVEL, ...) accepting a log level as parameter, so that it is possible to write logging wrappers. PR #3005 https://github.com/Genymobile/scrcpy/pull/3005",Add generic LOG() macro with level parameter,"One log macro was provided for each log level (LOGV(), LOGD(), LOGI(), LOGW(), LOGE()). Add a generic macro LOG(LEVEL, ...) accepting a log level as parameter, so that it is possible to write logging wrappers. PR #3005 link"
435,Remove LOGC(),"It is not clear when to use LOGC() rather than LOGE(). Always use LOGE(). Moreover, enum sc_log_level has no ""critical"" log level.",Remove LOGC(),"It is not clear when to use LOGC() rather than LOGE(). Always use LOGE(). Moreover, enum sc_log_level has no ""critical"" log level."
436,Improve USB device open log,"For consistency with ""List USB devices"", log ""Open USB device"".",Improve USB device open log,"For consistency with ""List USB devices"", log ""Open USB device""."
437,Inline USB device opening,Such a separate function was useless.,Inline USB device opening,Such a separate function was useless.
438,Remove log_libusb_error(),"This helper did not help a lot, and prevented the client to choose the log level and the prefix error message.",Remove log_libusb_error(),"This helper did not help a lot, and prevented the client to choose the log level and the prefix error message."
439,Remove confusing sc_str_truncate(),"This util function was error-prone:  - it accepted a buffer as parameter (not necessarily a NUL-terminated    string) and its length (including the NUL char, if any);  - it wrote '\0' over the last character of the buffer, so the last    character was lost if the buffer was not a NUL-terminated string, and    even worse, it caused undefined behavior if the length was empty;  - it returned the length of the resulting NUL-terminated string,    which was inconsistent with the input buffer length. In addition, it was not necessarily optimal:  - it wrote '\0' twice;  - it required to know the buffer length, that is the input string    length + 1, in advance. Remove this function, and let the client use strcspn() manually.",Remove confusing sc_str_truncate(),"This util function was error-prone:  - it accepted a buffer as parameter (not necessarily a NUL-terminated    string) and its length (including the NUL char, if any);  - it wrote '\0' over the last character of the buffer, so the last    character was lost if the buffer was not a NUL-terminated string, and    even worse, it caused undefined behavior if the length was empty;  - it returned the length of the resulting NUL-terminated string,    which was inconsistent with the input buffer length. In addition, it was not necessarily optimal:  - it wrote '\0' twice;  - it required to know the buffer length, that is the input string    length + 1, in advance. Remove this function, and let the client use strcspn() manually."
440,Fix adb connect parsing,"The function assumed that the raw output of ""adb connect"" was a NUL-terminated string, but it is not the case. It this output did not end with a space or a new line character, then sc_str_truncate() would write '\0' over the last character. Even worse, if the output was empty, then sc_str_truncate() would write out-of-bounds. Avoid the error-prone sc_str_truncate() util function.",Fix adb connect parsing,"The function assumed that the raw output of ""adb connect"" was a NUL-terminated string, but it is not the case. It this output did not end with a space or a new line character, then sc_str_truncate() would write '\0' over the last character. Even worse, if the output was empty, then sc_str_truncate() would write out-of-bounds. Avoid the error-prone sc_str_truncate() util function."
441,Fix adb get-serialno parsing,"The function assumed that the raw output of ""adb get-serialno"" was a NUL-terminated string, but it is not the case. It this output did not end with a space or a new line character, then sc_str_truncate() would write '\0' over the last character. Even worse, if the output was empty, then sc_str_truncate() would write out-of-bounds. Avoid the error-prone sc_str_truncate() util function.",Fix adb get-serialno parsing,"The function assumed that the raw output of ""adb get-serialno"" was a NUL-terminated string, but it is not the case. It this output did not end with a space or a new line character, then sc_str_truncate() would write '\0' over the last character. Even worse, if the output was empty, then sc_str_truncate() would write out-of-bounds. Avoid the error-prone sc_str_truncate() util function."
442,Fix adb getprop parsing,"The function assumed that the raw output of ""adb getprop"" was a NUL-terminated string, but it is not the case. It this output did not end with a space or a new line character, then sc_str_truncate() would write '\0' over the last character. Even worse, if the output was empty, then sc_str_truncate() would write out-of-bounds. Avoid the error-prone sc_str_truncate() util function.",Fix adb getprop parsing,"The function assumed that the raw output of ""adb getprop"" was a NUL-terminated string, but it is not the case. It this output did not end with a space or a new line character, then sc_str_truncate() would write '\0' over the last character. Even worse, if the output was empty, then sc_str_truncate() would write out-of-bounds. Avoid the error-prone sc_str_truncate() util function."
443,Fix adb device ip parsing,"The parser assumed that its input was a NUL-terminated string, but it was not the case: it is just the raw output of ""adb devices ip route"". In practice, it was harmless, since the output always ended with '\n' (which was replaced by '\0' on truncation), but it was incorrect nonetheless. Always write a '\0' at the end of the buffer, and explicitly parse as a NUL-terminated string. For that purpose, avoid the error-prone sc_str_truncate() util function.",Fix adb device ip parsing,"The parser assumed that its input was a NUL-terminated string, but it was not the case: it is just the raw output of ""adb devices ip route"". In practice, it was harmless, since the output always ended with '\n' (which was replaced by '\0' on truncation), but it was incorrect nonetheless. Always write a '\0' at the end of the buffer, and explicitly parse as a NUL-terminated string. For that purpose, avoid the error-prone sc_str_truncate() util function."
444,Store actual serial in sc_server,"Before starting the server, the actual device serial (possibly its ip:port if it's over TCP/IP) must be known. A serial might be requested via -s/--serial (stored in the sc_server_params), but the actual serial may change afterwards:  - if none is provided, then it is retrieved with ""adb get-serialno"";  - if --tcpip is requested, then the final serial will be the target    ip:port. The requested serial was overwritten by the actual serial in the sc_server_params struct, which was a bit hacky. Instead, store a separate serial field in sc_server (and rename the one from sc_server_params to ""req_serial"" to avoid confusion).",Store actual serial in sc_server,"Before starting the server, the actual device serial (possibly its ip:port if it's over TCP/IP) must be known. A serial might be requested via -s/--serial (stored in the sc_server_params), but the actual serial may change afterwards:  - if none is provided, then it is retrieved with ""adb get-serialno"";  - if --tcpip is requested, then the final serial will be the target    ip:port. The requested serial was overwritten by the actual serial in the sc_server_params struct, which was a bit hacky. Instead, store a separate serial field in sc_server (and rename the one from sc_server_params to ""req_serial"" to avoid confusion)."
445,Simplify switch to TCPIP function,"Do not use an output parameter to return the value. Instead, return the actual ip:port string on success or NULL on error.",Simplify switch to TCPIP function,"Do not use an output parameter to return the value. Instead, return the actual ip:port string on success or NULL on error."
446,Build adb argv statically,"Now that providing a serial is mandatory for adb commands where it is relevant, the whole argv array may be built statically, without allocations at runtime.",Build adb argv statically,"Now that providing a serial is mandatory for adb commands where it is relevant, the whole argv array may be built statically, without allocations at runtime."
447,Expose adb executable path publicly,This will allow the caller to build the argv array directly.,Expose adb executable path publicly,This will allow the caller to build the argv array directly.
448,Rename adb_command to adb_executable,"Semantically, a ""command"" refers to the whole command line argv (adb and its arguments).",Rename adb_command to adb_executable,"Semantically, a ""command"" refers to the whole command line argv (adb and its arguments)."
449,Assert non-NULL serial,"If no serial is passed, then the command would work if there is exactly one device connected, but will fail with multiple devices. To avoid such cases, ensure that a serial is always provided.",Assert non-NULL serial,"If no serial is passed, then the command would work if there is exactly one device connected, but will fail with multiple devices. To avoid such cases, ensure that a serial is always provided."
450,"Assert ""adb disconnect"" is called with an argument","Calling ""adb disconnect"" without argument would disconnect every TCP/IP device. We must make sure scrcpy never does that.","Assert ""adb disconnect"" is called with an argument","Calling ""adb disconnect"" without argument would disconnect every TCP/IP device. We must make sure scrcpy never does that."
451,Remove useless undef,The #define was removed in 1c71bd16bec1db0788e72a7c6b02f80ed40f1601.,Remove useless undef,The #define was removed in 1c71bd16bec1db0788e72a7c6b02f80ed40f1601.
452,Remove screensaver log,"If --disable-screensaver is passed, then screensaver is disabled, otherwise it is enabled. No need for a log.",Remove screensaver log,"If --disable-screensaver is passed, then screensaver is disabled, otherwise it is enabled. No need for a log."
453,Remove platform-tools installation suggestion,"On Windows, adb is provided in the release archive. Most missing adb issues come from users setting the ADB environment variable to an incorrect value (on all platforms). Suggesting to install platform-tools to solve the problem will just make things worse (there will be one more adb in yet another location).",Remove platform-tools installation suggestion,"On Windows, adb is provided in the release archive. Most missing adb issues come from users setting the ADB environment variable to an incorrect value (on all platforms). Suggesting to install platform-tools to solve the problem will just make things worse (there will be one more adb in yet another location)."
454,Use sc_ prefix for adb,,Use sc_ prefix for adb,
455,Move ADB code to adb/,,Move ADB code to adb/,
456,Simplify demuxer,"Call the same push_packet_to_sinks() in all cases, and make sc_demuxer_parse() return void.",Simplify demuxer,"Call the same push_packet_to_sinks() in all cases, and make sc_demuxer_parse() return void."
457,Rename stream to sc_demuxer,"For consistency with recorder and decoder, name the component which demuxes a ""demuxer"". And add the missing sc_ prefix.",Rename stream to sc_demuxer,"For consistency with recorder and decoder, name the component which demuxes a ""demuxer"". And add the missing sc_ prefix."
458,Use sc_ prefix for recorder,,Use sc_ prefix for recorder,
459,Use sc_ prefix for decoder,,Use sc_ prefix for decoder,
460,Add missing spaces in help,PR #2994 https://github.com/Genymobile/scrcpy/pull/2994 Signed-off-by: Romain Vimont rom@rom1v.com,Add missing spaces in help,PR #2994 link Signed-off-by: Romain Vimont rom@rom1v.com
461,Downscale and retry also on early MediaCodec error,"The new retry mechanism with a lower definition only worked if the error occurred during encode(). For example: java.lang.IllegalStateException     at android.media.MediaCodec.native_dequeueOutputBuffer(Native Method)     at android.media.MediaCodec.dequeueOutputBuffer(MediaCodec.java:3452)     at com.genymobile.scrcpy.ScreenEncoder.encode(ScreenEncoder.java:114)     at com.genymobile.scrcpy.ScreenEncoder.internalStreamScreen(ScreenEncoder.java:95)     at com.genymobile.scrcpy.ScreenEncoder.streamScreen(ScreenEncoder.java:61)     at com.genymobile.scrcpy.Server.scrcpy(Server.java:80)     at com.genymobile.scrcpy.Server.main(Server.java:255)  However, MediaCodec may also fail before encoding, during configure() or start(). For example: android.media.MediaCodec$CodecException: Error 0xfffffc0e     at android.media.MediaCodec.native_configure(Native Method)     at android.media.MediaCodec.configure(MediaCodec.java:1956)     at android.media.MediaCodec.configure(MediaCodec.java:1885)     at com.genymobile.scrcpy.ScreenEncoder.configure(ScreenEncoder.java:158)     at com.genymobile.scrcpy.ScreenEncoder.streamScreen(ScreenEncoder.java:68)     at com.genymobile.scrcpy.Server.scrcpy(Server.java:28)     at com.genymobile.scrcpy.Server.main(Server.java:110)  Also downscale and retry in these cases. Refs #2947 https://github.com/Genymobile/scrcpy/pull/2947 Refs #2988 https://github.com/Genymobile/scrcpy/issues/2988 PR #2990 https://github.com/Genymobile/scrcpy/pull/2990",Downscale and retry also on early MediaCodec error,"The new retry mechanism with a lower definition only worked if the error occurred during encode(). For example: java.lang.IllegalStateException     at android.media.MediaCodec.native_dequeueOutputBuffer(Native Method)     at android.media.MediaCodec.dequeueOutputBuffer(MediaCodec.java:3452)     at com.genymobile.scrcpy.ScreenEncoder.encode(ScreenEncoder.java:114)     at com.genymobile.scrcpy.ScreenEncoder.internalStreamScreen(ScreenEncoder.java:95)     at com.genymobile.scrcpy.ScreenEncoder.streamScreen(ScreenEncoder.java:61)     at com.genymobile.scrcpy.Server.scrcpy(Server.java:80)     at com.genymobile.scrcpy.Server.main(Server.java:255) However, MediaCodec may also fail before encoding, during configure() or start(). For example: android.media.MediaCodec$CodecException: Error 0xfffffc0e     at android.media.MediaCodec.native_configure(Native Method)     at android.media.MediaCodec.configure(MediaCodec.java:1956)     at android.media.MediaCodec.configure(MediaCodec.java:1885)     at com.genymobile.scrcpy.ScreenEncoder.configure(ScreenEncoder.java:158)     at com.genymobile.scrcpy.ScreenEncoder.streamScreen(ScreenEncoder.java:68)     at com.genymobile.scrcpy.Server.scrcpy(Server.java:28)     at com.genymobile.scrcpy.Server.main(Server.java:110) Also downscale and retry in these cases. Refs #2947 link Refs #2988 link PR #2990 link"
462,Fix include for standard library header,,Fix include for standard library header,
463,Add warning in function documentation,"The function parsing ""ip route"" output modifies the input buffer to tokenize in place. This must be mentioned in the function documentation.",Add warning in function documentation,"The function parsing ""ip route"" output modifies the input buffer to tokenize in place. This must be mentioned in the function documentation."
464,Fix sc_str_truncate() documentation,"The function was initially implemented to truncate lines, but was later generalized to accept custom delimiters. The whole documentation has not been updated accordingly. Refs 9619ade706824a92ea387bdc9d0d27816bf79da5",Fix sc_str_truncate() documentation,"The function was initially implemented to truncate lines, but was later generalized to accept custom delimiters. The whole documentation has not been updated accordingly. Refs 9619ade706824a92ea387bdc9d0d27816bf79da5"
465,Fix comment typo,,Fix comment typo,
466,Update FAQ.zh-Hans.md to v1.22,PR #2989 https://github.com/Genymobile/scrcpy/pull/2989 Signed-off-by: Romain Vimont rom@rom1v.com,Update FAQ.zh-Hans.md to v1.22,PR #2989 link Signed-off-by: Romain Vimont rom@rom1v.com
467,Update README.zh-Hans.md to v1.22,PR #2989 https://github.com/Genymobile/scrcpy/pull/2989 Signed-off-by: Romain Vimont rom@rom1v.com,Update README.zh-Hans.md to v1.22,PR #2989 link Signed-off-by: Romain Vimont rom@rom1v.com
468,Update links to v1.22,,Update links to v1.22,
469,Bump version to 1.22,,Bump version to 1.22,
470,Merge branch 'master' into dev,,Merge branch 'master' into dev,
471,Update README.zh-Hans.md to v1.21,PR #2978 https://github.com/Genymobile/scrcpy/pull/2978 Signed-off-by: Romain Vimont rom@rom1v.com,Update README.zh-Hans.md to v1.21,PR #2978 link Signed-off-by: Romain Vimont rom@rom1v.com
472,Improve prebuilt system,"This aims to fix two issues with the previous implementation:  1. the whole content of downloaded archives were extracted, while only     few files are necessary;  2. the archives were extracted in the prebuild-deps/ directory as is. As a consequence of (2), the actual directory name relied on the root directory of the archive. For adb, this root directory was always ""platform-tools"", so when bumping the adb version, the target directory already existed and the dependency was not upgraded (the old one had to be removed manually). Expose common function to download a file and check its checksum, but let the custom script for each dependency extract only the needed files and reorganize the content if necessary.",Improve prebuilt system,"This aims to fix two issues with the previous implementation:  1. the whole content of downloaded archives were extracted, while only     few files are necessary;  2. the archives were extracted in the prebuild-deps/ directory as is. As a consequence of (2), the actual directory name relied on the root directory of the archive. For adb, this root directory was always ""platform-tools"", so when bumping the adb version, the target directory already existed and the dependency was not upgraded (the old one had to be removed manually). Expose common function to download a file and check its checksum, but let the custom script for each dependency extract only the needed files and reorganize the content if necessary."
473,"Revert ""Upgrade platform-tools (32.0.0) for Windows""",This reverts commit c0de365f672110959cec8fca936bd6aeaa01b59d. The new adb.exe crashes. Refs #2981 comment https://github.com/Genymobile/scrcpy/issues/2981#issuecomment-1024569778,"Revert ""Upgrade platform-tools (32.0.0) for Windows""",This reverts commit c0de365f672110959cec8fca936bd6aeaa01b59d. The new adb.exe crashes. Refs #2981 comment link
474,Fix SC_EXIT_CODE_NONE value,"The exit code on windows is stored in a DWORD, an unsigned long: https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/262627d8-3418-4627-9218-4ffe110850b2 Use the max value of this type for SC_EXIT_CODE_NONE.",Fix SC_EXIT_CODE_NONE value,"The exit code on windows is stored in a DWORD, an unsigned long: link Use the max value of this type for SC_EXIT_CODE_NONE."
475,Add helper to log Windows system errors,It will help to log errors returned by GetLastError() or WSAGetLastError():  - https://docs.microsoft.com/en-us/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror  - https://docs.microsoft.com/en-us/windows/win32/api/winsock/nf-winsock-wsagetlasterror  - https://docs.microsoft.com/en-us/windows/win32/debug/system-error-codes#system-error-codes Always log the errors in English to be able to read them in bug reports.,Add helper to log Windows system errors,It will help to log errors returned by GetLastError() or WSAGetLastError():  - link  - link  - link Always log the errors in English to be able to read them in bug reports.
476,Enable mouse focus clickthrough in OTG mode,A single click on the window must both give focus and capture the mouse. PR #2974 https://github.com/Genymobile/scrcpy/pull/2974,Enable mouse focus clickthrough in OTG mode,A single click on the window must both give focus and capture the mouse. PR #2974 link
477,Make HID keyboard and mouse optional in OTG mode,Allow to only enable HID keyboard or HID mouse: scrcpy --otg -K   # keyboard only scrcpy --otg -M   # mouse only scrcpy --otg -KM  # keyboard and mouse scrcpy --otg      # keyboard and mouse  PR #2974 https://github.com/Genymobile/scrcpy/pull/2974,Make HID keyboard and mouse optional in OTG mode,Allow to only enable HID keyboard or HID mouse: scrcpy --otg -K   # keyboard only scrcpy --otg -M   # mouse only scrcpy --otg -KM  # keyboard and mouse scrcpy --otg      # keyboard and mouse PR #2974 link
478,Document OTG mode in README,PR #2974 https://github.com/Genymobile/scrcpy/pull/2974,Document OTG mode in README,PR #2974 link
479,Add OTG mode,"Add an option --otg to run scrcpy with only physical keyboard and mouse simulation (HID over AOA), without mirroring and without requiring adb. To avoid adding complexity into the scrcpy initialization and screen implementation, OTG mode is implemented totally separately, with a separate window. PR #2974 https://github.com/Genymobile/scrcpy/pull/2974",Add OTG mode,"Add an option --otg to run scrcpy with only physical keyboard and mouse simulation (HID over AOA), without mirroring and without requiring adb. To avoid adding complexity into the scrcpy initialization and screen implementation, OTG mode is implemented totally separately, with a separate window. PR #2974 link"
480,Move input event helpers,"Input events helpers to convert from SDL events to scrcpy events were implemented in input_manager. To reuse them for OTG mode, move them to input_events.h. PR #2974 https://github.com/Genymobile/scrcpy/pull/2974",Move input event helpers,"Input events helpers to convert from SDL events to scrcpy events were implemented in input_manager. To reuse them for OTG mode, move them to input_events.h. PR #2974 link"
481,Detect USB device disconnection,"The device disconnection is detected when the video socket closes. In order to introduce an OTG mode (HID events) without mirroring (and without server), we must be able to detect USB device disconnection. This feature will only be used in OTG mode. PR #2974 https://github.com/Genymobile/scrcpy/pull/2974",Detect USB device disconnection,"The device disconnection is detected when the video socket closes. In order to introduce an OTG mode (HID events) without mirroring (and without server), we must be able to detect USB device disconnection. This feature will only be used in OTG mode. PR #2974 link"
482,Make acksync optional for AOA initialization,"Acksync is used to delay HID events until some request (in practice, device clipboard synchronization) is acknowledged by the device. This mechanism will not be necessary for OTG mode. PR #2974 https://github.com/Genymobile/scrcpy/pull/2974",Make acksync optional for AOA initialization,"Acksync is used to delay HID events until some request (in practice, device clipboard synchronization) is acknowledged by the device. This mechanism will not be necessary for OTG mode. PR #2974 link"
483,Make serial optional to find USB devices,"If no serial is provided, then list all available USB devices (which can be open and having a serial). PR #2974 https://github.com/Genymobile/scrcpy/pull/2974",Make serial optional to find USB devices,"If no serial is provided, then list all available USB devices (which can be open and having a serial). PR #2974 link"
484,Find a list of devices instead of a single one,"Several devices may match the requested serial, but above all, this paves the way to list all devices (when no serial is provided). PR #2974 https://github.com/Genymobile/scrcpy/pull/2974",Find a list of devices instead of a single one,"Several devices may match the requested serial, but above all, this paves the way to list all devices (when no serial is provided). PR #2974 link"
485,Wrap libusb_device,Introduce a structure to wrap a libusb_device and expose its descriptor data read during discovery. PR #2974 https://github.com/Genymobile/scrcpy/pull/2974,Wrap libusb_device,Introduce a structure to wrap a libusb_device and expose its descriptor data read during discovery. PR #2974 link
486,Expose function to find a USB device,"The device was automatically found by sc_usb_connect(). Instead, expose a function to find a device from a serial, and let the caller connect to the device found (if any). This will allow to list all devices first, then select one device to connect to. PR #2974 https://github.com/Genymobile/scrcpy/pull/2974",Expose function to find a USB device,"The device was automatically found by sc_usb_connect(). Instead, expose a function to find a device from a serial, and let the caller connect to the device found (if any). This will allow to list all devices first, then select one device to connect to. PR #2974 link"
487,Add util function to read USB descriptor string,"Use it from accept_device() to simplify (at the cost an additional allocation for each serial, but it is not important). It will also be useful in other functions in further commits. PR #2974 https://github.com/Genymobile/scrcpy/pull/2974",Add util function to read USB descriptor string,"Use it from accept_device() to simplify (at the cost an additional allocation for each serial, but it is not important). It will also be useful in other functions in further commits. PR #2974 link"
488,Split USB initialization and connection,This will allow to execute other USB calls (retrieving the device list for example) before connecting to the selected device. PR #2974 https://github.com/Genymobile/scrcpy/pull/2974,Split USB initialization and connection,This will allow to execute other USB calls (retrieving the device list for example) before connecting to the selected device. PR #2974 link
489,Find device with USB context,An explicit context was used everywhere except for listing the devices. PR #2974 https://github.com/Genymobile/scrcpy/pull/2974,Find device with USB context,An explicit context was used everywhere except for listing the devices. PR #2974 link
490,Remove libusb_device field,"It is possible to retrieve the device instance from the handle via libusb_get_device(), so we don't need to reference the device one more time. PR #2974 https://github.com/Genymobile/scrcpy/pull/2974",Remove libusb_device field,"It is possible to retrieve the device instance from the handle via libusb_get_device(), so we don't need to reference the device one more time. PR #2974 link"
491,Move sc_usb out of sc_aoa,This will allow to initialize a USB device separately and pass it to sc_aoa. PR #2974 https://github.com/Genymobile/scrcpy/pull/2974,Move sc_usb out of sc_aoa,This will allow to initialize a USB device separately and pass it to sc_aoa. PR #2974 link
492,Make serial mandatory for sc_usb,"In practice, it is already mandatory. PR #2974 https://github.com/Genymobile/scrcpy/pull/2974",Make serial mandatory for sc_usb,"In practice, it is already mandatory. PR #2974 link"
493,Extract USB handling from AOA,The AOA code handled both USB initialization and AOA commands/events. Extract USB-related code to a separate file and structure. PR #2974 https://github.com/Genymobile/scrcpy/pull/2974,Extract USB handling from AOA,The AOA code handled both USB initialization and AOA commands/events. Extract USB-related code to a separate file and structure. PR #2974 link
494,Rename HAVE_AOA_HID to HAVE_USB,The condition actually determines whether scrcpy can use libusb or not. PR #2974 https://github.com/Genymobile/scrcpy/pull/2974,Rename HAVE_AOA_HID to HAVE_USB,The condition actually determines whether scrcpy can use libusb or not. PR #2974 link
495,Move AOA/HID code to usb/,PR #2974 https://github.com/Genymobile/scrcpy/pull/2974,Move AOA/HID code to usb/,PR #2974 link
496,Fix socket close race condition,"The server needs to interrupt the sockets on stop, but it must not close them while other threads may attempt to read from or write to them. In particular, the video_socket is read by the stream thread, and the control_socket is written by the controller and read by receiver. Therefore, close the socket only on sc_server_destroy(), which is called after all other threads are joined. Reported by TSAN on close: WARNING: ThreadSanitizer: data race (pid=3287612)   Write of size 8 at 0x7ba000000080 by thread T1:     #0 close ../../../../src/libsanitizer/tsan/tsan_interceptors_posix.cpp:1690 (libtsan.so.0+0x359d8)     #1 net_close ../app/src/util/net.c:280 (scrcpy+0x23643)     #2 run_server ../app/src/server.c:772 (scrcpy+0x20047)     #3 <null> <null> (libSDL2-2.0.so.0+0x905a0)    Previous read of size 8 at 0x7ba000000080 by thread T16:     #0 recv ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:6603 (libtsan.so.0+0x4f4a6)     #1 net_recv_all ../app/src/util/net.c:228 (scrcpy+0x234a9)     #2 stream_recv_packet ../app/src/stream.c:33 (scrcpy+0x2045c)     #3 run_stream ../app/src/stream.c:228 (scrcpy+0x21169)     #4 <null> <null> (libSDL2-2.0.so.0+0x905a0)  Refs ddb9396743072f97628fab168ef7fcd45a597b03",Fix socket close race condition,"The server needs to interrupt the sockets on stop, but it must not close them while other threads may attempt to read from or write to them. In particular, the video_socket is read by the stream thread, and the control_socket is written by the controller and read by receiver. Therefore, close the socket only on sc_server_destroy(), which is called after all other threads are joined. Reported by TSAN on close: WARNING: ThreadSanitizer: data race (pid=3287612)   Write of size 8 at 0x7ba000000080 by thread T1:     #0 close ../../../../src/libsanitizer/tsan/tsan_interceptors_posix.cpp:1690 (libtsan.so.0+0x359d8)     #1 net_close ../app/src/util/net.c:280 (scrcpy+0x23643)     #2 run_server ../app/src/server.c:772 (scrcpy+0x20047)     #3   (libSDL2-2.0.so.0+0x905a0) Previous read of size 8 at 0x7ba000000080 by thread T16:     #0 recv ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:6603 (libtsan.so.0+0x4f4a6)     #1 net_recv_all ../app/src/util/net.c:228 (scrcpy+0x234a9)     #2 stream_recv_packet ../app/src/stream.c:33 (scrcpy+0x2045c)     #3 run_stream ../app/src/stream.c:228 (scrcpy+0x21169)     #4   (libSDL2-2.0.so.0+0x905a0) Refs ddb9396743072f97628fab168ef7fcd45a597b03"
497,Print version on stdout,Refs b25404ee4b6f2cbdd41992fa3e087dd8a73412c9,Print version on stdout,Refs b25404ee4b6f2cbdd41992fa3e087dd8a73412c9
498,Do not print scrcpy version twice on --version,Refs 6da6d905c2aeac17255347037d44c32a62c4c504,Do not print scrcpy version twice on --version,Refs 6da6d905c2aeac17255347037d44c32a62c4c504
499,Update README.sp.md to v1.21,PR #2962 https://github.com/Genymobile/scrcpy/pull/2962 Signed-off-by: Romain Vimont rom@rom1v.com,Update README.sp.md to v1.21,PR #2962 link Signed-off-by: Romain Vimont rom@rom1v.com
500,"Mention ""screen copy"" in README",Help users make sense of the app name :),"Mention ""screen copy"" in README",Help users make sense of the app name :)
501,Upgrade platform-tools (32.0.0) for Windows,Include the latest version of adb in Windows releases.,Upgrade platform-tools (32.0.0) for Windows,Include the latest version of adb in Windows releases.
502,Upgrade SDL (2.0.20) for Windows,Include the latest version of SDL in Windows releases.,Upgrade SDL (2.0.20) for Windows,Include the latest version of SDL in Windows releases.
503,Fix code style,Align function parameters.,Fix code style,Align function parameters.
504,Slightly reduce lock usage,Locking the frame_buffer mutex to reference the input frame into the tmp_frame is unnecessary. This also fixes the missing unlock on error.,Slightly reduce lock usage,Locking the frame_buffer mutex to reference the input frame into the tmp_frame is unnecessary. This also fixes the missing unlock on error.
505,Fix return value on adb commands error,,Fix return value on adb commands error,
506,"Add a shorcut ""open a terminal here"" on Windows","On Windows, the file explorer does not provide any ""open a terminal here"" shortcut. Add a bat file which just runs cmd to easily open a terminal directly in the scrcpy directory (so there is no need to cd C:\path\). PR #2970 https://github.com/Genymobile/scrcpy/pull/2970","Add a shorcut ""open a terminal here"" on Windows","On Windows, the file explorer does not provide any ""open a terminal here"" shortcut. Add a bat file which just runs cmd to easily open a terminal directly in the scrcpy directory (so there is no need to cd C:\path\). PR #2970 link"
507,Do not restore power mode if --no-control,This totally disables deferred cleanup when --no-control is passed. Refs f289d206ea0e10cc052137781c39da862ebe2f73,Do not restore power mode if --no-control,This totally disables deferred cleanup when --no-control is passed. Refs f289d206ea0e10cc052137781c39da862ebe2f73
508,Use sc_ prefix for control_msg enums,Refs afa4a1b728d6f130acff23c0e3fb4609bcb8a6b2,Use sc_ prefix for control_msg enums,Refs afa4a1b728d6f130acff23c0e3fb4609bcb8a6b2
509,Add server option raw_video_stream,"For convenience, this new option forces the 3 following options:  - send_device_meta=false  - send_frame_meta=false  - send_dummy_byte=false This allows to send a raw H.264 stream on the video socket. Concretely: adb push scrcpy-server /data/local/tmp/scrcpy-server.jar adb forward tcp:1234 localabstract:scrcpy adb shell CLASSPATH=/data/local/tmp/scrcpy-server.jar \     app_process / com.genymobile.scrcpy.Server 1.21 \     raw_video_stream=true tunnel_forward=true control=false  As soon as a client connects via TCP to localhost:1234, it will receive the raw H.264 stream. Refs #1419 comment https://github.com/Genymobile/scrcpy/pull/1419#issuecomment-1013964650 PR #2971 https://github.com/Genymobile/scrcpy/pull/2971",Add server option raw_video_stream,"For convenience, this new option forces the 3 following options:  - send_device_meta=false  - send_frame_meta=false  - send_dummy_byte=false This allows to send a raw H.264 stream on the video socket. Concretely: adb push scrcpy-server /data/local/tmp/scrcpy-server.jar adb forward tcp:1234 localabstract:scrcpy adb shell CLASSPATH=/data/local/tmp/scrcpy-server.jar \     app_process / com.genymobile.scrcpy.Server 1.21 \     raw_video_stream=true tunnel_forward=true control=false As soon as a client connects via TCP to localhost:1234, it will receive the raw H.264 stream. Refs #1419 comment link PR #2971 link"
510,Add server option send_dummy_byte,"If set to false, no dummy byte is written to detect a connection error. PR #2971 https://github.com/Genymobile/scrcpy/pull/2971",Add server option send_dummy_byte,"If set to false, no dummy byte is written to detect a connection error. PR #2971 link"
511,Add server option send_device_meta,"Similar to send_device_frame, this option allows to disable sending the device name and size on start. This is only useful when using the scrcpy-server alone to get a raw H.264 stream, without using the scrcpy client. PR #2971 https://github.com/Genymobile/scrcpy/pull/2971",Add server option send_device_meta,"Similar to send_device_frame, this option allows to disable sending the device name and size on start. This is only useful when using the scrcpy-server alone to get a raw H.264 stream, without using the scrcpy client. PR #2971 link"
512,Reorder scrcpy-server options,Move the options unused by the scrcpy client at the end. These options may be useful to use scrcpy-server directly (to get a raw H.264 stream for example). PR #2971 https://github.com/Genymobile/scrcpy/pull/2971,Reorder scrcpy-server options,Move the options unused by the scrcpy client at the end. These options may be useful to use scrcpy-server directly (to get a raw H.264 stream for example). PR #2971 link
513,Move call to send device name and size,This will allow to optionally disable it. PR #2971 https://github.com/Genymobile/scrcpy/pull/2971,Move call to send device name and size,This will allow to optionally disable it. PR #2971 link
514,Disable more actions if --no-control,"If control is disabled, then do not enable ""show touches"" or automatically power off the device on close.",Disable more actions if --no-control,"If control is disabled, then do not enable ""show touches"" or automatically power off the device on close."
515,Refactor if-block in cli,Several tests must be performed if opts->control is false.,Refactor if-block in cli,Several tests must be performed if opts->control is false.
516,Move misplaced break statements,"With ifdefs, the resulting code could contain both a return statement and a break.",Move misplaced break statements,"With ifdefs, the resulting code could contain both a return statement and a break."
517,Fix header guard prefix,,Fix header guard prefix,
518,Improve FAQ explanations,,Improve FAQ explanations,
519,Update error messages in FAQ,"With the recent versions, scrcpy first executes ""adb get-serialno"", so the adb error messages are not exactly the same.",Update error messages in FAQ,"With the recent versions, scrcpy first executes ""adb get-serialno"", so the adb error messages are not exactly the same."
520,Fix downsize on error before first frame,"Retry with a lower definition if MediaCodec fails before the first frame, not the first packet. In practice, the first packet is a config packet without any frame, and MediaCodec might fail just after. Refs 2eb6fe7d81c15912a2252f229d317ae03f618a33 Refs #2963 https://github.com/Genymobile/scrcpy/issues/2963",Fix downsize on error before first frame,"Retry with a lower definition if MediaCodec fails before the first frame, not the first packet. In practice, the first packet is a config packet without any frame, and MediaCodec might fail just after. Refs 2eb6fe7d81c15912a2252f229d317ae03f618a33 Refs #2963 link"
521,Capture mouse on start for --hid-mouse,"If relative mode is enabled, capture the mouse immediately.",Capture mouse on start for --hid-mouse,"If relative mode is enabled, capture the mouse immediately."
522,Extract relative mode check to an inline function,This will allow to reuse the condition in another function.,Extract relative mode check to an inline function,This will allow to reuse the condition in another function.
523,Never forward capture keys,"In relative mode, Alt and Super are ""capture keys"". Never forward them to the input manager, to avoid inconsistencies between UP and DOWN events.",Never forward capture keys,"In relative mode, Alt and Super are ""capture keys"". Never forward them to the input manager, to avoid inconsistencies between UP and DOWN events."
524,Fix warning message,Make the message consistent for HID keyboard and HID mouse.,Fix warning message,Make the message consistent for HID keyboard and HID mouse.
525,Add missing break statement,"This was harmless because this is the last ""case"" of the switch, but for consistency, add the missing break.",Add missing break statement,"This was harmless because this is the last ""case"" of the switch, but for consistency, add the missing break."
526,Remove inline hint,There is no reason to request inlining here.,Remove inline hint,There is no reason to request inlining here.
527,Handle libusb_get_device_descriptor() error,The function libusb_get_device_descriptor() might return an error. Handle it.,Handle libusb_get_device_descriptor() error,The function libusb_get_device_descriptor() might return an error. Handle it.
528,Simplify error handling in sc_aoa_init(),Use goto to avoid many repetitions.,Simplify error handling in sc_aoa_init(),Use goto to avoid many repetitions.
529,Fix missing HID mouse destructor call,"The destructor unregisters the HID mouse, so it was not reported as a leak, but it must still be called.",Fix missing HID mouse destructor call,"The destructor unregisters the HID mouse, so it was not reported as a leak, but it must still be called."
530,Refactor if-blocks,Group all conditions requiring a controller in a single if-block.,Refactor if-blocks,Group all conditions requiring a controller in a single if-block.
531,Remove redundant control boolean,"The controller is NULL if and only if control is disabled, so an additional control boolean is redundant.",Remove redundant control boolean,"The controller is NULL if and only if control is disabled, so an additional control boolean is redundant."
532,Pass NULL controller if control is disabled,"If --no-control is requested, then the controller instance is not initialized. However, its reference was still passed to screen and input_manager. Instead, pass NULL if no controller is available.",Pass NULL controller if control is disabled,"If --no-control is requested, then the controller instance is not initialized. However, its reference was still passed to screen and input_manager. Instead, pass NULL if no controller is available."
533,Do not process finger events if no control,"If --no-control is passed, then im->mp is NULL, so processing touches would crash.",Do not process finger events if no control,"If --no-control is passed, then im->mp is NULL, so processing touches would crash."
534,Fix crash on --no-control,"Relative mouse mode assumed that a mouse processor was always available, but this is not the case if --no-control is passed.",Fix crash on --no-control,"Relative mouse mode assumed that a mouse processor was always available, but this is not the case if --no-control is passed."
535,Simplify event loop,Merge single event handling with the event loop function.,Simplify event loop,Merge single event handling with the event loop function.
536,Handle file drop from input_manager,A file is pushed (or an apk is installed) to the device on file drop. This behavior is specific to the screen and its input_manager.,Handle file drop from input_manager,A file is pushed (or an apk is installed) to the device on file drop. This behavior is specific to the screen and its input_manager.
537,Do not return status for event handling,It is never read. Simplify.,Do not return status for event handling,It is never read. Simplify.
538,Fix leak on file pusher error,"If a file_push request fails, the allocated filename must be freed.",Fix leak on file pusher error,"If a file_push request fails, the allocated filename must be freed."
539,Rename file_handler to sc_file_pusher,"Rename handler to pusher (""handler"" is too generic), and add sc_ prefix.",Rename file_handler to sc_file_pusher,"Rename handler to pusher (""handler"" is too generic), and add sc_ prefix."
540,Limit retry-on-error to IllegalStateException,"MediaCodec errors always trigger IllegalStateException or a subtype (like MediaCodec.CodecException). In practice, this avoids to retry if the error is caused by an IOException when writing the video packet to the socket.",Limit retry-on-error to IllegalStateException,"MediaCodec errors always trigger IllegalStateException or a subtype (like MediaCodec.CodecException). In practice, this avoids to retry if the error is caused by an IOException when writing the video packet to the socket."
541,Downsize on error only before the first frame,"The purpose of automatic downscaling on error is to make mirroring work by just starting scrcpy without an explicit -m value, even if the encoder could not encode at the screen definition. It is only useful when we detect an encoding failure before the first frame. Downsizing later could be surprising, so disable it. PR #2947 https://github.com/Genymobile/scrcpy/pull/2947",Downsize on error only before the first frame,"The purpose of automatic downscaling on error is to make mirroring work by just starting scrcpy without an explicit -m value, even if the encoder could not encode at the screen definition. It is only useful when we detect an encoding failure before the first frame. Downsizing later could be surprising, so disable it. PR #2947 link"
542,Disable downsizing on error if V4L2 is enabled,"V4L2 device is created with the initial device size, it does not support resizing. PR #2947 https://github.com/Genymobile/scrcpy/pull/2947",Disable downsizing on error if V4L2 is enabled,"V4L2 device is created with the initial device size, it does not support resizing. PR #2947 link"
543,Position and size the window on first frame,"The optimal initial size was computed from the expected dimensions, sent immediately by the server before encoding any video frame. However, the actual frame size may be different, for example when the device encoder does not support the requested size. To always handle this case properly, position and size the window only once the first frame size is known. PR #2947 https://github.com/Genymobile/scrcpy/pull/2947",Position and size the window on first frame,"The optimal initial size was computed from the expected dimensions, sent immediately by the server before encoding any video frame. However, the actual frame size may be different, for example when the device encoder does not support the requested size. To always handle this case properly, position and size the window only once the first frame size is known. PR #2947 link"
544,"Move ""show window"" call on first frame",Show the window only after the actual frame size is known (and if no error has occurred). This will allow to properly position and size the window when the size of the first frame is different from the size initially announced by the server. PR #2947 https://github.com/Genymobile/scrcpy/pull/2947,"Move ""show window"" call on first frame",Show the window only after the actual frame size is known (and if no error has occurred). This will allow to properly position and size the window when the size of the first frame is different from the size initially announced by the server. PR #2947 link
545,Fix screen comments,"The position fields accept SC_WINDOW_POSITION_UNDEFINED, not the size fields. PR #2947 https://github.com/Genymobile/scrcpy/pull/2947",Fix screen comments,"The position fields accept SC_WINDOW_POSITION_UNDEFINED, not the size fields. PR #2947 link"
546,Mention auto-downsize feature in FAQ,PR #2947 https://github.com/Genymobile/scrcpy/pull/2947,Mention auto-downsize feature in FAQ,PR #2947 link
547,Remove MediaCodec error suggestion fix,"Now that scrcpy attempts with a lower definition on any MediaCodec error (or the user explicitly requests to disable auto-downsizing), the suggestion is unnecessary. PR #2947 https://github.com/Genymobile/scrcpy/pull/2947",Remove MediaCodec error suggestion fix,"Now that scrcpy attempts with a lower definition on any MediaCodec error (or the user explicitly requests to disable auto-downsizing), the suggestion is unnecessary. PR #2947 link"
548,Make auto-downsize on error optional,Add --no-downsize-on-error option to disable attempts to use a lower definition on MediaCodec error. PR #2947 https://github.com/Genymobile/scrcpy/pull/2947,Make auto-downsize on error optional,Add --no-downsize-on-error option to disable attempts to use a lower definition on MediaCodec error. PR #2947 link
549,Downsize on error,"Some devices are not able to encode at the device screen definition. Instead of just failing, try with a lower definition on any MediaCodec error. PR #2947 https://github.com/Genymobile/scrcpy/pull/2947",Downsize on error,"Some devices are not able to encode at the device screen definition. Instead of just failing, try with a lower definition on any MediaCodec error. PR #2947 link"
550,Remember Device parameters,This will allow to reuse them to recreate a ScreenInfo instance in order to change the maxSize value on MediaCodec error. PR #2947 https://github.com/Genymobile/scrcpy/pull/2947,Remember Device parameters,This will allow to reuse them to recreate a ScreenInfo instance in order to change the maxSize value on MediaCodec error. PR #2947 link
551,Compute screen size without DisplayInfo instance,Use the actual rotation and size values directly. This will allow to automatically change the maxSize value on MediaCodec error. PR #2947 https://github.com/Genymobile/scrcpy/pull/2947,Compute screen size without DisplayInfo instance,Use the actual rotation and size values directly. This will allow to automatically change the maxSize value on MediaCodec error. PR #2947 link
552,Fix visibility modifier,Refs b7a06278fee0dbfbb18b651ad563d9fb0797c8bc,Fix visibility modifier,Refs b7a06278fee0dbfbb18b651ad563d9fb0797c8bc
553,Fix NoSuchMethodException for injectInputEvent(),Some devices with modified ROMs expose a different signature for injectInputEvent(). Fixes #2250 https://github.com/Genymobile/scrcpy/issues/2250 PR #2946 https://github.com/Genymobile/scrcpy/pull/2946 Signed-off-by: Romain Vimont rom@rom1v.com,Fix NoSuchMethodException for injectInputEvent(),Some devices with modified ROMs expose a different signature for injectInputEvent(). Fixes #2250 link PR #2946 link Signed-off-by: Romain Vimont rom@rom1v.com
554,Upgrade FFmpeg (5.0) for Windows 64-bit,Use FFmpeg win64 binaries from gyan.dev (referenced from ffmpeg.org):  https://www.gyan.dev/ffmpeg/builds/ https://ffmpeg.org/download.html#build-windows  Keep the old FFmpeg prebuilt binaries (4.3.1) for win32 builds. Fixes #1753 https://github.com/Genymobile/scrcpy/issues/1753 Refs #1838 https://github.com/Genymobile/scrcpy/pull/1838 Refs #2583 https://github.com/Genymobile/scrcpy/pull/2583 PR #2952 https://github.com/Genymobile/scrcpy/pull/2952 Co-authored-by: Yu-Chen Lin npes87184@gmail.com Co-authored-by: nkh0472 nkh0472@hotmail.com Signed-off-by: Romain Vimont rom@rom1v.com,Upgrade FFmpeg (5.0) for Windows 64-bit,Use FFmpeg win64 binaries from gyan.dev (referenced from ffmpeg.org): link/ link Keep the old FFmpeg prebuilt binaries (4.3.1) for win32 builds. Fixes #1753 link Refs #1838 link Refs #2583 link PR #2952 link Co-authored-by: Yu-Chen Lin npes87184@gmail.com Co-authored-by: nkh0472 nkh0472@hotmail.com Signed-off-by: Romain Vimont rom@rom1v.com
555,Use symlink to simplify Windows ffmpeg dependency,"The FFmpeg dependency is downloaded from two separate zipfiles. Symlink include/ to expose everything from a single directory, to simplify the meson script. PR #2952 https://github.com/Genymobile/scrcpy/pull/2952",Use symlink to simplify Windows ffmpeg dependency,"The FFmpeg dependency is downloaded from two separate zipfiles. Symlink include/ to expose everything from a single directory, to simplify the meson script. PR #2952 link"
556,Simplify ffmpeg dependencies Makefile,The fact that the current prebuilt FFmpeg is split into two separate zipfiles is an implementation detail. Use a single Makefile recipe for both files. PR #2952 https://github.com/Genymobile/scrcpy/pull/2952,Simplify ffmpeg dependencies Makefile,The fact that the current prebuilt FFmpeg is split into two separate zipfiles is an implementation detail. Use a single Makefile recipe for both files. PR #2952 link
557,Reference Windows USB driver for Google devices,PR #2945 https://github.com/Genymobile/scrcpy/pull/2945 Signed-off-by: Romain Vimont rom@rom1v.com,Reference Windows USB driver for Google devices,PR #2945 link Signed-off-by: Romain Vimont rom@rom1v.com
558,Fix build with ffmpeg 5.0,PR #2948 https://github.com/Genymobile/scrcpy/pull/2948 Signed-off-by: Bernhard Rosenkrnzer bero@lindev.ch Signed-off-by: Romain Vimont rom@rom1v.com,Fix build with ffmpeg 5.0,PR #2948 link Signed-off-by: Bernhard Rosenkrnzer bero@lindev.ch Signed-off-by: Romain Vimont rom@rom1v.com
559,Add final modifier to ScreenEncoder fields,These fields are only set from the constructor.,Add final modifier to ScreenEncoder fields,These fields are only set from the constructor.
560,Use constant string for known booleans,Boolean options explicitly passed to the server are statically known.,Use constant string for known booleans,Boolean options explicitly passed to the server are statically known.
561,Use sc_ prefix for control_msg,,Use sc_ prefix for control_msg,
562,Use sc_ prefix for controller,,Use sc_ prefix for controller,
563,Use sc_ prefix for input_manager,,Use sc_ prefix for input_manager,
564,Use sc_ prefix for screen,,Use sc_ prefix for screen,
565,Fix code style,Limit to 80 chars.,Fix code style,Limit to 80 chars.
566,Do not pass scrcpy_options to keyboard inject,"The components should be configurable independently of the global scrcpy_options instance: their configuration could be provided separately, like it is the case for example for some screen parameters. For consistency, keyboard injection should not depend on scrcpy_options.",Do not pass scrcpy_options to keyboard inject,"The components should be configurable independently of the global scrcpy_options instance: their configuration could be provided separately, like it is the case for example for some screen parameters. For consistency, keyboard injection should not depend on scrcpy_options."
567,Document HID mouse in README,,Document HID mouse in README,
568,Add support for HID mouse,,Add support for HID mouse,
569,Refactor AOA/HID keyboard initialization,This paves the way to add support for HID mouse initialization.,Refactor AOA/HID keyboard initialization,This paves the way to add support for HID mouse initialization.
570,Add CLAMP() macro,,Add CLAMP() macro,
571,Add UI/UX support for relative mouse mode,"In relative mouse mode, the mouse pointer must be ""captured"" from the computer. Toggle (disable/enable) relative mouse mode using any of the hardcoded capture keys:  - left-Alt  - left-Super  - right-Super These capture keys do not conflict with shortcuts, since a shortcut is always a combination of the MOD key and some other key, while the capture key triggers an action only if it is pressed and released alone. The relative mouse mode is also automatically enabled on any click in the window, and automatically disabled on focus lost (it is possible to lose focus even without the mouse).",Add UI/UX support for relative mouse mode,"In relative mouse mode, the mouse pointer must be ""captured"" from the computer. Toggle (disable/enable) relative mouse mode using any of the hardcoded capture keys:  - left-Alt  - left-Super  - right-Super These capture keys do not conflict with shortcuts, since a shortcut is always a combination of the MOD key and some other key, while the capture key triggers an action only if it is pressed and released alone. The relative mouse mode is also automatically enabled on any click in the window, and automatically disabled on focus lost (it is possible to lose focus even without the mouse)."
572,Forward all motion events to mouse processors,The decision to not send motion events when no click is pressed is specific to Android mouse injection. Other mouse processors (e.g. for HID mouse) will need to receive all events.,Forward all motion events to mouse processors,The decision to not send motion events when no click is pressed is specific to Android mouse injection. Other mouse processors (e.g. for HID mouse) will need to receive all events.
573,Provide relative mouse motion vector in event,This will allow the mouse processor to handle relative motion easily.,Provide relative mouse motion vector in event,This will allow the mouse processor to handle relative motion easily.
574,Add relative mode flag to mouse processors,"The default mouse injection works in absolute mode: it forwards clicks at a specific position on screen. To support HID mouse, add a flag to indicate that the mouse processor works in relative mode: it forwards mouse motion vectors, without any absolute reference to the screen.",Add relative mode flag to mouse processors,"The default mouse injection works in absolute mode: it forwards clicks at a specific position on screen. To support HID mouse, add a flag to indicate that the mouse processor works in relative mode: it forwards mouse motion vectors, without any absolute reference to the screen."
575,Pass buttons state in scroll events,"A scroll event might be produced when a mouse button is pressed (for example when scrolling while selecting a text). For consistency, pass the actual buttons state (instead of 0). In practice, it seems that this use case does not work properly with Android event injection, but it will work with HID mouse.",Pass buttons state in scroll events,"A scroll event might be produced when a mouse button is pressed (for example when scrolling while selecting a text). For consistency, pass the actual buttons state (instead of 0). In practice, it seems that this use case does not work properly with Android event injection, but it will work with HID mouse."
576,Destroy acksync immediately on error,"If AOA or HID keyboard may not be initialized for some reason, acksync is useless.",Destroy acksync immediately on error,"If AOA or HID keyboard may not be initialized for some reason, acksync is useless."
577,Remove duplicate boolean,The AOA initialization state is already tracked by aoa_hid_initialized.,Remove duplicate boolean,The AOA initialization state is already tracked by aoa_hid_initialized.
578,Reorder controller and HID initialization,"This allows to merge two ""#ifdef HAVE_AOA_HID"" blocks to simplify.",Reorder controller and HID initialization,"This allows to merge two ""#ifdef HAVE_AOA_HID"" blocks to simplify."
579,Move input_manager into screen,"The input_manager is strongly tied to the screen, it could not work independently of the specific screen implementation. To implement a user-friendly HID mouse behavior, some SDL events will need to be handled both by the screen and by the input manager. For example, a click must typically be handled by the input_manager so that it is forwarded to the device, but in HID mouse mode, the first click should be handled by the screen to capture the mouse (enable relative mouse mode). Make the input_manager a descendant of the screen, so that the screen decides what to do on SDL events. Concretely, replace this structure hierarchy:  +- struct scrcpy     +- struct input_manager     +- struct screen  by this one:  +- struct scrcpy     +- struct screen        +- struct input_manager",Move input_manager into screen,"The input_manager is strongly tied to the screen, it could not work independently of the specific screen implementation. To implement a user-friendly HID mouse behavior, some SDL events will need to be handled both by the screen and by the input manager. For example, a click must typically be handled by the input_manager so that it is forwarded to the device, but in HID mouse mode, the first click should be handled by the screen to capture the mouse (enable relative mouse mode). Make the input_manager a descendant of the screen, so that the screen decides what to do on SDL events. Concretely, replace this structure hierarchy:  +- struct scrcpy     +- struct input_manager     +- struct screen by this one:  +- struct scrcpy     +- struct screen        +- struct input_manager"
580,Use separate struct for input manager params,"This avoids to directly pass the options instance (which contains more data than strictly necessary), and limit the number of parameters for the init function.",Use separate struct for input manager params,"This avoids to directly pass the options instance (which contains more data than strictly necessary), and limit the number of parameters for the init function."
581,Remove unused enum value requiring SDL 2.0.18,Refs b8fed50639fe3bf8e02a8cc2409494cd6bf30fb7 Fixes #2924 https://github.com/Genymobile/scrcpy/issues/2924,Remove unused enum value requiring SDL 2.0.18,Refs b8fed50639fe3bf8e02a8cc2409494cd6bf30fb7 Fixes #2924 link
582,Enable virtual finger only on left click,The pinch-to-zoom feature must only be enabled with Ctrl+left_click.,Enable virtual finger only on left click,The pinch-to-zoom feature must only be enabled with Ctrl+left_click.
583,Make some mouse processors ops optional,Do not force all mouse processors to implement scroll events or touch events.,Make some mouse processors ops optional,Do not force all mouse processors to implement scroll events or touch events.
584,Make process_text() optional,"Not all key processors support text injection (HID keyboard does not support it). Instead of providing a dummy op function, set it to NULL and check on the caller side before calling it.",Make process_text() optional,"Not all key processors support text injection (HID keyboard does not support it). Instead of providing a dummy op function, set it to NULL and check on the caller side before calling it."
585,Apply buttons mask if not --forward-all-clicks,"If --forward-all-clicks is not set, then only left clicks are forwarded. For consistency, also mask the buttons state in other events.",Apply buttons mask if not --forward-all-clicks,"If --forward-all-clicks is not set, then only left clicks are forwarded. For consistency, also mask the buttons state in other events."
586,Reorder mouse processor ops,Group the mouse events callbacks before the touch event callback.,Reorder mouse processor ops,Group the mouse events callbacks before the touch event callback.
587,Simplify mouse injection implementation,The static functions are now so simple that they become unnecessary: the control message may be initialized directly instead.,Simplify mouse injection implementation,The static functions are now so simple that they become unnecessary: the control message may be initialized directly instead.
588,Make some event conversions infallible,"When the implementation handles all possible input values, it may never fail.",Make some event conversions infallible,"When the implementation handles all possible input values, it may never fail."
589,Use scrcpy input events for mouse processors,"Pass scrcpy input events instead of SDL input events to mouse processors. These events represent exactly what mouse processors need, abstracted from any visual orientation and scaling applied on the SDL window. This makes the mouse processors independent of the ""screen"" instance, and the implementation source code independent of the SDL API.",Use scrcpy input events for mouse processors,"Pass scrcpy input events instead of SDL input events to mouse processors. These events represent exactly what mouse processors need, abstracted from any visual orientation and scaling applied on the SDL window. This makes the mouse processors independent of the ""screen"" instance, and the implementation source code independent of the SDL API."
590,Use scrcpy input events for key processors,Pass scrcpy input events instead of SDL input events to key processors. This makes the source code of key processors independent of the SDL API.,Use scrcpy input events for key processors,Pass scrcpy input events instead of SDL input events to key processors. This makes the source code of key processors independent of the SDL API.
591,Use common sc_action in input manager,"Now that the scrcpy input events API exposes a sc_action enum, use the same from the input manager.",Use common sc_action in input manager,"Now that the scrcpy input events API exposes a sc_action enum, use the same from the input manager."
592,Add intermediate input events layer,"This aims to make the key/mouse processors independent of the ""screen"", by processing scrcpy-specific input events instead of SDL events. In particular, these scrcpy events are not impacted by any UI window scaling or rotation (contrary to SDL events).",Add intermediate input events layer,"This aims to make the key/mouse processors independent of the ""screen"", by processing scrcpy-specific input events instead of SDL events. In particular, these scrcpy events are not impacted by any UI window scaling or rotation (contrary to SDL events)."
593,Rename SC_MOD_ to SC_SHORTCUT_MOD_,This will avoid conflicts with new SC_MOD_* constants.,Rename SC_MOD_ to SC_SHORTCUT_MOD_,This will avoid conflicts with new SC_MOD_* constants.
594,Remove actions bitset,"The input manager exposed functions taking an ""actions"" parameter, containing a bitmask-OR of ACTION_UP and ACTION_DOWN. But they are never called with both actions simultaneously anymore, so simplify. Refs 964b6d2243fa1921543e48810f3064b9bd2d50d1 Refs d0739911a3e413b70275ded3eef839f9dc57ba7a",Remove actions bitset,"The input manager exposed functions taking an ""actions"" parameter, containing a bitmask-OR of ACTION_UP and ACTION_DOWN. But they are never called with both actions simultaneously anymore, so simplify. Refs 964b6d2243fa1921543e48810f3064b9bd2d50d1 Refs d0739911a3e413b70275ded3eef839f9dc57ba7a"
595,Expose V4L2 option on all platforms,This allows to report a meaningful error message if an unsupported feature is used on an incompatible platform. This is consistent with the behavior of -K/--hid-keyboard.,Expose V4L2 option on all platforms,This allows to report a meaningful error message if an unsupported feature is used on an incompatible platform. This is consistent with the behavior of -K/--hid-keyboard.
596,Fail on unsupported HID option,"If the feature is not supported on the platform, fail during command line parsing instead of using a fallback.",Fail on unsupported HID option,"If the feature is not supported on the platform, fail during command line parsing instead of using a fallback."
597,Avoid unused function warning,"If HAVE_SOCK_CLOEXEC is not defined, then sc_raw_socket_close() is never used. Add an #ifndef block to remove the warning.",Avoid unused function warning,"If HAVE_SOCK_CLOEXEC is not defined, then sc_raw_socket_close() is never used. Add an #ifndef block to remove the warning."
598,Happy new year 2022!,,Happy new year 2022!,
599,Fix memory leaks in tests,Tests were failing when run with ASAN enabled.,Fix memory leaks in tests,Tests were failing when run with ASAN enabled.
600,Document HID keyboard events,,Document HID keyboard events,
601,Ignore display bounds on resize-to-fit,"The ""resize to fit"" feature (MOD+w or double-click on black borders) computed the ""optimal size"" using the same function computing the initial window size on start. However, on ""resize to fit"", only the black borders must be removed (the content size must be preserved), so the display bounds must not be considered.",Ignore display bounds on resize-to-fit,"The ""resize to fit"" feature (MOD+w or double-click on black borders) computed the ""optimal size"" using the same function computing the initial window size on start. However, on ""resize to fit"", only the black borders must be removed (the content size must be preserved), so the display bounds must not be considered."
602,Simplify sc_size assignment,Assign the whole struct instead of each field separately.,Simplify sc_size assignment,Assign the whole struct instead of each field separately.
603,Upgrade SDL (2.0.18) for Windows,Include the latest version of SDL in Windows releases.,Upgrade SDL (2.0.18) for Windows,Include the latest version of SDL in Windows releases.
604,Set DPI awareness for Windows,Add a windows manifest to set the DPI awareness by default: https://docs.microsoft.com/en-us/windows/win32/hidpi/setting-the-default-dpi-awareness-for-a-process Refs #40 https://github.com/Genymobile/scrcpy/issues/40 Fixes #2865 https://github.com/Genymobile/scrcpy/issues/2865,Set DPI awareness for Windows,Add a windows manifest to set the DPI awareness by default: link Refs #40 link Fixes #2865 link
605,Mention react-native menu shortcut in README,PR #2879 https://github.com/Genymobile/scrcpy/pull/2879 Signed-off-by: Romain Vimont rom@rom1v.com,Mention react-native menu shortcut in README,PR #2879 link Signed-off-by: Romain Vimont rom@rom1v.com
606,Fix typos reported by codespell,,Fix typos reported by codespell,
607,Fix adb server hang,"Since commit 04267085441d6fcd05eff7df0118708f7622e237, the server is run in a dedicated thread. For SDL, many signals, including SIGINT and SIGTERM, are masked for new threads. As a result, if the adb server is not already running, adb commands invoked by scrcpy will start an adb server that ignores those signals and cannot be terminated at system shutdown. Fixes #2873 https://github.com/Genymobile/scrcpy/issues/2873 PR #2870 https://github.com/Genymobile/scrcpy/pull/2870 Signed-off-by: Romain Vimont rom@rom1v.com",Fix adb server hang,"Since commit 04267085441d6fcd05eff7df0118708f7622e237, the server is run in a dedicated thread. For SDL, many signals, including SIGINT and SIGTERM, are masked for new threads. As a result, if the adb server is not already running, adb commands invoked by scrcpy will start an adb server that ignores those signals and cannot be terminated at system shutdown. Fixes #2873 link PR #2870 link Signed-off-by: Romain Vimont rom@rom1v.com"
608,Improve crossbuild configuration,"Use meson native features to detect crossbuild, and remove the user-provided option crossbuild_windows.",Improve crossbuild configuration,"Use meson native features to detect crossbuild, and remove the user-provided option crossbuild_windows."
609,Add script to bump version,The version must now be bumped at 4 different places. Add a script to bump automatically: ./bump_version 1.23.4,Add script to bump version,The version must now be bumped at 4 different places. Add a script to bump automatically: ./bump_version 1.23.4
610,Add metadata to scrcpy.exe for Windows,Refs https://stackoverflow.com/a/708382/1987178,Add metadata to scrcpy.exe for Windows,Refs link
611,Add icon to scrcpy.exe,The icon will be associated to scrcpy.exe in the Windows explorer. The .ico was created using imagemagick: convert icon.png icon.ico  It is included as a binary for simplicity. Refs #2815 https://github.com/Genymobile/scrcpy/issues/2815,Add icon to scrcpy.exe,The icon will be associated to scrcpy.exe in the Windows explorer. The .ico was created using imagemagick: convert icon.png icon.ico It is included as a binary for simplicity. Refs #2815 link
612,Update copyright date to 2021 in manpage,"December, it's time to update to 2021!",Update copyright date to 2021 in manpage,"December, it's time to update to 2021!"
613,Update environment variables section in manpage,Use the same content as the section printed with --help.,Update environment variables section in manpage,Use the same content as the section printed with --help.
614,Add environment variables in help,Print the list of environment variables used by scrcpy in --help.,Add environment variables in help,Print the list of environment variables used by scrcpy in --help.
615,Move newline generation in help,"If we removed the shortcuts intro, we would not need the additional '\n' of the section title, so it should be printed along with the shortcuts intro.",Move newline generation in help,"If we removed the shortcuts intro, we would not need the additional '\n' of the section title, so it should be printed along with the shortcuts intro."
616,Rename scrcpy threads,"Prefix the name of threads by ""scrcpy-"". This improves readability in the output of top -H for example. Limit the thread names to 16 bytes, because it is limited on some platforms.",Rename scrcpy threads,"Prefix the name of threads by ""scrcpy-"". This improves readability in the output of top -H for example. Limit the thread names to 16 bytes, because it is limited on some platforms."
617,"Set ""low delay"" decoder flag","I don't really know the concrete benefits, but scrcpy definitely wants low delay decoding. Suggested-by: Franois Cartegnie fcvlcdev@free.fr","Set ""low delay"" decoder flag","I don't really know the concrete benefits, but scrcpy definitely wants low delay decoding. Suggested-by: Franois Cartegnie fcvlcdev@free.fr"
618,Use timers with microsecond precision,SDL only provides millisecond precision. Use system timers to get a better precision.,Use timers with microsecond precision,SDL only provides millisecond precision. Use system timers to get a better precision.
619,Interrupt and close sockets on server stop,"The sockets were never interrupted or closed by the client since recent changes to run the server from a dedicated thread (see commit 04267085441d6fcd05eff7df0118708f7622e237). As a side effect, the server could never terminate properly (it was waiting on socket blocking calls), so it was always killed by the client after the WATCHDOG_DELAY. Interrupt the sockets on stop to give the servera chance to terminate property, then close them.",Interrupt and close sockets on server stop,"The sockets were never interrupted or closed by the client since recent changes to run the server from a dedicated thread (see commit 04267085441d6fcd05eff7df0118708f7622e237). As a side effect, the server could never terminate properly (it was waiting on socket blocking calls), so it was always killed by the client after the WATCHDOG_DELAY. Interrupt the sockets on stop to give the servera chance to terminate property, then close them."
620,Do not create control socket if no control,"If --no-control is enabled, then it is not necessary to create a second communication socket between the client and the server. This also facilitates the use of the server alone (without the client) to receive only the raw video stream.",Do not create control socket if no control,"If --no-control is enabled, then it is not necessary to create a second communication socket between the client and the server. This also facilitates the use of the server alone (without the client) to receive only the raw video stream."
621,Require libavcodec >= 57.37,"In ffmpeg/doc/APIchanges:  2016-04-21 - 7fc329e - lavc 57.37.100 - avcodec.h   Add a new audio/video encoding and decoding API with decoupled input   and output -- avcodec_send_packet(), avcodec_receive_frame(),   avcodec_send_frame() and avcodec_receive_packet().  Refs de9b79ec2dd73e5442c6bf0161669bcd8ca7d5be Refs #2862 https://github.com/Genymobile/scrcpy/issues/2862",Require libavcodec >= 57.37,"In ffmpeg/doc/APIchanges: 2016-04-21 - 7fc329e - lavc 57.37.100 - avcodec.h   Add a new audio/video encoding and decoding API with decoupled input   and output -- avcodec_send_packet(), avcodec_receive_frame(),   avcodec_send_frame() and avcodec_receive_packet(). Refs de9b79ec2dd73e5442c6bf0161669bcd8ca7d5be Refs #2862 link"
622,Require libavformat >= 57.33,"In ffmpeg/doc/APIchanges:  2016-04-11 - 6f69f7a / 9200514 - lavf 57.33.100 / 57.5.0 - avformat.h   Add AVStream.codecpar, deprecate AVStream.codec.  Refs 5d9e96dc4eaa41b185c41e8a6df6191762764b1c Refs #2862 https://github.com/Genymobile/scrcpy/issues/2862",Require libavformat >= 57.33,"In ffmpeg/doc/APIchanges: 2016-04-11 - 6f69f7a / 9200514 - lavf 57.33.100 / 57.5.0 - avformat.h   Add AVStream.codecpar, deprecate AVStream.codec. Refs 5d9e96dc4eaa41b185c41e8a6df6191762764b1c Refs #2862 link"
623,Require SDL >= 2.0.5,"Icon loading uses SDL_CreateRGBSurfaceWithFormatFrom(), available since SDL 2.0.5 (in 2016). Refs #2862 https://github.com/Genymobile/scrcpy/issues/2862",Require SDL >= 2.0.5,"Icon loading uses SDL_CreateRGBSurfaceWithFormatFrom(), available since SDL 2.0.5 (in 2016). Refs #2862 link"
624,Remove spurious ';',,Remove spurious ';',
625,Add missing comma,"Thank you clang: ../app/src/control_msg.c:45:5: warning: suspicious concatenation of string literals in an array initialization; did you mean to separate the elements with a comma? [-Wstring-concatenation]     ""hover-exit"",     ^",Add missing comma,"Thank you clang: ../app/src/control_msg.c:45:5: warning: suspicious concatenation of string literals in an array initialization; did you mean to separate the elements with a comma? [-Wstring-concatenation]     ""hover-exit"",     ^"
626,Add a unit test for clipboard text length,This would have catched the possible memcpy() overflow fixed by the previous commit. Refs #2859 https://github.com/Genymobile/scrcpy/pull/2859,Add a unit test for clipboard text length,This would have catched the possible memcpy() overflow fixed by the previous commit. Refs #2859 link
627,Fix overflow in memcpy,"In function memcpy,     inlined from control_msg_serialize.constprop at ../app/src/control_msg.c:77:5,     inlined from run_controller at ../app/src/controller.c:69:12:         /usr/include/x86_64-linux-gnu/bits/string_fortified.h:34:10:         warning: __builtinmemcpychk writing 262138 bytes into a region         of size 262130 overflows the destination [-Wstringop-overflow=]    return builtinmemcpychk (dest, __src, __len, __bos0 (__dest)); Refs 901d8371655582b432d5d92430177a59df8058b9 PR #2859 https://github.com/Genymobile/scrcpy/pull/2859 Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com",Fix overflow in memcpy,"In function memcpy,     inlined from control_msg_serialize.constprop at ../app/src/control_msg.c:77:5,     inlined from run_controller at ../app/src/controller.c:69:12:         /usr/include/x86_64-linux-gnu/bits/string_fortified.h:34:10:         warning: __builtinmemcpychk writing 262138 bytes into a region         of size 262130 overflows the destination [-Wstringop-overflow=]    return builtinmemcpychk (dest, __src, __len, __bos0 (__dest)); Refs 901d8371655582b432d5d92430177a59df8058b9 PR #2859 link Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com"
628,Fix comment in control message serialization,Refs 245999aec4a4a1454212b38a988aa96fa701bb04 Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com,Fix comment in control message serialization,Refs 245999aec4a4a1454212b38a988aa96fa701bb04 Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com
629,Fix memset() size in tests,The memset() size was 1 byte too long. It was harmless because the last 'a' was overwritten by '\0`.,Fix memset() size in tests,The memset() size was 1 byte too long. It was harmless because the last 'a' was overwritten by '\0`.
630,Mention SCRCPY_ICON_PATH env var in manpage,,Mention SCRCPY_ICON_PATH env var in manpage,
631,Remove useless intermediate variable,"Now that PLATFORM is correctly used in the if-condition, PLATFORM_VERSION is useless. PR #2850 https://github.com/Genymobile/scrcpy/pull/2850",Remove useless intermediate variable,"Now that PLATFORM is correctly used in the if-condition, PLATFORM_VERSION is useless. PR #2850 link"
632,Fix script to build without gradle,"The PLATFORM variable is assigned either from $ANDROID_PLATFORM or gets a default value (currently $PLATFORM_VERSION). The check to use either dx (SDK < 31) or d8 (SDK >= 31) must be based on the actual $PLATFORM, not the default $PLATFORM_VERSION. Refs 52138fd9213216a21fbdcda4d430394d7c8f0979 Refs https://salsa.debian.org/yangfl-guest/scrcpy/-/blob/57d30780dd38b9641992a873d760ac0f4bc3a387/debian/patches/0002-Workaround-broken-script.patch PR #2850 https://github.com/Genymobile/scrcpy/pull/2850 Signed-off-by: Romain Vimont rom@rom1v.com",Fix script to build without gradle,"The PLATFORM variable is assigned either from $ANDROID_PLATFORM or gets a default value (currently $PLATFORM_VERSION). The check to use either dx (SDK < 31) or d8 (SDK >= 31) must be based on the actual $PLATFORM, not the default $PLATFORM_VERSION. Refs 52138fd9213216a21fbdcda4d430394d7c8f0979 Refs link PR #2850 link Signed-off-by: Romain Vimont rom@rom1v.com"
633,AUR to official Arch Repository,PR #2844 https://github.com/Genymobile/scrcpy/pull/2844 Signed-off-by: Romain Vimont rom@rom1v.com,AUR to official Arch Repository,PR #2844 link Signed-off-by: Romain Vimont rom@rom1v.com
634,Fix process execution on Windows 7,"According to this bug report on Firefox: https://bugzilla.mozilla.org/show_bug.cgi?id=1460995  CreateProcess fails with ERROR_NO_SYSTEM_RESOURCES on Windows 7. It looks like the reason why is because PROC_THREAD_ATTRIBUTE_HANDLE_LIST doesn't like console handles.  To avoid the problem, do not pass console handles to PROC_THREAD_ATTRIBUTE_HANDLE_LIST. Refs #2783 https://github.com/Genymobile/scrcpy/pull/2783 Refs f801d8b3128cf5aae3725c981f32abfd4b6c307e Fixes #2838 https://github.com/Genymobile/scrcpy/issues/2838 PR #2840 https://github.com/Genymobile/scrcpy/pull/2840",Fix process execution on Windows 7,"According to this bug report on Firefox: link CreateProcess fails with ERROR_NO_SYSTEM_RESOURCES on Windows 7. It looks like the reason why is because PROC_THREAD_ATTRIBUTE_HANDLE_LIST doesn't like console handles. To avoid the problem, do not pass console handles to PROC_THREAD_ATTRIBUTE_HANDLE_LIST. Refs #2783 link Refs f801d8b3128cf5aae3725c981f32abfd4b6c307e Fixes #2838 link PR #2840 link"
635,Log CreateProcessW() error code on Windows,Refs #2838 https://github.com/Genymobile/scrcpy/issues/2838,Log CreateProcessW() error code on Windows,Refs #2838 link
636,Update links to v1.21,,Update links to v1.21,
637,Bump version to 1.21,,Bump version to 1.21,
638,Merge branch 'master' into dev,,Merge branch 'master' into dev,
639,Clarify TCP/IP mode in README,,Clarify TCP/IP mode in README,
640,Always synchronize clipboard on explicit COPY/CUT,"If --no-clipboard-autosync is enabled, the automatic clipboard synchronization performed whenever the device clipboard changes is disabled. But on explicit COPY and CUT scrcpy shortcuts (MOD+c and MOD+x), the clipboard should still be synchronized, so that it remains possible to copy-paste from the device to the computer. This is consistent with the behavior of MOD+v, which pastes the computer clipboard to the device. Refs #2228 https://github.com/Genymobile/scrcpy/issues/2228 Refs #2817 https://github.com/Genymobile/scrcpy/pull/2817 PR #2834 https://github.com/Genymobile/scrcpy/pull/2834",Always synchronize clipboard on explicit COPY/CUT,"If --no-clipboard-autosync is enabled, the automatic clipboard synchronization performed whenever the device clipboard changes is disabled. But on explicit COPY and CUT scrcpy shortcuts (MOD+c and MOD+x), the clipboard should still be synchronized, so that it remains possible to copy-paste from the device to the computer. This is consistent with the behavior of MOD+v, which pastes the computer clipboard to the device. Refs #2228 link Refs #2817 link PR #2834 link"
641,Expose sync mode for injecting events,"Expose the inject input event mode so that it is possible to wait for the events to be ""finished"". This will be necessary to read the clipboard content only after the COPY or CUT key event is handled. PR #2834 https://github.com/Genymobile/scrcpy/pull/2834",Expose sync mode for injecting events,"Expose the inject input event mode so that it is possible to wait for the events to be ""finished"". This will be necessary to read the clipboard content only after the COPY or CUT key event is handled. PR #2834 link"
642,Move acknowledgment handling,Handle all actions related to SET_CLIPBOARD from the dedicated method. PR #2834 https://github.com/Genymobile/scrcpy/pull/2834,Move acknowledgment handling,Handle all actions related to SET_CLIPBOARD from the dedicated method. PR #2834 link
643,Fix set_clipboard message log,"If paste is disabled on set_clipboard, then the PASTE key is not injected, but COPY is unrelated. PR #2834 https://github.com/Genymobile/scrcpy/pull/2834",Fix set_clipboard message log,"If paste is disabled on set_clipboard, then the PASTE key is not injected, but COPY is unrelated. PR #2834 link"
644,Upgrade gradle build tools to 7.0.3,,Upgrade gradle build tools to 7.0.3,
645,Add --raw-key-events,"This option allows to inject all input keys as key events, and ignore text events. Fixes #2816 https://github.com/Genymobile/scrcpy/issues/2816 PR #2831 https://github.com/Genymobile/scrcpy/pull/2831",Add --raw-key-events,"This option allows to inject all input keys as key events, and ignore text events. Fixes #2816 link PR #2831 link"
646,Use enum for key injection mode,"There was only two key injection modes:  - the default one  - the mode with --prefer-text enabled To prepare the addition of another mode (--raw-key-events), use an enum instead of a bool. PR #2831 https://github.com/Genymobile/scrcpy/pull/2831",Use enum for key injection mode,"There was only two key injection modes:  - the default one  - the mode with --prefer-text enabled To prepare the addition of another mode (--raw-key-events), use an enum instead of a bool. PR #2831 link"
647,Use static maps to convert input events,This improves readability (hopefully). PR #2831 https://github.com/Genymobile/scrcpy/pull/2831,Use static maps to convert input events,This improves readability (hopefully). PR #2831 link
648,Fix code style in keyboard_inject,,Fix code style in keyboard_inject,
649,Improve HID keyboard documentation,Explain how to configure the keyboard layout.,Improve HID keyboard documentation,Explain how to configure the keyboard layout.
650,Document --tcpip in README,PR #2827 https://github.com/Genymobile/scrcpy/pull/2827,Document --tcpip in README,PR #2827 link
651,Add --tcpip feature,"Expose an option to automatically configure and reconnect the device over TCP/IP, to simplify wireless connection without using adb explicitly. There are two variants:  - If a destination address is provided, then scrcpy connects to this    address before starting. The device must listen on the given TCP port    (default is 5555).  - If no destination address is provided, then scrcpy attempts to find    the IP address of the current device (typically connected over USB),    enables TCP/IP mode, then connects to this address before starting. PR #2827 https://github.com/Genymobile/scrcpy/pull/2827",Add --tcpip feature,"Expose an option to automatically configure and reconnect the device over TCP/IP, to simplify wireless connection without using adb explicitly. There are two variants:  - If a destination address is provided, then scrcpy connects to this    address before starting. The device must listen on the given TCP port    (default is 5555).  - If no destination address is provided, then scrcpy attempts to find    the IP address of the current device (typically connected over USB),    enables TCP/IP mode, then connects to this address before starting. PR #2827 link"
652,Extract interruptible sleep for server,"This improves readability, and makes the function reusable. PR #2827 https://github.com/Genymobile/scrcpy/pull/2827",Extract interruptible sleep for server,"This improves readability, and makes the function reusable. PR #2827 link"
653,Add function to read an adb property,"This will allow to read the property ""service.adb.tcp.port"" to know if the TCP/IP mode is enabled on the device, and which listening port is used. PR #2827 https://github.com/Genymobile/scrcpy/pull/2827",Add function to read an adb property,"This will allow to read the property ""service.adb.tcp.port"" to know if the TCP/IP mode is enabled on the device, and which listening port is used. PR #2827 link"
654,Add function to switch device to TCP/IP mode,"Expose a function to execute ""adb tcpip "". PR #2827 https://github.com/Genymobile/scrcpy/pull/2827",Add function to switch device to TCP/IP mode,"Expose a function to execute ""adb tcpip "". PR #2827 link"
655,Add function to find the device IP address,"Parse the result of ""adb shell ip route"" to find the device IP address. PR #2827 https://github.com/Genymobile/scrcpy/pull/2827",Add function to find the device IP address,"Parse the result of ""adb shell ip route"" to find the device IP address. PR #2827 link"
656,Add util function to remove trailing '\r',"Depending on the platform and adb versions, the lines output by adb could end with ""\r\r\n"". This util function helps to remove all trailing '\r'. PR #2827 https://github.com/Genymobile/scrcpy/pull/2827",Add util function to remove trailing '\r',"Depending on the platform and adb versions, the lines output by adb could end with ""\r\r\n"". This util function helps to remove all trailing '\r'. PR #2827 link"
657,Add util function to locate a column in a string,"This will help to parse the result of ""adb shell ip route"" to find the device IP address. PR #2827 https://github.com/Genymobile/scrcpy/pull/2827",Add util function to locate a column in a string,"This will help to parse the result of ""adb shell ip route"" to find the device IP address. PR #2827 link"
658,"Workaround ""adb connect"" error detection","""adb connect"" always returns successfully (with exit code 0), even in case of failure. As a workaround, capture its output and check if it starts with ""connected"". PR #2827 https://github.com/Genymobile/scrcpy/pull/2827","Workaround ""adb connect"" error detection","""adb connect"" always returns successfully (with exit code 0), even in case of failure. As a workaround, capture its output and check if it starts with ""connected"". PR #2827 link"
659,Add adb connect and disconnect,PR #2827 https://github.com/Genymobile/scrcpy/pull/2827,Add adb connect and disconnect,PR #2827 link
660,Add adb flag to disable execution error logs,"In addition to disable stdout and stderr of the child process, add a flag to disable the error log printed by scrcpy if the command failed. This will we useful for commands which are expected to fail in some cases (like ""adb disconnect"" if the device is not connected). PR #2827 https://github.com/Genymobile/scrcpy/pull/2827",Add adb flag to disable execution error logs,"In addition to disable stdout and stderr of the child process, add a flag to disable the error log printed by scrcpy if the command failed. This will we useful for commands which are expected to fail in some cases (like ""adb disconnect"" if the device is not connected). PR #2827 link"
661,Use flags for adb commands,"Explicitly indicate, for each adb call, if stdout and stderr must be inherited. PR #2827 https://github.com/Genymobile/scrcpy/pull/2827",Use flags for adb commands,"Explicitly indicate, for each adb call, if stdout and stderr must be inherited. PR #2827 link"
662,Expose flags for process execution,"Let the caller decide if stdout and stderr must be inherited on process creation, i.e. if stdout and stderr of the child process should be printed in the scrcpy console. This allows to get output and errors for specific adb commands depending on the context. PR #2827 https://github.com/Genymobile/scrcpy/pull/2827",Expose flags for process execution,"Let the caller decide if stdout and stderr must be inherited on process creation, i.e. if stdout and stderr of the child process should be printed in the scrcpy console. This allows to get output and errors for specific adb commands depending on the context. PR #2827 link"
663,Remove obsolete precision in README,"Scrcpy is available in Debian stable packages, and several Ubuntu versions.",Remove obsolete precision in README,"Scrcpy is available in Debian stable packages, and several Ubuntu versions."
664,Simplify Windows process inheritance configuration,Merge if-blocks together.,Simplify Windows process inheritance configuration,Merge if-blocks together.
665,Remove intermediate static functions from adb.c,They can easily be inlined into the public functions.,Remove intermediate static functions from adb.c,They can easily be inlined into the public functions.
666,Set CLOEXEC flag on sockets,"If SOCK_CLOEXEC exists, then set the flag on socket creation. Otherwise, use fcntl() (or SetHandleInformation() on Windows) to set the flag afterwards. This avoids the sockets to be inherited in child processes. Refs #2783 https://github.com/Genymobile/scrcpy/pull/2783",Set CLOEXEC flag on sockets,"If SOCK_CLOEXEC exists, then set the flag on socket creation. Otherwise, use fcntl() (or SetHandleInformation() on Windows) to set the flag afterwards. This avoids the sockets to be inherited in child processes. Refs #2783 link"
667,Check process success locally for adb commands,"Remove sc_process_check_success() from the process API, it is too specific.",Check process success locally for adb commands,"Remove sc_process_check_success() from the process API, it is too specific."
668,Extract command argv building,This simplifies adb_execute_p().,Extract command argv building,This simplifies adb_execute_p().
669,Use unsigned for connection attempts count,There is no reason to use an explicit uint32_t.,Use unsigned for connection attempts count,There is no reason to use an explicit uint32_t.
670,Reorder cli sanity checks,Check unexpected additional arguments before other sanity checks.,Reorder cli sanity checks,Check unexpected additional arguments before other sanity checks.
671,Fix adb get-serialno error handling,"If pipe read fails, return.",Fix adb get-serialno error handling,"If pipe read fails, return."
672,Add OutOfMemory log helper,Add a special LOG_OOM() function to log all OutOfMemory errors (i.e. allocations returning NULL).,Add OutOfMemory log helper,Add a special LOG_OOM() function to log all OutOfMemory errors (i.e. allocations returning NULL).
673,Remove unreachable return statements,,Remove unreachable return statements,
674,Add missing return on file_handler failure,Mistake introduced by 84334cf7db68732eb92caf6cf9682c7ef2c426f6.,Add missing return on file_handler failure,Mistake introduced by 84334cf7db68732eb92caf6cf9682c7ef2c426f6.
675,Add missing includes,Include these headers explicitly instead of relying on transitivity.,Add missing includes,Include these headers explicitly instead of relying on transitivity.
676,Make lockVideoOrientation option name uniform,"On the server, the option was named lockedVideoOrientation.",Make lockVideoOrientation option name uniform,"On the server, the option was named lockedVideoOrientation."
677,Do not pass default values to the server,"By default, only pass the version and the bit rate (the default bitrate is a client compilation option).",Do not pass default values to the server,"By default, only pass the version and the bit rate (the default bitrate is a client compilation option)."
678,Pass server parameters as key=value pairs,"The options values to configure the server were identified by their command-line argument index. Now that there are a lot of arguments, many of them being booleans, it became unreadable and error-prone. Identify the arguments by a key string instead, and make them optional. This will also simplify running the server manually for debugging.",Pass server parameters as key=value pairs,"The options values to configure the server were identified by their command-line argument index. Now that there are a lot of arguments, many of them being booleans, it became unreadable and error-prone. Identify the arguments by a key string instead, and make them optional. This will also simplify running the server manually for debugging."
679,Allocate and format server command args,This simplifies formatting.,Allocate and format server command args,This simplifies formatting.
680,Parse codec options early,"For consistency with other options, parse the codec options on the server before storing them in the Options instance.",Parse codec options early,"For consistency with other options, parse the codec options on the server before storing them in the Options instance."
681,"Remove local ""serial"" variable","In execute_server(), the serial is used only once. Moreover, it can be retrieved from the params argument directly.","Remove local ""serial"" variable","In execute_server(), the serial is used only once. Moreover, it can be retrieved from the params argument directly."
682,Add (v)asprintf compatibility functions,In case they are not available on the platform.,Add (v)asprintf compatibility functions,In case they are not available on the platform.
683,Move check_functions in meson script,Move the variable to the place it is actually used.,Move check_functions in meson script,Move the variable to the place it is actually used.
684,Add missing includes in compat implementation,These includes are necessary for the strdup() compat implementation.,Add missing includes in compat implementation,These includes are necessary for the strdup() compat implementation.
685,Define common feature test macros for all systems,"_POSIX_C_SOURCE, _XOPEN_SOURCE and _GNU_SOURCE are also used on Windows. Fix regression introduced by ba547e3895397e3710e7eb14faafbabbd7e3a077.",Define common feature test macros for all systems,"_POSIX_C_SOURCE, _XOPEN_SOURCE and _GNU_SOURCE are also used on Windows. Fix regression introduced by ba547e3895397e3710e7eb14faafbabbd7e3a077."
686,Add option to disable clipboard autosync,"By default, scrcpy automatically synchronizes the computer clipboard to the device clipboard before injecting Ctrl+v, and the device clipboard to the computer clipboard whenever it changes. This new option --no-clipboard-autosync disables this automatic synchronization. Fixes #2228 https://github.com/Genymobile/scrcpy/issues/2228 PR #2817 https://github.com/Genymobile/scrcpy/pull/2817",Add option to disable clipboard autosync,"By default, scrcpy automatically synchronizes the computer clipboard to the device clipboard before injecting Ctrl+v, and the device clipboard to the computer clipboard whenever it changes. This new option --no-clipboard-autosync disables this automatic synchronization. Fixes #2228 link PR #2817 link"
687,Wait SET_CLIPBOARD ack before Ctrl+v via HID,"To allow seamless copy-paste, on Ctrl+v, a SET_CLIPBOARD request is performed before injecting Ctrl+v. But when HID keyboard is enabled, the Ctrl+v injection is not sent on the same channel as the clipboard request, so they are not serialized, and may occur in any order. If Ctrl+v happens to be injected before the new clipboard content is set, then the old content is pasted instead, which is incorrect. To minimize the probability of occurrence of the wrong order, a delay of 2 milliseconds was added before injecting Ctrl+v. Then 5ms. But even with 5ms, the wrong behavior sometimes happens. To handle it properly, add an acknowledgement mechanism, so that Ctrl+v is injected over AOA only after the SET_CLIPBOARD request has been performed and acknowledged by the server. Refs e4163321f00bb3830c6049bdb6c1515e7cc668a0 Refs 45b0f8123a52f5c73a5860d616f4ceba2766ca6a PR #2814 https://github.com/Genymobile/scrcpy/pull/2814",Wait SET_CLIPBOARD ack before Ctrl+v via HID,"To allow seamless copy-paste, on Ctrl+v, a SET_CLIPBOARD request is performed before injecting Ctrl+v. But when HID keyboard is enabled, the Ctrl+v injection is not sent on the same channel as the clipboard request, so they are not serialized, and may occur in any order. If Ctrl+v happens to be injected before the new clipboard content is set, then the old content is pasted instead, which is incorrect. To minimize the probability of occurrence of the wrong order, a delay of 2 milliseconds was added before injecting Ctrl+v. Then 5ms. But even with 5ms, the wrong behavior sometimes happens. To handle it properly, add an acknowledgement mechanism, so that Ctrl+v is injected over AOA only after the SET_CLIPBOARD request has been performed and acknowledged by the server. Refs e4163321f00bb3830c6049bdb6c1515e7cc668a0 Refs 45b0f8123a52f5c73a5860d616f4ceba2766ca6a PR #2814 link"
688,Move PRIu64 Windows workaround to compat.h,So that we can use it from several files. PR #2814 https://github.com/Genymobile/scrcpy/pull/2814,Move PRIu64 Windows workaround to compat.h,So that we can use it from several files. PR #2814 link
689,Make the device acknowledge device clipboard,"If the client provided a sequence number on SET_CLIPBOARD request, make the device send back an acknowledgement once the clipboard is set. PR #2814 https://github.com/Genymobile/scrcpy/pull/2814",Make the device acknowledge device clipboard,"If the client provided a sequence number on SET_CLIPBOARD request, make the device send back an acknowledgement once the clipboard is set. PR #2814 link"
690,Add device clipboard set acknowledgement,Add a device message type so that the device could send acknowledgements for SET_CLIPBOARD requests. PR #2814 https://github.com/Genymobile/scrcpy/pull/2814,Add device clipboard set acknowledgement,Add a device message type so that the device could send acknowledgements for SET_CLIPBOARD requests. PR #2814 link
691,Add sequence number to set_clipboard request,This will allow the client to request an acknowledgement. PR #2814 https://github.com/Genymobile/scrcpy/pull/2814,Add sequence number to set_clipboard request,This will allow the client to request an acknowledgement. PR #2814 link
692,Add acksync helper to wait for acks,This will allow to send requests with sequence numbers to the server and wait for acknowledgements. PR #2814 https://github.com/Genymobile/scrcpy/pull/2814,Add acksync helper to wait for acks,This will allow to send requests with sequence numbers to the server and wait for acknowledgements. PR #2814 link
693,Explicitly indicate when device clipboard is set,"Pass the information that device clipboard has been set to the key processor. This avoids the keyprocessor to ""guess"", and paves the way to implement a proper acknowledgement mechanism. PR #2814 https://github.com/Genymobile/scrcpy/pull/2814",Explicitly indicate when device clipboard is set,"Pass the information that device clipboard has been set to the key processor. This avoids the keyprocessor to ""guess"", and paves the way to implement a proper acknowledgement mechanism. PR #2814 link"
694,Do not inject Ctrl+v if clipboard sync failed,"This prevents to paste the current Android clipboard, which would be unexpected. PR #2814 https://github.com/Genymobile/scrcpy/pull/2814",Do not inject Ctrl+v if clipboard sync failed,"This prevents to paste the current Android clipboard, which would be unexpected. PR #2814 link"
695,Synchronize computer-to-device empty clipboard,"Set the device clipboard to empty string if necessary. Otherwise, the current device clipboard will be pasted on Ctrl+v. PR #2814 https://github.com/Genymobile/scrcpy/pull/2814",Synchronize computer-to-device empty clipboard,"Set the device clipboard to empty string if necessary. Otherwise, the current device clipboard will be pasted on Ctrl+v. PR #2814 link"
696,Use UINT64_C macro for uint64_t constant in tests,A long constant might not be sufficient.,Use UINT64_C macro for uint64_t constant in tests,A long constant might not be sufficient.
697,Document remote ADB server in README,Refs #2807 https://github.com/Genymobile/scrcpy/pull/2807,Document remote ADB server in README,Refs #2807 link
698,Force adb forward if tunnel host/port is provided,"Tunnel host and port are only meaningful in ""adb forward"" mode. They indicate where the client must connect to communicate with the server. In ""adb reverse"" mode, the client listens, it does not connect. Refs #2807 https://github.com/Genymobile/scrcpy/pull/2807",Force adb forward if tunnel host/port is provided,"Tunnel host and port are only meaningful in ""adb forward"" mode. They indicate where the client must connect to communicate with the server. In ""adb reverse"" mode, the client listens, it does not connect. Refs #2807 link"
699,Add options to configure tunnel host and port,"In ""adb forward"" mode, by default, scrcpy connects to localhost:PORT, where PORT is the local port passed to ""adb forward"". This assumes that the tunnel is established on the local host with a local adb server (which is the common case). For advanced usage, add --tunnel-host and --tunnel-port to force the connection to a different destination. Fixes #2801 https://github.com/Genymobile/scrcpy/issues/2801 PR #2807 https://github.com/Genymobile/scrcpy/pull/2807 Signed-off-by: Romain Vimont rom@rom1v.com",Add options to configure tunnel host and port,"In ""adb forward"" mode, by default, scrcpy connects to localhost:PORT, where PORT is the local port passed to ""adb forward"". This assumes that the tunnel is established on the local host with a local adb server (which is the common case). For advanced usage, add --tunnel-host and --tunnel-port to force the connection to a different destination. Fixes #2801 link PR #2807 link Signed-off-by: Romain Vimont rom@rom1v.com"
700,Add function to parse IPv4 addresses,PR #2807 https://github.com/Genymobile/scrcpy/pull/2807 Signed-off-by: Romain Vimont rom@rom1v.com,Add function to parse IPv4 addresses,PR #2807 link Signed-off-by: Romain Vimont rom@rom1v.com
701,Configure feature test macros in meson,Refs #2807 https://github.com/Genymobile/scrcpy/pull/2807 Co-authored-by: RipleyTom RipleyTom@users.noreply.github.com,Configure feature test macros in meson,Refs #2807 link Co-authored-by: RipleyTom RipleyTom@users.noreply.github.com
702,Add missing include config.h,,Add missing include config.h,
703,Improve SSH tunnel documentation in README,,Improve SSH tunnel documentation in README,
704,Print scrcpy header first,"Inconditionnally print the scrcpy version first, without using LOGI(). The log level is configured only after parsing the command line parameters (it may be changed via -V), and command line parsing logs should not appear before the scrcpy version.",Print scrcpy header first,"Inconditionnally print the scrcpy version first, without using LOGI(). The log level is configured only after parsing the command line parameters (it may be changed via -V), and command line parsing logs should not appear before the scrcpy version."
705,Print help to stdout,"The output of -h/--help was printed on stderr, although it is not an error. Printing on stdout allows to pipe the result directly: scrcpy --help | less  Instead of (in bash): scrcpy --help |& less",Print help to stdout,"The output of -h/--help was printed on stderr, although it is not an error. Printing on stdout allows to pipe the result directly: scrcpy --help | less Instead of (in bash): scrcpy --help |& less"
706,Assert that long options are correctly set,,Assert that long options are correctly set,
707,Simplify adb_tunnel,"With the new adb functions, the static adb_tunnel functions become unnecessary.",Simplify adb_tunnel,"With the new adb functions, the static adb_tunnel functions become unnecessary."
708,Privatize low-level adb functions,Only expose the interruptible user-friendly API.,Privatize low-level adb functions,Only expose the interruptible user-friendly API.
709,Use new user-friendly adb API,Replace the adb_exec_*() calls by the new adb functions to simplify.,Use new user-friendly adb API,Replace the adb_exec_*() calls by the new adb functions to simplify.
710,Expose new user-friendly adb functions,"Expose interruptible adb functions which return the expected result directly, without exposing the process (sc_pid) to the caller.",Expose new user-friendly adb functions,"Expose interruptible adb functions which return the expected result directly, without exposing the process (sc_pid) to the caller."
711,Rename adb functions to adb_exec_*,This paves the way to replace them by more user-friendly functions that will call them internally.,Rename adb functions to adb_exec_*,This paves the way to replace them by more user-friendly functions that will call them internally.
712,Use sc_intr in file_handler,Replace manual interruption handling by the recent sc_intr mechanism.,Use sc_intr in file_handler,Replace manual interruption handling by the recent sc_intr mechanism.
713,Simplify file_handler,Call the target functions directly.,Simplify file_handler,Call the target functions directly.
714,Improve file_handler readability,Use local variables as short name aliases.,Improve file_handler readability,Use local variables as short name aliases.
715,Simplify adb_execute_p(),"Only pass the stdout pipe as parameter, scrcpy never writes to stdin or reads from stderr of an adb process.",Simplify adb_execute_p(),"Only pass the stdout pipe as parameter, scrcpy never writes to stdin or reads from stderr of an adb process."
716,"Make ""adb get-serialno"" interruptible","All process executions must be interruptible, so that Ctrl+c reacts immediately.","Make ""adb get-serialno"" interruptible","All process executions must be interruptible, so that Ctrl+c reacts immediately."
717,Add interruptible function to read from pipe,This will avoid to block Ctrl+c if the process the pipe is read from takes too much time.,Add interruptible function to read from pipe,This will avoid to block Ctrl+c if the process the pipe is read from takes too much time.
718,Simplify sc_str_truncate(),Use strcspn() to get the prefix length directly.,Simplify sc_str_truncate(),Use strcspn() to get the prefix length directly.
719,Generalize string trunctation util function,Add an additional argument to let the client pass the possible end chars.,Generalize string trunctation util function,Add an additional argument to let the client pass the possible end chars.
720,Expose util function to truncate first line,Move the local implementation from adb functions to the string util functions.,Expose util function to truncate first line,Move the local implementation from adb functions to the string util functions.
721,Assume non-NULL serial in file_handler,"The previous commit guarantees to always initialize the serial, so the file_handle may assume it is never NULL.",Assume non-NULL serial in file_handler,"The previous commit guarantees to always initialize the serial, so the file_handle may assume it is never NULL."
722,Always retrieve device serial,"This allows to execute all adb commands with the specific -s parameter, even if it is not provided by the user. In practice, calling adb without -s works if there is exactly one device connected. But some adb commands (for example ""adb push"" on drag & drop) could be executed after another device is connected, so the actual device serial must be known.",Always retrieve device serial,"This allows to execute all adb commands with the specific -s parameter, even if it is not provided by the user. In practice, calling adb without -s works if there is exactly one device connected. But some adb commands (for example ""adb push"" on drag & drop) could be executed after another device is connected, so the actual device serial must be known."
723,Add missing error handling,"If ""adb get-serialno"" fails, attempting to read from the uninitialized pipe is incorrect.",Add missing error handling,"If ""adb get-serialno"" fails, attempting to read from the uninitialized pipe is incorrect."
724,Close process on check success,"The interruptible version of the function to check process success (sc_process_check_success_intr()) did not accept a close parameter to avoid a race condition. But as the result, the processes were not closed at all. Add a close parameter, and close the process separately to avoid the race condition.",Close process on check success,"The interruptible version of the function to check process success (sc_process_check_success_intr()) did not accept a close parameter to avoid a race condition. But as the result, the processes were not closed at all. Add a close parameter, and close the process separately to avoid the race condition."
725,Configure init and cleanup asynchronously,Accessing the settings (like --show-touches) on start should not delay screen mirroring. PR #2802 https://github.com/Genymobile/scrcpy/pull/2802,Configure init and cleanup asynchronously,Accessing the settings (like --show-touches) on start should not delay screen mirroring. PR #2802 link
726,Do not quit on cleanup configuration failure,"Cleanup is used for some options like --show-touches to restore the state on exit. If the configuration fails, do not crash the whole process. Just log an error. PR #2802 https://github.com/Genymobile/scrcpy/pull/2802",Do not quit on cleanup configuration failure,"Cleanup is used for some options like --show-touches to restore the state on exit. If the configuration fails, do not crash the whole process. Just log an error. PR #2802 link"
727,Move init and cleanup to a separate method,PR #2802 https://github.com/Genymobile/scrcpy/pull/2802,Move init and cleanup to a separate method,PR #2802 link
728,Read/write settings via command on Android >= 12,"Before Android 8, executing the ""settings"" command from a shell was very slow (~1 second), because it spawned a new app_process to execute Java code. Therefore, to access settings without performance issues, scrcpy used private APIs to read from and write to settings. However, since Android 12, this is not possible anymore, due to permissions changes. To make it work again, execute the ""settings"" command on Android 12 (or on previous version if the other method failed). This method is faster than before Android 8 (~100ms). Fixes #2671 https://github.com/Genymobile/scrcpy/issues/2671 Fixes #2788 https://github.com/Genymobile/scrcpy/issues/2788 PR #2802 https://github.com/Genymobile/scrcpy/pull/2802",Read/write settings via command on Android >= 12,"Before Android 8, executing the ""settings"" command from a shell was very slow (~1 second), because it spawned a new app_process to execute Java code. Therefore, to access settings without performance issues, scrcpy used private APIs to read from and write to settings. However, since Android 12, this is not possible anymore, due to permissions changes. To make it work again, execute the ""settings"" command on Android 12 (or on previous version if the other method failed). This method is faster than before Android 8 (~100ms). Fixes #2671 link Fixes #2788 link PR #2802 link"
729,Add throwable parameter to Log.w(),"When an exception occurs, we might want to log a warning instead of an error. PR #2802 https://github.com/Genymobile/scrcpy/pull/2802",Add throwable parameter to Log.w(),"When an exception occurs, we might want to log a warning instead of an error. PR #2802 link"
730,Report settings errors via Exceptions,"Settings read/write errors were silently ignored. Report them via a SettingsException so that the caller can handle them. This allows to log a proper error message, and will also allow to fallback to a different settings method in case of failure. PR #2802 https://github.com/Genymobile/scrcpy/pull/2802",Report settings errors via Exceptions,"Settings read/write errors were silently ignored. Report them via a SettingsException so that the caller can handle them. This allows to log a proper error message, and will also allow to fallback to a different settings method in case of failure. PR #2802 link"
731,Wrap settings management into a Settings class,"Until now, the code that needed to read/write the Android settings had to explicitly open and close a ContentProvider. Wrap these details into a Settings class. This paves the way to provide an alternative implementation of settings read/write for Android >= 12. PR #2802 https://github.com/Genymobile/scrcpy/pull/2802",Wrap settings management into a Settings class,"Until now, the code that needed to read/write the Android settings had to explicitly open and close a ContentProvider. Wrap these details into a Settings class. This paves the way to provide an alternative implementation of settings read/write for Android >= 12. PR #2802 link"
732,Update Simplified Chinese README to 1.20,PR #2786 https://github.com/Genymobile/scrcpy/pull/2786 Signed-off-by: Romain Vimont rom@rom1v.com,Update Simplified Chinese README to 1.20,PR #2786 link Signed-off-by: Romain Vimont rom@rom1v.com
733,Fix wrong package to install for Ubuntu/Debian,"Without this package, meson fails: Run-time dependency libusb-1.0 found: NO (tried pkgconfig and cmake) app/meson.build:88:8: ERROR: Dependency ""libusb-1.0"" not found, tried pkgconfig and cmake  PR #2790 https://github.com/Genymobile/scrcpy/pull/2790 Signed-off-by: Romain Vimont rom@rom1v.com",Fix wrong package to install for Ubuntu/Debian,"Without this package, meson fails: Run-time dependency libusb-1.0 found: NO (tried pkgconfig and cmake) app/meson.build:88:8: ERROR: Dependency ""libusb-1.0"" not found, tried pkgconfig and cmake PR #2790 link Signed-off-by: Romain Vimont rom@rom1v.com"
734,Inherit only specific handles on Windows,"To be able to communicate with a child process via stdin, stdout and stderr, the CreateProcess() parameter bInheritHandles must be set to TRUE. But this causes all handles to be inherited, including sockets. As a result, the server socket was inherited by the process running adb to execute the server on the device, so it could not be closed properly, causing other scrcpy instances to fail. To fix the issue, use an extended API to explicitly set the HANDLEs to inherit:  - https://stackoverflow.com/a/28185363/1987178  - https://devblogs.microsoft.com/oldnewthing/20111216-00/?p=8873 Fixes #2779 https://github.com/Genymobile/scrcpy/issues/2779 PR #2783 https://github.com/Genymobile/scrcpy/pull/2783",Inherit only specific handles on Windows,"To be able to communicate with a child process via stdin, stdout and stderr, the CreateProcess() parameter bInheritHandles must be set to TRUE. But this causes all handles to be inherited, including sockets. As a result, the server socket was inherited by the process running adb to execute the server on the device, so it could not be closed properly, causing other scrcpy instances to fail. To fix the issue, use an extended API to explicitly set the HANDLEs to inherit:  - link  - link Fixes #2779 link PR #2783 link"
735,Factorize resource release after CreateProcess(),Free the wide characters string in all cases before checking for errors.,Factorize resource release after CreateProcess(),Free the wide characters string in all cases before checking for errors.
736,Remove useless assignments on error,Leave the output parameter untouched on error.,Remove useless assignments on error,Leave the output parameter untouched on error.
737,Fix Windows sc_pipe function names,"The implementation name was incorrect (it was harmless, because they are not used on Windows).",Fix Windows sc_pipe function names,"The implementation name was incorrect (it was harmless, because they are not used on Windows)."
738,Stop connection attempts if interrupted,"If the interruptor is interrupted, every network call will fail, but the retry-on-error mechanism must also be stopped.",Stop connection attempts if interrupted,"If the interruptor is interrupted, every network call will fail, but the retry-on-error mechanism must also be stopped."
739,Fix compilation errors with old SDL versions,SDL_PixelFormatEnum has been introduced in SDL 2.0.10: https://github.com/libsdl-org/SDL/commit/cc6a8ac87e41d0df68075081dbf5cd2ba46f8fd4 SDL_PIXELFORMAT_BGR444 has been introduced in SDL 2.0.12: https://github.com/libsdl-org/SDL/commit/a1c11854f28b7186a744df412aa6273862459c31 Fixes #2777 https://github.com/Genymobile/scrcpy/issues/2777 PR #2781 https://github.com/Genymobile/scrcpy/pull/2781 Reviewed-by: Yu-Chen Lin npes87184@gmail.com,Fix compilation errors with old SDL versions,SDL_PixelFormatEnum has been introduced in SDL 2.0.10: link SDL_PIXELFORMAT_BGR444 has been introduced in SDL 2.0.12: link Fixes #2777 link PR #2781 link Reviewed-by: Yu-Chen Lin npes87184@gmail.com
740,Update links to v1.20,,Update links to v1.20,
741,Bump version to 1.20,,Bump version to 1.20,
742,Update script to build without gradle to SDK 31,Build tools 31.x.x do not ship dx anymore. Use d8 instead. Refs 8bf28e9f5340d2a54dbc9b2c9d924b7ee4fa8d31,Update script to build without gradle to SDK 31,Build tools 31.x.x do not ship dx anymore. Use d8 instead. Refs 8bf28e9f5340d2a54dbc9b2c9d924b7ee4fa8d31
743,Extract ANDROID_JAR path in build script,This will allow to reuse it.,Extract ANDROID_JAR path in build script,This will allow to reuse it.
744,Merge branch 'master' into dev,,Merge branch 'master' into dev,
745,Fix word order in README,,Fix word order in README,
746,Mention crash on Android 12 on old scrcpy in FAQ,,Mention crash on Android 12 on old scrcpy in FAQ,
747,Adapt icon in README,"Use SVG format, align to the right, and reduce its size.",Adapt icon in README,"Use SVG format, align to the right, and reduce its size."
748,"Replace ""connected on"" to ""connected via""","I'm not sure ""connected on USB"" is correct.","Replace ""connected on"" to ""connected via""","I'm not sure ""connected on USB"" is correct."
749,Improve scrcpy presentation in README,,Improve scrcpy presentation in README,
750,Increase delay to inject HID on Ctrl+v,2 milliseconds turn out to be insufficient sometimes. It seems that 5 milliseconds is enough (and still not noticeable).,Increase delay to inject HID on Ctrl+v,2 milliseconds turn out to be insufficient sometimes. It seems that 5 milliseconds is enough (and still not noticeable).
751,Use sc_ prefix for server,,Use sc_ prefix for server,
752,Move str_util to str,Simplify naming.,Move str_util to str,Simplify naming.
753,Improve string util API,Use prefixed names and improve documentation.,Improve string util API,Use prefixed names and improve documentation.
754,Rename SC_INVALID_SOCKET to SC_SOCKET_NONE,For consistency with SC_PROCESS_NONE.,Rename SC_INVALID_SOCKET to SC_SOCKET_NONE,For consistency with SC_PROCESS_NONE.
755,Extract adb tunnel to a separate component,This simplifies the server code.,Extract adb tunnel to a separate component,This simplifies the server code.
756,Move IPV4_LOCALHOST to net.h,This constant will be used from several files.,Move IPV4_LOCALHOST to net.h,This constant will be used from several files.
757,Interrupt on process terminated,"Interrupt any blocking call on process terminated, like on server_stop(). This allows to interrupt any blocking accept() with correct synchronization without additional complexity.",Interrupt on process terminated,"Interrupt any blocking call on process terminated, like on server_stop(). This allows to interrupt any blocking accept() with correct synchronization without additional complexity."
758,Make server interruptible,Use an interruptor to immediately wake up blocking calls on server_stop().,Make server interruptible,Use an interruptor to immediately wake up blocking calls on server_stop().
759,Add interruptor utilities,"Expose wrapper functions for interrupting blocking calls, for process and sockets.",Add interruptor utilities,"Expose wrapper functions for interrupting blocking calls, for process and sockets."
760,Introduce interruptor tool,An interruptor instance will help to wake up a blocking call from another thread (typically to terminate immediately on Ctrl+C).,Introduce interruptor tool,An interruptor instance will help to wake up a blocking call from another thread (typically to terminate immediately on Ctrl+C).
761,Run the server from a dedicated thread,"Define server callbacks, start the server asynchronously and listen to connection events to initialize scrcpy properly. It will help to simplify the server code, and allows to run the UI event loop while the server is connecting. In particular, this will allow to receive SIGINT/Ctrl+C events during connection to interrupt immediately.",Run the server from a dedicated thread,"Define server callbacks, start the server asynchronously and listen to connection events to initialize scrcpy properly. It will help to simplify the server code, and allows to run the UI event loop while the server is connecting. In particular, this will allow to receive SIGINT/Ctrl+C events during connection to interrupt immediately."
762,Wait using a condition variable in server,"Currently, server_stop() is called from the same thread as server_connect_to(), so interruption may never happen. This is a step to prepare executing the server from a dedicated thread.",Wait using a condition variable in server,"Currently, server_stop() is called from the same thread as server_connect_to(), so interruption may never happen. This is a step to prepare executing the server from a dedicated thread."
763,Reorder server functions,This will avoid forward declarations in future commits.,Reorder server functions,This will avoid forward declarations in future commits.
764,Copy server params,This is a preliminary step necessary to move the server to a separate thread.,Copy server params,This is a preliminary step necessary to move the server to a separate thread.
765,Reorder server and server_params,This will allow to define a server_params field in server.,Reorder server and server_params,This will allow to define a server_params field in server.
766,Split socket creation and connect/listen,"This will allow to assign the socket to a variable before connecting or listening, so that it can be interrupted from another thread.",Split socket creation and connect/listen,"This will allow to assign the socket to a variable before connecting or listening, so that it can be interrupted from another thread."
767,Set video and control sockets only on success,Store the video and control sockets only if server_connect_to() returns successfully.,Set video and control sockets only on success,Store the video and control sockets only if server_connect_to() returns successfully.
768,Initialize tunnel_enabled flag internally,"Set the flag from the inner methods, to avoid bypassing the assignment by mistake (on error for example).",Initialize tunnel_enabled flag internally,"Set the flag from the inner methods, to avoid bypassing the assignment by mistake (on error for example)."
769,Introduce process observer,Add a tool to easily observe process termination. This allows to move this complexity out of the server code.,Introduce process observer,Add a tool to easily observe process termination. This allows to move this complexity out of the server code.
770,Improve process API,Prefix symbols and constants names and improve documentation.,Improve process API,Prefix symbols and constants names and improve documentation.
771,Factorize common impl of process_execute(),Both implementations are the same. Move them to the common process.c.,Factorize common impl of process_execute(),Both implementations are the same. Move them to the common process.c.
772,Remove duplicate function declaration,The function process_terminate() was declared twice.,Remove duplicate function declaration,The function process_terminate() was declared twice.
773,Improve file API,Prefix symbols and constants names and improve documentation.,Improve file API,Prefix symbols and constants names and improve documentation.
774,Move functions from process to file,Move filesystem-related functions from process.[ch] to file.[ch].,Move functions from process to file,Move filesystem-related functions from process.[ch] to file.[ch].
775,Make screen_render() static,It is only used from screen.c.,Make screen_render() static,It is only used from screen.c.
776,Upgrade junit to 4.13.1,,Upgrade junit to 4.13.1,
777,Adapt help to terminal size,"If the error stream is a terminal, and we can retrieve the terminal size, wrap the help content according to the terminal width.",Adapt help to terminal size,"If the error stream is a terminal, and we can retrieve the terminal size, wrap the help content according to the terminal width."
778,Add util function to get terminal size,,Add util function to get terminal size,
779,Generate getopt params from option structures,"Use the option descriptions to generate the optstring and longopts parameters for the getopt_long() command. That way, the options are completely described in a single place.",Generate getopt params from option structures,"Use the option descriptions to generate the optstring and longopts parameters for the getopt_long() command. That way, the options are completely described in a single place."
780,Structure shortcuts help,,Structure shortcuts help,
781,Structure command line options help,It will allow to correctly print the help for the current terminal size (even if for now it is hardcoded to 80 columns).,Structure command line options help,It will allow to correctly print the help for the current terminal size (even if for now it is hardcoded to 80 columns).
782,Add line wrapper,"Add a tool to wrap lines at words boundaries (spaces) to fit in a specified number of columns, left-indented by a specified number of spaces.",Add line wrapper,"Add a tool to wrap lines at words boundaries (spaces) to fit in a specified number of columns, left-indented by a specified number of spaces."
783,Add string buffer util,This will help to build strings incrementally.,Add string buffer util,This will help to build strings incrementally.
784,Remove deprecated -T option,The short option -T is deprecated since v1.11. Only the long version (--always-on-top) remains.,Remove deprecated -T option,The short option -T is deprecated since v1.11. Only the long version (--always-on-top) remains.
785,Remove deprecated -c option,The short option -c is deprecated since v1.11. Only the long version (--crop) remains.,Remove deprecated -c option,The short option -c is deprecated since v1.11. Only the long version (--crop) remains.
786,Document --power-off-on-close,The option was not documented. Refs #824 https://github.com/Genymobile/scrcpy/pull/824,Document --power-off-on-close,The option was not documented. Refs #824 link
787,Mention drag & drop for non-APK files in help,,Mention drag & drop for non-APK files in help,
788,Mention drag & drop APK in README,For consistency with --help and manpage.,Mention drag & drop APK in README,For consistency with --help and manpage.
789,Remove extra space in README,,Remove extra space in README,
790,Fix typos in help,,Fix typos in help,
791,"Add missing include ""common.h""",,"Add missing include ""common.h""",
792,Wrap device name and size in a struct,"As a benefit, this avoids to take care of the device name length on the caller side.",Wrap device name and size in a struct,"As a benefit, this avoids to take care of the device name length on the caller side."
793,Update README.jp.md to v1.19,PR #2740 https://github.com/Genymobile/scrcpy/pull/2740 Signed-off-by: Romain Vimont rom@rom1v.com,Update README.jp.md to v1.19,PR #2740 link Signed-off-by: Romain Vimont rom@rom1v.com
794,Remove unnecessary variable,"Test directly if a record filename is provided, without an intermediate boolean variable.",Remove unnecessary variable,"Test directly if a record filename is provided, without an intermediate boolean variable."
795,Disable synthetic mouse events from touch events,"Touch events with id SDL_TOUCH_MOUSEID are ignored anyway, but it is better not to generate them in the first place.",Disable synthetic mouse events from touch events,"Touch events with id SDL_TOUCH_MOUSEID are ignored anyway, but it is better not to generate them in the first place."
796,Split SDL initialization,Initialize SDL_INIT_EVENTS first (very quick) and SDL_INIT_VIDEO after the server (quite long).,Split SDL initialization,Initialize SDL_INIT_EVENTS first (very quick) and SDL_INIT_VIDEO after the server (quite long).
797,Move SDL initialization,Inline SDL initialization in scrcpy(). This will allow to split minimal initialization and video initialization.,Move SDL initialization,Inline SDL initialization in scrcpy(). This will allow to split minimal initialization and video initialization.
798,Set SDL hints before initialization,"In theory, some SDL hints should be initialized before calling SDL_Init().",Set SDL hints before initialization,"In theory, some SDL hints should be initialized before calling SDL_Init()."
799,Extract SDL hints,Set all SDL hints in a separate function.,Extract SDL hints,Set all SDL hints in a separate function.
800,Factorize SDL event push,"Add a macro and inline function to call SDL_PushEvent() and log on error (without actually handling the error, because there is nothing we could do).",Factorize SDL event push,"Add a macro and inline function to call SDL_PushEvent() and log on error (without actually handling the error, because there is nothing we could do)."
801,Handle SDL_PushEvent() errors,"Pushing an event to the main thread may fail. If this happens, log an error, and try to recover when possible.",Handle SDL_PushEvent() errors,"Pushing an event to the main thread may fail. If this happens, log an error, and try to recover when possible."
802,"Use sc_ prefix for size, position and point",,"Use sc_ prefix for size, position and point",
803,Upgrade gradle build tools to 7.0.2,,Upgrade gradle build tools to 7.0.2,
804,Upgrade Android checkstyle to 9.0.1,"Adapt checkstyle.xml to match the latest version, and remove a line break between imports which trigger a checkstyle volation.",Upgrade Android checkstyle to 9.0.1,"Adapt checkstyle.xml to match the latest version, and remove a line break between imports which trigger a checkstyle volation."
805,Upgrade Android SDK to 31,,Upgrade Android SDK to 31,
806,Fix typo in clock comments,,Fix typo in clock comments,
807,Define v4l2 option field only if HAVE_V4L2,,Define v4l2 option field only if HAVE_V4L2,
808,Define default options as const struct,"This is more readable than a macro, and we could ifdef some fields.",Define default options as const struct,"This is more readable than a macro, and we could ifdef some fields."
809,Move scrcpy option structs to options.h,This will allow to define symbols in options.c without all the dependencies of scrcpy.c.,Move scrcpy option structs to options.h,This will allow to define symbols in options.c without all the dependencies of scrcpy.c.
810,Expose socket interruption,"On Linux, socket functions are unblocked by shutdown(), but on Windows they are unblocked by closesocket(). Expose net_interrupt() and net_close() to abstract these differences:  - net_interrupt() calls shutdown() on Linux and closesocket() on    Windows (if not already called);  - net_close() calls close() on Linux and closesocket() on Windows (if    not already called). This simplifies the server code, and prevents a data race on close (reported by TSAN) on Linux (but does not fix it on Windows): WARNING: ThreadSanitizer: data race (pid=836124)   Write of size 8 at 0x7ba0000000d0 by main thread:     #0 close ../../../../src/libsanitizer/tsan/tsan_interceptors_posix.cpp:1690 (libtsan.so.0+0x359d8)     #1 net_close ../app/src/util/net.c:211 (scrcpy+0x1c76b)     #2 close_socket ../app/src/server.c:330 (scrcpy+0x19442)     #3 server_stop ../app/src/server.c:522 (scrcpy+0x19e33)     #4 scrcpy ../app/src/scrcpy.c:532 (scrcpy+0x156fc)     #5 main ../app/src/main.c:92 (scrcpy+0x622a)    Previous read of size 8 at 0x7ba0000000d0 by thread T6:     #0 recv ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:6603 (libtsan.so.0+0x4f4a6)     #1 net_recv ../app/src/util/net.c:167 (scrcpy+0x1c5a7)     #2 run_receiver ../app/src/receiver.c:76 (scrcpy+0x12819)     #3 <null> <null> (libSDL2-2.0.so.0+0x84f40)",Expose socket interruption,"On Linux, socket functions are unblocked by shutdown(), but on Windows they are unblocked by closesocket(). Expose net_interrupt() and net_close() to abstract these differences:  - net_interrupt() calls shutdown() on Linux and closesocket() on    Windows (if not already called);  - net_close() calls close() on Linux and closesocket() on Windows (if    not already called). This simplifies the server code, and prevents a data race on close (reported by TSAN) on Linux (but does not fix it on Windows): WARNING: ThreadSanitizer: data race (pid=836124)   Write of size 8 at 0x7ba0000000d0 by main thread:     #0 close ../../../../src/libsanitizer/tsan/tsan_interceptors_posix.cpp:1690 (libtsan.so.0+0x359d8)     #1 net_close ../app/src/util/net.c:211 (scrcpy+0x1c76b)     #2 close_socket ../app/src/server.c:330 (scrcpy+0x19442)     #3 server_stop ../app/src/server.c:522 (scrcpy+0x19e33)     #4 scrcpy ../app/src/scrcpy.c:532 (scrcpy+0x156fc)     #5 main ../app/src/main.c:92 (scrcpy+0x622a) Previous read of size 8 at 0x7ba0000000d0 by thread T6:     #0 recv ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:6603 (libtsan.so.0+0x4f4a6)     #1 net_recv ../app/src/util/net.c:167 (scrcpy+0x1c5a7)     #2 run_receiver ../app/src/receiver.c:76 (scrcpy+0x12819)     #3   (libSDL2-2.0.so.0+0x84f40)"
811,Add socket wrapper,"This paves the way to store an additional ""closed"" flag on Windows to interrupt and close properly.",Add socket wrapper,"This paves the way to store an additional ""closed"" flag on Windows to interrupt and close properly."
812,Use net_send() from net_send_all(),This will make net_send_all() continue to work even if net_send() behavior is changed.,Use net_send() from net_send_all(),This will make net_send_all() continue to work even if net_send() behavior is changed.
813,Use sc_ prefix for sockets,Rename:  - socket_t to sc_socket  - INVALID_SOCKET to SC_INVALID_SOCKET,Use sc_ prefix for sockets,Rename:  - socket_t to sc_socket  - INVALID_SOCKET to SC_INVALID_SOCKET
814,Move net_init() and net_cleanup() upwards,"These two functions are global, define them at the top of the implementation file. This is consistent with the header file.",Move net_init() and net_cleanup() upwards,"These two functions are global, define them at the top of the implementation file. This is consistent with the header file."
815,Update FAQ to mention HID keyboard,,Update FAQ to mention HID keyboard,
816,Delay HID events on Ctrl+v,"When Ctrl+v is pressed, a control is sent to the device to set the device clipboard before injecting Ctrl+v. With the InputManager method, it is guaranteed that the device synchronization is executed before handling Ctrl+v, since the commands are executed on the device in sequence. However, HID are injected from the computer, so there is no such guarantee. As a consequence, on Android, Ctrl+v triggers a paste with the old clipboard content. To workaround the issue, wait a bit (2 milliseconds) from the AOA thread before injecting the event, to leave enough time for the clipboard to be set before injecting Ctrl+v.",Delay HID events on Ctrl+v,"When Ctrl+v is pressed, a control is sent to the device to set the device clipboard before injecting Ctrl+v. With the InputManager method, it is guaranteed that the device synchronization is executed before handling Ctrl+v, since the commands are executed on the device in sequence. However, HID are injected from the computer, so there is no such guarantee. As a consequence, on Android, Ctrl+v triggers a paste with the old clipboard content. To workaround the issue, wait a bit (2 milliseconds) from the AOA thread before injecting the event, to leave enough time for the clipboard to be set before injecting Ctrl+v."
817,Synchronize HID keyboard state on first event,"When an AOA HID keyboard is registered, CAPSLOCK and NUMLOCK are both disabled, regardless of the state of the computer keyboard. To synchronize the state, on first key event, inject CAPSLOCK and/or NUMLOCK if necessary.",Synchronize HID keyboard state on first event,"When an AOA HID keyboard is registered, CAPSLOCK and NUMLOCK are both disabled, regardless of the state of the computer keyboard. To synchronize the state, on first key event, inject CAPSLOCK and/or NUMLOCK if necessary."
818,Retrieve device serial for AOA,"The serial is necessary to find the correct Android device for AOA. If it is not explicitly provided by the user via -s, then execute ""adb getserialno"" to retrieve it.",Retrieve device serial for AOA,"The serial is necessary to find the correct Android device for AOA. If it is not explicitly provided by the user via -s, then execute ""adb getserialno"" to retrieve it."
819,Expose function to get the device serial,"Expose adb_get_serialno() to retrieve the device serial via the command ""adb getserialno"".",Expose function to get the device serial,"Expose adb_get_serialno() to retrieve the device serial via the command ""adb getserialno""."
820,Add read_pipe_all(),Add a convenience function to read from a pipe until all requested data has been read.,Add read_pipe_all(),Add a convenience function to read from a pipe until all requested data has been read.
821,Expose adb execution with redirection,Expose the redirection feature to the adb API.,Expose adb execution with redirection,Expose the redirection feature to the adb API.
822,Add command execution with redirection,"Expose command execution with pipes to stdin, stdout and stderr. This will allow to read the result of adb commands.",Add command execution with redirection,"Expose command execution with pipes to stdin, stdout and stderr. This will allow to read the result of adb commands."
823,Add support for USB HID keyboard over AOAv2,"This provides a better input experience, by simulating a physical keyboard. It converts SDL keyboard events to proper HID events, and send them over AOAv2. This is a rewriting and bugfix of the origin code from @amosbird: https://github.com/Genymobile/scrcpy/issues/279#issuecomment-453819354 The feature is enabled the command line option -K or --hid-keyboard, and is only available on Linux, over USB. Refs https://source.android.com/devices/accessories/aoa2#hid-support Refs https://www.usb.org/sites/default/files/hid1_11.pdf PR #2632 https://github.com/Genymobile/scrcpy/pull/2632 Signed-off-by: Romain Vimont rom@rom1v.com",Add support for USB HID keyboard over AOAv2,"This provides a better input experience, by simulating a physical keyboard. It converts SDL keyboard events to proper HID events, and send them over AOAv2. This is a rewriting and bugfix of the origin code from @amosbird: link The feature is enabled the command line option -K or --hid-keyboard, and is only available on Linux, over USB. Refs link Refs link PR #2632 link Signed-off-by: Romain Vimont rom@rom1v.com"
824,Extract mouse processor trait,Mainly for consistency with the keyboard processor trait. This could allow to provide alternative mouse processors.,Extract mouse processor trait,Mainly for consistency with the keyboard processor trait. This could allow to provide alternative mouse processors.
825,Extract keyboard processor trait,This will allow to provide alternative key processors.,Extract keyboard processor trait,This will allow to provide alternative key processors.
826,Fix trait header guards,,Fix trait header guards,
827,Remove unused markdown link in README,,Remove unused markdown link in README,
828,Mention SCRCPY_ICON_PATH envvar in README,,Mention SCRCPY_ICON_PATH envvar in README,
829,Add scrcpy icon to README,,Add scrcpy icon to README,
830,Remove legacy scrcpy icon,Remove the old icon in XPM format and the code to load it.,Remove legacy scrcpy icon,Remove the old icon in XPM format and the code to load it.
831,Add icon source in SVG format,"Scrcpy only uses the PNG format (because SDL only supports bitmap icons), but keep the SVG source in the repo.",Add icon source in SVG format,"Scrcpy only uses the PNG format (because SDL only supports bitmap icons), but keep the SVG source in the repo."
832,Use a new scrcpy icon,Use the new icon designed by @varlesh: https://github.com/Genymobile/scrcpy/pull/1987#issuecomment-949684080 Load it from a PNG file (SDL only supports bitmap icons).,Use a new scrcpy icon,Use the new icon designed by @varlesh: link Load it from a PNG file (SDL only supports bitmap icons).
833,Add support for palette icon formats,To support more icon formats.,Add support for palette icon formats,To support more icon formats.
834,Add icon loader,Add helper to load icons from image files via FFmpeg.,Add icon loader,Add helper to load icons from image files via FFmpeg.
835,Move common instruction out of ifdef,Both ifdef-branches return server_path.,Move common instruction out of ifdef,Both ifdef-branches return server_path.
836,Extract util function to build a local file path,Finding a local file in the scrcpy directory may be useful for files other than scrcpy-server in the future.,Extract util function to build a local file path,Finding a local file in the scrcpy directory may be useful for files other than scrcpy-server in the future.
837,Fix code style,,Fix code style,
838,"Fix ""Could not find v4l2 muxer""","The AVOutputFormat name is a comma-separated list. In theory, possible names for V4L2 are: - ""video4linux2,v4l2"" - ""v4l2,video4linux2"" - ""v4l2"" - ""video4linux2""  To find the muxer in all cases, we must request exactly one muxer name at a time. PR #2718 https://github.com/Genymobile/scrcpy/pull/2718 Co-authored-by: Romain Vimont rom@rom1v.com Signed-off-by: Romain Vimont rom@rom1v.com","Fix ""Could not find v4l2 muxer""","The AVOutputFormat name is a comma-separated list. In theory, possible names for V4L2 are: - ""video4linux2,v4l2"" - ""v4l2,video4linux2"" - ""v4l2"" - ""video4linux2"" To find the muxer in all cases, we must request exactly one muxer name at a time. PR #2718 link Co-authored-by: Romain Vimont rom@rom1v.com Signed-off-by: Romain Vimont rom@rom1v.com"
839,Simplify net_send_all(),There is no need to declare the variable before the loop.,Simplify net_send_all(),There is no need to declare the variable before the loop.
840,Update Readme.pt-br.md to v1.19,PR #2686 https://github.com/Genymobile/scrcpy/pull/2686 Signed-off-by: Romain Vimont rom@rom1v.com,Update Readme.pt-br.md to v1.19,PR #2686 link Signed-off-by: Romain Vimont rom@rom1v.com
841,Update italian translation to v1.19,PR #2650 https://github.com/Genymobile/scrcpy/pull/2650 Signed-off-by: Romain Vimont rom@rom1v.com,Update italian translation to v1.19,PR #2650 link Signed-off-by: Romain Vimont rom@rom1v.com
842,Fix workarounds for Meizu,"Workarounds.fillAppInfo() is necessary for Meizu devices even before the first call to internalStreamScreen(), but it is harmful on other devices (#940). Therefore, simplify the workaround, by calling fillAppInfo() only if Build.BRAND equals ""meizu"" (case insensitive). Fixes #240 https://github.com/Genymobile/scrcpy/issues/240 (again) Fixes #2656 https://github.com/Genymobile/scrcpy/issues/2656",Fix workarounds for Meizu,"Workarounds.fillAppInfo() is necessary for Meizu devices even before the first call to internalStreamScreen(), but it is harmful on other devices (#940). Therefore, simplify the workaround, by calling fillAppInfo() only if Build.BRAND equals ""meizu"" (case insensitive). Fixes #240 link (again) Fixes #2656 link"
843,Add missing includes,Refs #2616 https://github.com/Genymobile/scrcpy/issues/2616,Add missing includes,Refs #2616 link
844,Fix link in README,,Fix link in README,
845,Add support for expandNotificationsPanel() variant,Some custom vendor ROM added an int as a parameter. Fixes #2551 https://github.com/Genymobile/scrcpy/issues/2551,Add support for expandNotificationsPanel() variant,Some custom vendor ROM added an int as a parameter. Fixes #2551 link
846,Update links to v1.19,,Update links to v1.19,
847,Bump version to 1.19,,Bump version to 1.19,
848,Merge branch 'master' into dev,,Merge branch 'master' into dev,
849,Retrieve correct error messages on Windows,"For sockets functions, Windows does not store error codes in errno, so perror() does not print any error. Use WSAGetLastError() instead. Refs #2624 https://github.com/Genymobile/scrcpy/issues/2624",Retrieve correct error messages on Windows,"For sockets functions, Windows does not store error codes in errno, so perror() does not print any error. Use WSAGetLastError() instead. Refs #2624 link"
850,Compute scrcpy directory manually,The function dirname() does not work correctly everywhere with non-ASCII characters. Fixes #2619 https://github.com/Genymobile/scrcpy/issues/2619,Compute scrcpy directory manually,The function dirname() does not work correctly everywhere with non-ASCII characters. Fixes #2619 link
851,Fix typo in manpage,PR #2606 https://github.com/Genymobile/scrcpy/pull/2606 Signed-off-by: Romain Vimont rom@rom1v.com,Fix typo in manpage,PR #2606 link Signed-off-by: Romain Vimont rom@rom1v.com
852,Use SOURCE_MOUSE for scroll events,"This has no practical impact (AFAIK), but a scroll events should come from a mouse. Refs #2602 https://github.com/Genymobile/scrcpy/issues/2602",Use SOURCE_MOUSE for scroll events,"This has no practical impact (AFAIK), but a scroll events should come from a mouse. Refs #2602 link"
853,Upgrade SDL (2.0.16) for Windows,Include the latest version of SDL in Windows releases. PR #2589 https://github.com/Genymobile/scrcpy/pull/2589 Signed-off-by: Romain Vimont rom@rom1v.com,Upgrade SDL (2.0.16) for Windows,Include the latest version of SDL in Windows releases. PR #2589 link Signed-off-by: Romain Vimont rom@rom1v.com
854,Upgrade platform-tools (31.0.3) for Windows,Include the latest version of adb in Windows releases. PR #2588 https://github.com/Genymobile/scrcpy/pull/2588 Signed-off-by: Romain Vimont rom@rom1v.com,Upgrade platform-tools (31.0.3) for Windows,Include the latest version of adb in Windows releases. PR #2588 link Signed-off-by: Romain Vimont rom@rom1v.com
855,Declare callbacks static,"It was a typo, ""static"" was missing.",Declare callbacks static,"It was a typo, ""static"" was missing."
856,Add Simplified Chinese translation of FAQ,PR #2568 https://github.com/Genymobile/scrcpy/pull/2568 Signed-off-by: Romain Vimont rom@rom1v.com,Add Simplified Chinese translation of FAQ,PR #2568 link Signed-off-by: Romain Vimont rom@rom1v.com
857,Add a FAQ section for Wayland support,The video driver might need to be explicitly set to wayland. Refs #2554 https://github.com/Genymobile/scrcpy/issues/2554 Refs #2559 https://github.com/Genymobile/scrcpy/issues/2559,Add a FAQ section for Wayland support,The video driver might need to be explicitly set to wayland. Refs #2554 link Refs #2559 link
858,Add README file in Turkish,PR #2514 https://github.com/Genymobile/scrcpy/pull/2514 Signed-off-by: Romain Vimont rom@rom1v.com,Add README file in Turkish,PR #2514 link Signed-off-by: Romain Vimont rom@rom1v.com
859,Fix OBS project ref URL,PR #2545 https://github.com/Genymobile/scrcpy/pull/2545 Signed-off-by: Romain Vimont rom@rom1v.com,Fix OBS project ref URL,PR #2545 link Signed-off-by: Romain Vimont rom@rom1v.com
860,Fix typo in DEVELOP.md,PR #2540 https://github.com/Genymobile/scrcpy/pull/2540 Signed-off-by: Romain Vimont rom@rom1v.com,Fix typo in DEVELOP.md,PR #2540 link Signed-off-by: Romain Vimont rom@rom1v.com
861,Fix type for assignment,"The functions net_send_all() and net_recv_all() return ssize_t, not int.",Fix type for assignment,"The functions net_send_all() and net_recv_all() return ssize_t, not int."
862,Fix net_send_all(),"On partial writes, the final result was the number of bytes written by the last send() rather than the total.",Fix net_send_all(),"On partial writes, the final result was the number of bytes written by the last send() rather than the total."
863,Fix code style,Make the code fit into 80 columns.,Fix code style,Make the code fit into 80 columns.
864,Improve slope estimation on start,"The first frames are typically received and decoded with more delay than the others, causing a wrong slope estimation on start. To compensate, assume an initial slope of 1, then progressively use the estimated slope.",Improve slope estimation on start,"The first frames are typically received and decoded with more delay than the others, causing a wrong slope estimation on start. To compensate, assume an initial slope of 1, then progressively use the estimated slope."
865,Add buffering debugging tools,Output buffering and clock logs by disabling a compilation flag.,Add buffering debugging tools,Output buffering and clock logs by disabling a compilation flag.
866,Add clock tests,The clock rolling sum is not trivial. Test it.,Add clock tests,The clock rolling sum is not trivial. Test it.
867,Add buffering command line options,Add --display-buffer and --v4l2-buffer options to configure buffering time.,Add buffering command line options,Add --display-buffer and --v4l2-buffer options to configure buffering time.
868,Implement buffering,"To minimize latency (at the cost of jitter), scrcpy always displays a frame as soon as it available, without waiting. However, when recording (--record), it still writes the captured timestamps to the output file, so that the recorded file can be played correctly without jitter. Some real-time use cases might benefit from adding a small latency to compensate for jitter too. For example, few tens of seconds of latency for live-streaming are not important, but jitter is noticeable. Therefore, implement a buffering mechanism (disabled by default) to add a configurable latency delay. PR #2417 https://github.com/Genymobile/scrcpy/issues/2417",Implement buffering,"To minimize latency (at the cost of jitter), scrcpy always displays a frame as soon as it available, without waiting. However, when recording (--record), it still writes the captured timestamps to the output file, so that the recorded file can be played correctly without jitter. Some real-time use cases might benefit from adding a small latency to compensate for jitter too. For example, few tens of seconds of latency for live-streaming are not important, but jitter is noticeable. Therefore, implement a buffering mechanism (disabled by default) to add a configurable latency delay. PR #2417 link"
869,Notify new frames via callbacks,"Currently, a frame is available to the consumer as soon as it is pushed by the producer (which can detect if the previous frame is skipped). Notify the new frames (and frame skipped) via callbacks instead. This paves the way to add (optional) buffering, which will introduce a delay between the time when the frame is produced and the time it is available to be consumed.",Notify new frames via callbacks,"Currently, a frame is available to the consumer as soon as it is pushed by the producer (which can detect if the previous frame is skipped). Notify the new frames (and frame skipped) via callbacks instead. This paves the way to add (optional) buffering, which will introduce a delay between the time when the frame is produced and the time it is available to be consumed."
870,Extract current video_buffer to frame_buffer,"The current video buffer only stores one pending frame. In order to add a new buffering feature, move this part to a separate ""frame buffer"". Keep the video_buffer, which currently delegates all its calls to the frame_buffer.",Extract current video_buffer to frame_buffer,"The current video buffer only stores one pending frame. In order to add a new buffering feature, move this part to a separate ""frame buffer"". Keep the video_buffer, which currently delegates all its calls to the frame_buffer."
871,Rename video_buffer to sc_video_buffer,Add a scrcpy-specific prefix.,Rename video_buffer to sc_video_buffer,Add a scrcpy-specific prefix.
872,Relax v4l2_sink lock constraints,"To fix a data race, commit 5caeab5f6d12fe0fc69e708a829cfdbec3a401b4 called video_buffer_push() and video_buffer_consume() under the v4l2_sink lock. Instead, use the previous_skipped indication (initialized with video buffer locked) to lock only for protecting the has_frame flag. This enables the possibility for the video_buffer to notify new frames via callbacks without lock inversion issues.",Relax v4l2_sink lock constraints,"To fix a data race, commit 5caeab5f6d12fe0fc69e708a829cfdbec3a401b4 called video_buffer_push() and video_buffer_consume() under the v4l2_sink lock. Instead, use the previous_skipped indication (initialized with video buffer locked) to lock only for protecting the has_frame flag. This enables the possibility for the video_buffer to notify new frames via callbacks without lock inversion issues."
873,Replace delay by deadline in timedwait(),"The function sc_cond_timedwait() accepted a parameter representing the max duration to wait, because it internally uses SDL_CondWaitTimeout(). Instead, accept a deadline, to be consistent with pthread_cond_timedwait().",Replace delay by deadline in timedwait(),"The function sc_cond_timedwait() accepted a parameter representing the max duration to wait, because it internally uses SDL_CondWaitTimeout(). Instead, accept a deadline, to be consistent with pthread_cond_timedwait()."
874,Wrap tick API,"This avoids to use the SDL timer API directly, and will allow to handle generic ticks (possibly negative).",Wrap tick API,"This avoids to use the SDL timer API directly, and will allow to handle generic ticks (possibly negative)."
875,Add missing error log,Log video buffer initialization failure in v4l2_sink.,Add missing error log,Log video buffer initialization failure in v4l2_sink.
876,Move include fps_counter,The fps_counter is not used from video_buffer.,Move include fps_counter,The fps_counter is not used from video_buffer.
877,Remove obsolete comment,"Commit 2a94a2b119a9efd2cd06ded03280872c81abe6b4 removed video_buffer callbacks, the comment is now meaningless.",Remove obsolete comment,"Commit 2a94a2b119a9efd2cd06ded03280872c81abe6b4 removed video_buffer callbacks, the comment is now meaningless."
878,Rename queue to sc_queue,Add a scrcpy-specific prefix.,Rename queue to sc_queue,Add a scrcpy-specific prefix.
879,Fix manpage formatting,,Fix manpage formatting,
880,Fix --lock-video-orientation syntax in help,Commit f76fe2c0d4847d0e40d8708f97591abf3fa22ea5 fixed README and tests. Fix command line help and manpage.,Fix --lock-video-orientation syntax in help,Commit f76fe2c0d4847d0e40d8708f97591abf3fa22ea5 fixed README and tests. Fix command line help and manpage.
881,Remove unnecessary calls to av_packet_unref(),av_packet_free() already calls av_packet_unref().,Remove unnecessary calls to av_packet_unref(),av_packet_free() already calls av_packet_unref().
882,Fix v4l2 data race,"The v4l2_sink implementation directly read the internal video_buffer field ""pending_frame_consumed"", which is protected by the internal video_buffer mutex. But this mutex was not locked, so reads were racy. Lock using the v4l2_sink mutex in addition, and use a separate field to avoid depending on the video_buffer internal data.",Fix v4l2 data race,"The v4l2_sink implementation directly read the internal video_buffer field ""pending_frame_consumed"", which is protected by the internal video_buffer mutex. But this mutex was not locked, so reads were racy. Lock using the v4l2_sink mutex in addition, and use a separate field to avoid depending on the video_buffer internal data."
883,Initialize fields before starting a thread,To avoid data races. Reported by TSAN.,Initialize fields before starting a thread,To avoid data races. Reported by TSAN.
884,Fix assertion race condition in debug mode,"Commit 21d206f360535047e16cc4ea7de889a55bd9444d added mutex assertions. However, the ""locker"" variable to trace the locker thread id was read and written by several threads without any protection, so it was racy. Reported by TSAN.",Fix assertion race condition in debug mode,"Commit 21d206f360535047e16cc4ea7de889a55bd9444d added mutex assertions. However, the ""locker"" variable to trace the locker thread id was read and written by several threads without any protection, so it was racy. Reported by TSAN."
885,Initialize controller even if there is no display,"The options --no-display and --no-control are independent. The controller was not initialized when no display was requested, because it was assumed that no control could occur without display. But that's not true (anymore): for example, it is possible to pass --turn-screen-off. Fixes #2426 https://github.com/Genymobile/scrcpy/issues/2426",Initialize controller even if there is no display,"The options --no-display and --no-control are independent. The controller was not initialized when no display was requested, because it was assumed that no control could occur without display. But that's not true (anymore): for example, it is possible to pass --turn-screen-off. Fixes #2426 link"
886,Update scrcpy-server in install-release.sh,Make the install script download the new prebuilt server (v1.18). Fixes #2409 https://github.com/Genymobile/scrcpy/issues/2409,Update scrcpy-server in install-release.sh,Make the install script download the new prebuilt server (v1.18). Fixes #2409 link
887,Update links to v1.18 in README and BUILD,,Update links to v1.18 in README and BUILD,
888,Bump version to 1.18,Make the versionCode a decimal representation of the scrcpy version. This will for example allow to correctly number the versionCode of v1.17.1 after a v1.18 is released:  - v1.18   -> 11800  - v1.17.1 -> 11701  - v1.18.1 -> 11801,Bump version to 1.18,Make the versionCode a decimal representation of the scrcpy version. This will for example allow to correctly number the versionCode of v1.17.1 after a v1.18 is released:  - v1.18   -> 11800  - v1.17.1 -> 11701  - v1.18.1 -> 11801
889,Upgrade platform-tools (31.0.2) for Windows,Include the latest version of adb in Windows releases.,Upgrade platform-tools (31.0.2) for Windows,Include the latest version of adb in Windows releases.
890,Merge branch 'master' into dev,,Merge branch 'master' into dev,
891,Replace VLA by dynamic allocation,And increase the command buffer size. Refs #1358 https://github.com/Genymobile/scrcpy/issues/1358#issuecomment-862989748 PR #2405 https://github.com/Genymobile/scrcpy/pull/2405 Signed-off-by: Romain Vimont rom@rom1v.com,Replace VLA by dynamic allocation,And increase the command buffer size. Refs #1358 link PR #2405 link Signed-off-by: Romain Vimont rom@rom1v.com
892,Rename cmd to argv,This is more explicit. PR #2405 https://github.com/Genymobile/scrcpy/pull/2405 Signed-off-by: Romain Vimont rom@rom1v.com,Rename cmd to argv,This is more explicit. PR #2405 link Signed-off-by: Romain Vimont rom@rom1v.com
893,Return build_cmd() success via a boolean,For consistency with other functions in the codebase.,Return build_cmd() success via a boolean,For consistency with other functions in the codebase.
894,Suggest --record-format instead of -F on error,"The short option -F has been deprecated by ff061b4f30c54dedc5073a588c6c697477b805db. On error, suggest the long option --record-format instead.",Suggest --record-format instead of -F on error,"The short option -F has been deprecated by ff061b4f30c54dedc5073a588c6c697477b805db. On error, suggest the long option --record-format instead."
895,Attempt to log message only in verbose mode,"If the log level is not verbose, there is no need to attempt to log control messages at all.",Attempt to log message only in verbose mode,"If the log level is not verbose, there is no need to attempt to log control messages at all."
896,Expose function to get the current log level,This will allow to avoid unnecessary processing for creating logs which will be discarded anyway.,Expose function to get the current log level,This will allow to avoid unnecessary processing for creating logs which will be discarded anyway.
897,Move log level conversion to log API,,Move log level conversion to log API,
898,Workaround PRIu64 on Windows,"On Windows, PRIu64 is defined to ""llu"", which is not supported: error: unknown conversion type character 'l' in format",Workaround PRIu64 on Windows,"On Windows, PRIu64 is defined to ""llu"", which is not supported: error: unknown conversion type character 'l' in format"
899,Log control messages in verbose mode,PR #2371 https://github.com/Genymobile/scrcpy/pull/2371 Signed-off-by: Romain Vimont rom@rom1v.com,Log control messages in verbose mode,PR #2371 link Signed-off-by: Romain Vimont rom@rom1v.com
900,Add --verbosity=verbose log level,PR #2371 https://github.com/Genymobile/scrcpy/pull/2371 Signed-off-by: Romain Vimont rom@rom1v.com,Add --verbosity=verbose log level,PR #2371 link Signed-off-by: Romain Vimont rom@rom1v.com
901,Forward mouse motion only on main clicks,"Mouse motion events were forwarded as soon as any mouse button was pressed. Instead, only consider left-click (and also middle-click and right-click if --forward-all-clicks is enabled).",Forward mouse motion only on main clicks,"Mouse motion events were forwarded as soon as any mouse button was pressed. Instead, only consider left-click (and also middle-click and right-click if --forward-all-clicks is enabled)."
902,Remove extra ';' in #define,,Remove extra ';' in #define,
903,Replace strcpy() by memcpy(),"It was safe to call strcpy() since the input length was checked, but then it is more straightforward to call memcpy() directly.",Replace strcpy() by memcpy(),"It was safe to call strcpy() since the input length was checked, but then it is more straightforward to call memcpy() directly."
904,Adapt call() on ContentProvider for Android 12,Android 12 changed one of the call() overloads with a new parameter AttributionSource. Adapt the wrapper. Fixes #2402 https://github.com/Genymobile/scrcpy/issues/2402,Adapt call() on ContentProvider for Android 12,Android 12 changed one of the call() overloads with a new parameter AttributionSource. Adapt the wrapper. Fixes #2402 link
905,Push to /sdcard/Download/ by default,"Change the default push target from /sdcard/ to /sdcard/Download/. Pushing to the root of /sdcard/ is not very convenient, many apps do not expose its content directly. It can still be changed by --push-target. PR #2384 https://github.com/Genymobile/scrcpy/pull/2384",Push to /sdcard/Download/ by default,"Change the default push target from /sdcard/ to /sdcard/Download/. Pushing to the root of /sdcard/ is not very convenient, many apps do not expose its content directly. It can still be changed by --push-target. PR #2384 link"
906,Center the window on resize-to-fit,"When removing the black borders (by double-clicking on them, or by pressing MOD+w), the window is resized to fit the device screen, but its top-left position was left unchanged. Instead, move the window so that the new window area is at the center of the old window area. Refs #2387 https://github.com/Genymobile/scrcpy/issues/2387",Center the window on resize-to-fit,"When removing the black borders (by double-clicking on them, or by pressing MOD+w), the window is resized to fit the device screen, but its top-left position was left unchanged. Instead, move the window so that the new window area is at the center of the old window area. Refs #2387 link"
907,Render screen on window restored,"It should not be necessary, since screen_render() is called just after on SDL_WINDOWEVENT_EXPOSED, but in practice the window content might not be correctly displayed on restored if a rotation occurred while minimized. Note that calling screen_render() twice in a row on SDL_WINDOWEVENT_EXPOSED also ""fixes"" the issue.",Render screen on window restored,"It should not be necessary, since screen_render() is called just after on SDL_WINDOWEVENT_EXPOSED, but in practice the window content might not be correctly displayed on restored if a rotation occurred while minimized. Note that calling screen_render() twice in a row on SDL_WINDOWEVENT_EXPOSED also ""fixes"" the issue."
908,Allocate AVPacket for v4l2_sink,"From FFmpeg/doc/APIchanges: 2021-03-17 - f7db77bd87 - lavc 58.133.100 - codec.h   Deprecated av_init_packet(). Once removed, sizeof(AVPacket) will   no longer be a part of the public ABI.  Refs #2302 https://github.com/Genymobile/scrcpy/issues/2302",Allocate AVPacket for v4l2_sink,"From FFmpeg/doc/APIchanges: 2021-03-17 - f7db77bd87 - lavc 58.133.100 - codec.h   Deprecated av_init_packet(). Once removed, sizeof(AVPacket) will   no longer be a part of the public ABI. Refs #2302 link"
909,Allocate AVPacket for recorder,"From FFmpeg/doc/APIchanges: 2021-03-17 - f7db77bd87 - lavc 58.133.100 - codec.h   Deprecated av_init_packet(). Once removed, sizeof(AVPacket) will   no longer be a part of the public ABI.  Refs #2302 https://github.com/Genymobile/scrcpy/issues/2302",Allocate AVPacket for recorder,"From FFmpeg/doc/APIchanges: 2021-03-17 - f7db77bd87 - lavc 58.133.100 - codec.h   Deprecated av_init_packet(). Once removed, sizeof(AVPacket) will   no longer be a part of the public ABI. Refs #2302 link"
910,Allocate AVPacket for local stream packet,"From FFmpeg/doc/APIchanges: 2021-03-17 - f7db77bd87 - lavc 58.133.100 - codec.h   Deprecated av_init_packet(). Once removed, sizeof(AVPacket) will   no longer be a part of the public ABI.  Refs #2302 https://github.com/Genymobile/scrcpy/issues/2302",Allocate AVPacket for local stream packet,"From FFmpeg/doc/APIchanges: 2021-03-17 - f7db77bd87 - lavc 58.133.100 - codec.h   Deprecated av_init_packet(). Once removed, sizeof(AVPacket) will   no longer be a part of the public ABI. Refs #2302 link"
911,Allocate AVPacket for stream->pending,"From FFmpeg/doc/APIchanges: 2021-03-17 - f7db77bd87 - lavc 58.133.100 - codec.h   Deprecated av_init_packet(). Once removed, sizeof(AVPacket) will   no longer be a part of the public ABI.  Remove the has_pending boolean, which can be replaced by: stream->pending != NULL  Refs #2302 https://github.com/Genymobile/scrcpy/issues/2302",Allocate AVPacket for stream->pending,"From FFmpeg/doc/APIchanges: 2021-03-17 - f7db77bd87 - lavc 58.133.100 - codec.h   Deprecated av_init_packet(). Once removed, sizeof(AVPacket) will   no longer be a part of the public ABI. Remove the has_pending boolean, which can be replaced by: stream->pending != NULL Refs #2302 link"
912,Clarify --no-display usage with v4l2,,Clarify --no-display usage with v4l2,
913,Fix compatibility with old FFmpeg,"V4L2 sink used a ""url"" field format AVFormatContext which has been introduced in lavf 58.7.100. Fixes #2382 https://github.com/Genymobile/scrcpy/issues/2382 Refs https://github.com/FFmpeg/FFmpeg/commit/ea3672b7d67c432724bdbc8de0221f869b6a04c6 Refs https://github.com/FFmpeg/FFmpeg/commit/fa8308d3d4f27d6fb38ac2069887a7b259f1c6ab",Fix compatibility with old FFmpeg,"V4L2 sink used a ""url"" field format AVFormatContext which has been introduced in lavf 58.7.100. Fixes #2382 link Refs link Refs link"
914,Fix --lock-video-orientation syntax,"The argument for option --lock-video-orientation has been made optional by 5af9d0ee0faddfca689f468c7d463c86233e8d93. With getopt_long(), contrary to mandatory arguments, optional arguments must be given with a '=': --lock-video-orientation 2   # wrong, parse error --lock-video-orientation=2   # correct",Fix --lock-video-orientation syntax,"The argument for option --lock-video-orientation has been made optional by 5af9d0ee0faddfca689f468c7d463c86233e8d93. With getopt_long(), contrary to mandatory arguments, optional arguments must be given with a '=': --lock-video-orientation 2   # wrong, parse error --lock-video-orientation=2   # correct"
915,Use non-secure display for Android 12 preview,"Android 12 preview identifies as Android 11, but its codename is ""S"". Refs #2129 https://github.com/Genymobile/scrcpy/issues/2129",Use non-secure display for Android 12 preview,"Android 12 preview identifies as Android 11, but its codename is ""S"". Refs #2129 link"
916,Use non-secure display for Android >= 12,"Since Android 12, secure displays could not be created with shell permissions anymore. Refs commit 1fdde490fd2a0b89680a2b5da5e5274192398023 Fixes #2129 https://github.com/Genymobile/scrcpy/issues/2129",Use non-secure display for Android >= 12,"Since Android 12, secure displays could not be created with shell permissions anymore. Refs commit 1fdde490fd2a0b89680a2b5da5e5274192398023 Fixes #2129 link"
917,Serialize clean-up configuration,"This avoids to pass each option as individual parameter and parse them manually (it's still ""manual"" in the Parcelable implementation). Refs #824 https://github.com/Genymobile/scrcpy/pull/824#issuecomment-780319422 Reviewed-by: Yu-Chen Lin npes87184@gmail.com",Serialize clean-up configuration,"This avoids to pass each option as individual parameter and parse them manually (it's still ""manual"" in the Parcelable implementation). Refs #824 link Reviewed-by: Yu-Chen Lin npes87184@gmail.com"
918,Group components into struct scrcpy,This avoids to refer to many structs globally.,Group components into struct scrcpy,This avoids to refer to many structs globally.
919,Explicitly initialize decoder sink_count,The zero-initialization relied on the fact that the decoder instance is static.,Explicitly initialize decoder sink_count,The zero-initialization relied on the fact that the decoder instance is static.
920,Pass serial within struct server_params,This was the only option passed separately.,Pass serial within struct server_params,This was the only option passed separately.
921,Translate README.md into Spanish,PR #2318 https://github.com/Genymobile/scrcpy/pull/2318 Signed-off-by: Romain Vimont rom@rom1v.com,Translate README.md into Spanish,PR #2318 link Signed-off-by: Romain Vimont rom@rom1v.com
922,FAQ in Italian,PR #2316 https://github.com/Genymobile/scrcpy/pull/2316 Signed-off-by: Romain Vimont rom@rom1v.com,FAQ in Italian,PR #2316 link Signed-off-by: Romain Vimont rom@rom1v.com
923,README in Italian,PR #2316 https://github.com/Genymobile/scrcpy/pull/2316 Signed-off-by: Romain Vimont rom@rom1v.com,README in Italian,PR #2316 link Signed-off-by: Romain Vimont rom@rom1v.com
924,Reference translations from FAQ.md,,Reference translations from FAQ.md,
925,Fix syntax highlighting in README,,Fix syntax highlighting in README,
926,Provide device info directly on server connection,This avoids to retrieve them in a separate step.,Provide device info directly on server connection,This avoids to retrieve them in a separate step.
927,Initialize input manager dynamically,"The input manager was partially initialized statically, but a call to input_manager_init() was needed anyway, so initialize all the fields from the ""constructor"". This is consistent with the initialization of the other structs.",Initialize input manager dynamically,"The input manager was partially initialized statically, but a call to input_manager_init() was needed anyway, so initialize all the fields from the ""constructor"". This is consistent with the initialization of the other structs."
928,Factorize screen_init() error management,,Factorize screen_init() error management,
929,Move fps_counter to screen,"The FPS counter specifically count frames from the screen video buffer, so it is specific to the screen.",Move fps_counter to screen,"The FPS counter specifically count frames from the screen video buffer, so it is specific to the screen."
930,Fix leak on error,Destroy video buffer if screen window creation failed.,Fix leak on error,Destroy video buffer if screen window creation failed.
931,Notify end-of-stream via callback,"Do not send a SDL event directly, to make stream independent of SDL.",Notify end-of-stream via callback,"Do not send a SDL event directly, to make stream independent of SDL."
932,Fix visualization of comment in code block,PR #2315 https://github.com/Genymobile/scrcpy/pull/2315 Signed-off-by: Romain Vimont rom@rom1v.com,Fix visualization of comment in code block,PR #2315 link Signed-off-by: Romain Vimont rom@rom1v.com
933,Reformat README.ko.md,PR #2311 https://github.com/Genymobile/scrcpy/pull/2311 Signed-off-by: Romain Vimont rom@rom1v.com,Reformat README.ko.md,PR #2311 link Signed-off-by: Romain Vimont rom@rom1v.com
934,Use ARRAY_LEN() macro,,Use ARRAY_LEN() macro,
935,Add libavdevice-dev in BUILD instructions,"On Linux, scrcpy now depends on libavdevice for v4l2.",Add libavdevice-dev in BUILD instructions,"On Linux, scrcpy now depends on libavdevice for v4l2."
936,Merge branch 'master' into dev,,Merge branch 'master' into dev,
937,Add MacPorts documentation,PR #2299 https://github.com/Genymobile/scrcpy/pull/2299 Signed-off-by: Romain Vimont rom@rom1v.com,Add MacPorts documentation,PR #2299 link Signed-off-by: Romain Vimont rom@rom1v.com
938,Fix double-free on error,"On error, server->serial was freed twice: immediately and in server_destroy(). Refs #2292 https://github.com/Genymobile/scrcpy/issues/2292#issuecomment-831424820",Fix double-free on error,"On error, server->serial was freed twice: immediately and in server_destroy(). Refs #2292 link"
939,Rename keycode injection method,"Make it explicit that it injects both ""press"" and ""release"" events.",Rename keycode injection method,"Make it explicit that it injects both ""press"" and ""release"" events."
940,Simplify non-static injectEvent() implementation,Just call the static version (having a displayId) from the non-static version (using the displayId field).,Simplify non-static injectEvent() implementation,Just call the static version (having a displayId) from the non-static version (using the displayId field).
941,Simplify Device.java,"Remove useless intermediate method with a ""mode"" parameter (it's always called with the same mode). This also avoids the need for a specific injectEventOnDisplay() method, since it does not conflict with another injectEvent() method anymore.",Simplify Device.java,"Remove useless intermediate method with a ""mode"" parameter (it's always called with the same mode). This also avoids the need for a specific injectEventOnDisplay() method, since it does not conflict with another injectEvent() method anymore."
942,Unref decoder AVFrame immediately,"The frame can be unref immediately after it is pushed to the frame sinks. It was not really a memory leak because the frame was unref every time by avcodec_receive_frame() (and freed on close), but a reference was unnecessarily kept for too long.",Unref decoder AVFrame immediately,"The frame can be unref immediately after it is pushed to the frame sinks. It was not really a memory leak because the frame was unref every time by avcodec_receive_frame() (and freed on close), but a reference was unnecessarily kept for too long."
943,Fix v4l2 AVPacket memory leak on error,Unref v4l2 AVPacket even if writing failed.,Fix v4l2 AVPacket memory leak on error,Unref v4l2 AVPacket even if writing failed.
944,Fix v4l2 AVFrame memory leak,Unref frame immediately once encoded. Fixes #2279 https://github.com/Genymobile/scrcpy/pull/2279,Fix v4l2 AVFrame memory leak,Unref frame immediately once encoded. Fixes #2279 link
945,Rename --v4l2_sink to --v4l2-sink,"This was a rebase issue, the previous version in #2268 was correct. Refs #2268 https://github.com/Genymobile/scrcpy/pull/2268",Rename --v4l2_sink to --v4l2-sink,"This was a rebase issue, the previous version in #2268 was correct. Refs #2268 link"
946,Document v4l2 sink in README,,Document v4l2 sink in README,
947,Add support for v4l2loopback,"It allows to send the video stream to /dev/videoN, so that it can be captured (like a webcam) by any v4l2-capable tool. PR #2232 https://github.com/Genymobile/scrcpy/pull/2232 PR #2233 https://github.com/Genymobile/scrcpy/pull/2233 PR #2268 https://github.com/Genymobile/scrcpy/pull/2268 Co-authored-by: Romain Vimont rom@rom1v.com",Add support for v4l2loopback,"It allows to send the video stream to /dev/videoN, so that it can be captured (like a webcam) by any v4l2-capable tool. PR #2232 link PR #2233 link PR #2268 link Co-authored-by: Romain Vimont rom@rom1v.com"
948,Make --lock-video-orientation argument optional,"If the option is set without argument, lock the initial device orientation (as if the value ""initial"" was passed).",Make --lock-video-orientation argument optional,"If the option is set without argument, lock the initial device orientation (as if the value ""initial"" was passed)."
949,Add --lock-video-orientation=initial,"Add a new mode to the --lock-video-orientation option, to lock the initial orientation of the device. This avoids to pass an explicit value (0, 1, 2 or 3) and think about which is the right one.",Add --lock-video-orientation=initial,"Add a new mode to the --lock-video-orientation option, to lock the initial orientation of the device. This avoids to pass an explicit value (0, 1, 2 or 3) and think about which is the right one."
950,Use strlist_contains() to find a muxer,"The AVOutputFormat name is a string list: it contains names separated by ',' (possibly only one).",Use strlist_contains() to find a muxer,"The AVOutputFormat name is a string list: it contains names separated by ',' (possibly only one)."
951,Add strlist_contains(),"Add a function to know if a string list, using some separator, contains a specific string.",Add strlist_contains(),"Add a function to know if a string list, using some separator, contains a specific string."
952,Fix recorder comment,,Fix recorder comment,
953,Handle EAGAIN on send_packet in decoder,"EAGAIN was only handled on receive_frame. In practice, it should not be necessary, since one packet always contains one frame. But just in case.",Handle EAGAIN on send_packet in decoder,"EAGAIN was only handled on receive_frame. In practice, it should not be necessary, since one packet always contains one frame. But just in case."
954,Handle errors using gotos in recorder_open(),There are many initializations in recorder_open(). Handle RAII-like deinitialization using gotos.,Handle errors using gotos in recorder_open(),There are many initializations in recorder_open(). Handle RAII-like deinitialization using gotos.
955,Initialize recorder fields on open,Only initialize ops and parameters copy from recorder_init(). It was inconsistent to initialize some fields from _init() and some others from _open().,Initialize recorder fields on open,Only initialize ops and parameters copy from recorder_init(). It was inconsistent to initialize some fields from _init() and some others from _open().
956,Hide the window immediately on close,"The screen may not be destroyed immediately on close to avoid undefined behavior, because it may still receive events from the decoder. But the visual window must still be closed immediately.",Hide the window immediately on close,"The screen may not be destroyed immediately on close to avoid undefined behavior, because it may still receive events from the decoder. But the visual window must still be closed immediately."
957,Assert screen closed on destroy,"The destruction order is important, but tricky, because the screen is open/close by the decoder, but destroyed by scrcpy.c on the main thread. Add assertions to guarantee that the screen is not destroyed before being closed.",Assert screen closed on destroy,"The destruction order is important, but tricky, because the screen is open/close by the decoder, but destroyed by scrcpy.c on the main thread. Add assertions to guarantee that the screen is not destroyed before being closed."
958,Remove video_buffer callbacks,"Now that screen is both the owner and the listener of the video buffer, execute the code directly without callbacks.",Remove video_buffer callbacks,"Now that screen is both the owner and the listener of the video buffer, execute the code directly without callbacks."
959,Move video_buffer to screen,"The video buffer is now an internal detail of the screen component. Since the screen is plugged to the decoder via the frame sink trait, the decoder does not access to the video buffer anymore.",Move video_buffer to screen,"The video buffer is now an internal detail of the screen component. Since the screen is plugged to the decoder via the frame sink trait, the decoder does not access to the video buffer anymore."
960,Make decoder push frames to sinks,"Now that screen implements the packet sink trait, make decoder push packets to the sinks without depending on the concrete sink types.",Make decoder push frames to sinks,"Now that screen implements the packet sink trait, make decoder push packets to the sinks without depending on the concrete sink types."
961,Expose screen as frame sink,Make screen implement the frame sink trait. This will allow the decoder to push frames without depending on the concrete sink type.,Expose screen as frame sink,Make screen implement the frame sink trait. This will allow the decoder to push frames without depending on the concrete sink type.
962,Add frame sink trait,This trait will allow to abstract the concrete sink types from the frame producer (decoder.c).,Add frame sink trait,This trait will allow to abstract the concrete sink types from the frame producer (decoder.c).
963,Make stream push packets to sinks,"Now that decoder and recorder implement the packet sink trait, make stream push packets to the sinks without depending on the concrete sink types.",Make stream push packets to sinks,"Now that decoder and recorder implement the packet sink trait, make stream push packets to the sinks without depending on the concrete sink types."
964,Expose decoder as packet sink,Make decoder implement the packet sink trait. This will allow the stream to push packets without depending on the concrete sink type.,Expose decoder as packet sink,Make decoder implement the packet sink trait. This will allow the stream to push packets without depending on the concrete sink type.
965,Reorder decoder functions,This will make further commits more readable.,Reorder decoder functions,This will make further commits more readable.
966,Expose recorder as packet sink,Make recorder implement the packet sink trait. This will allow the stream to push packets without depending on the concrete sink type.,Expose recorder as packet sink,Make recorder implement the packet sink trait. This will allow the stream to push packets without depending on the concrete sink type.
967,Privatize recorder threading,"The fact that the recorder uses a separate thread is an internal detail, so the functions _start(), _stop() and _join() should not be exposed. Instead, start the thread on _open() and _stop()+_join() on close(). This paves the way to expose the recorder as a packet sink trait.",Privatize recorder threading,"The fact that the recorder uses a separate thread is an internal detail, so the functions _start(), _stop() and _join() should not be exposed. Instead, start the thread on _open() and _stop()+_join() on close(). This paves the way to expose the recorder as a packet sink trait."
968,Reorder recorder functions,This will make further commits more readable.,Reorder recorder functions,This will make further commits more readable.
969,Add packet sink trait,This trait will allow to abstract the concrete sink types from the packet producer (stream.c).,Add packet sink trait,This trait will allow to abstract the concrete sink types from the packet producer (stream.c).
970,Add container_of() macro,This will allow to get the parent of an embedded struct.,Add container_of() macro,This will allow to get the parent of an embedded struct.
971,Make video_buffer more generic,"The video buffer took ownership of the producer frame (so that it could swap frames quickly). In order to support multiple sinks plugged to the decoder, the decoded frame must not be consumed by the display video buffer. Therefore, move the producer and consumer frames out of the video buffer, and use FFmpeg AVFrame refcounting to share ownership while avoiding copies.",Make video_buffer more generic,"The video buffer took ownership of the producer frame (so that it could swap frames quickly). In order to support multiple sinks plugged to the decoder, the decoded frame must not be consumed by the display video buffer. Therefore, move the producer and consumer frames out of the video buffer, and use FFmpeg AVFrame refcounting to share ownership while avoiding copies."
972,Remove compat with old FFmpeg codec params API,"The new API has been introduced in 2016 in libavformat 57.xx, it's very old. This will avoid to maintain two code paths for codec parameters.",Remove compat with old FFmpeg codec params API,"The new API has been introduced in 2016 in libavformat 57.xx, it's very old. This will avoid to maintain two code paths for codec parameters."
973,Remove compat with old FFmpeg decoding API,"The new API has been introduced in 2016 in libavcodec 57.xx, it's very old. This will avoid to maintain two code paths for decoding.",Remove compat with old FFmpeg decoding API,"The new API has been introduced in 2016 in libavcodec 57.xx, it's very old. This will avoid to maintain two code paths for decoding."
974,Remove option --render-expired-frames,"This flag forced the decoder to wait for the previous frame to be consumed by the display. It was initially implemented as a compilation flag for testing, not intended to be exposed at runtime. But to remove ifdefs and to allow users to test this flag easily, it had finally been exposed by commit ebccb9f6cc111e8acfbe10d656cac5c1f1b744a0. In practice, it turned out to be useless: it had no practical impact, and it did not solve or mitigate any performance issues causing frame skipping. But that added some complexity to the codebase: it required an additional condition variable, and made video buffer calls possibly blocking, which in turn required code to interrupt it on exit. To prepare support for multiple sinks plugged to the decoder (display and v4l2 for example), the blocking call used for pacing the decoder output becomes unacceptable, so just remove this useless ""feature"".",Remove option --render-expired-frames,"This flag forced the decoder to wait for the previous frame to be consumed by the display. It was initially implemented as a compilation flag for testing, not intended to be exposed at runtime. But to remove ifdefs and to allow users to test this flag easily, it had finally been exposed by commit ebccb9f6cc111e8acfbe10d656cac5c1f1b744a0. In practice, it turned out to be useless: it had no practical impact, and it did not solve or mitigate any performance issues causing frame skipping. But that added some complexity to the codebase: it required an additional condition variable, and made video buffer calls possibly blocking, which in turn required code to interrupt it on exit. To prepare support for multiple sinks plugged to the decoder (display and v4l2 for example), the blocking call used for pacing the decoder output becomes unacceptable, so just remove this useless ""feature""."
975,Write trailer from recorder thread,"The recorder thread wrote the whole content except the trailer, which was odd.",Write trailer from recorder thread,"The recorder thread wrote the whole content except the trailer, which was odd."
976,Document 4th+5th + 2xn shortcuts,PR #2260 https://github.com/Genymobile/scrcpy/pull/2260 Signed-off-by: Romain Vimont rom@rom1v.com,Document 4th+5th + 2xn shortcuts,PR #2260 link Signed-off-by: Romain Vimont rom@rom1v.com
977,Add mouse shortcut to expand settings panel,Double-click on extra mouse button to open the settings panel (a single-click opens the notification panel). This is consistent with the keyboard shortcut MOD+n+n. PR #2264 https://github.com/Genymobile/scrcpy/pull/2264 Signed-off-by: Romain Vimont rom@rom1v.com,Add mouse shortcut to expand settings panel,Double-click on extra mouse button to open the settings panel (a single-click opens the notification panel). This is consistent with the keyboard shortcut MOD+n+n. PR #2264 link Signed-off-by: Romain Vimont rom@rom1v.com
978,Add keyboard shortcut to expand settings panel,PR #2260 https://github.com/Genymobile/scrcpy/pull/2260 Signed-off-by: Romain Vimont rom@rom1v.com,Add keyboard shortcut to expand settings panel,PR #2260 link Signed-off-by: Romain Vimont rom@rom1v.com
979,Add control message to expand settings panel,PR #2260 https://github.com/Genymobile/scrcpy/pull/2260 Signed-off-by: Romain Vimont rom@rom1v.com,Add control message to expand settings panel,PR #2260 link Signed-off-by: Romain Vimont rom@rom1v.com
980,Count repeated identical key events,This will allow shortcuts such as MOD+n+n to open the settings panel. PR #2260 https://github.com/Genymobile/scrcpy/pull/2260 Signed-off-by: Romain Vimont rom@rom1v.com,Count repeated identical key events,This will allow shortcuts such as MOD+n+n to open the settings panel. PR #2260 link Signed-off-by: Romain Vimont rom@rom1v.com
981,Rename control message type to COLLAPSE_PANELS,"The collapsing action collapses any panels. By the way, the Android method is named collapsePanels(). PR #2260 https://github.com/Genymobile/scrcpy/pull/2260 Signed-off-by: Romain Vimont rom@rom1v.com",Rename control message type to COLLAPSE_PANELS,"The collapsing action collapses any panels. By the way, the Android method is named collapsePanels(). PR #2260 link Signed-off-by: Romain Vimont rom@rom1v.com"
982,Reverse boolean logic for readability,Refs #2260 https://github.com/Genymobile/scrcpy/pull/2260#issuecomment-823508759,Reverse boolean logic for readability,Refs #2260 link
983,Ensure get_server_path() retval is freeable,PR #2276 https://github.com/Genymobile/scrcpy/pull/2276 Signed-off-by: Romain Vimont rom@rom1v.com,Ensure get_server_path() retval is freeable,PR #2276 link Signed-off-by: Romain Vimont rom@rom1v.com
984,Provide actions for the extra mouse buttons,Bind APP_SWITCH to button 4 and expand notification panel on button 5. PR #2258 https://github.com/Genymobile/scrcpy/pull/2258 Signed-off-by: Romain Vimont rom@rom1v.com,Provide actions for the extra mouse buttons,Bind APP_SWITCH to button 4 and expand notification panel on button 5. PR #2258 link Signed-off-by: Romain Vimont rom@rom1v.com
985,Forward DOWN and UP separately for right-click,"The shortcut ""back on screen on"" is a bit special: the control is requested by the client, but the actual event injection (POWER or BACK) is determined on the device. To properly inject DOWN and UP events for BACK, transmit the action as a control parameter. If the screen is off:  - on DOWN, inject POWER (DOWN and UP) (wake up the device immediately)  - on UP, do nothing If the screen is on:  - on DOWN, inject BACK DOWN  - on UP, inject BACK UP A corner case is when the screen turns off between the DOWN and UP event. In that case, a BACK UP event will be injected, so it's harmless. As a consequence of this change, the BACK button is now handled by Android on mouse released. This is consistent with the keyboard shortcut (Mod+b) behavior. PR #2259 https://github.com/Genymobile/scrcpy/pull/2259 Refs #2258 https://github.com/Genymobile/scrcpy/pull/2258",Forward DOWN and UP separately for right-click,"The shortcut ""back on screen on"" is a bit special: the control is requested by the client, but the actual event injection (POWER or BACK) is determined on the device. To properly inject DOWN and UP events for BACK, transmit the action as a control parameter. If the screen is off:  - on DOWN, inject POWER (DOWN and UP) (wake up the device immediately)  - on UP, do nothing If the screen is on:  - on DOWN, inject BACK DOWN  - on UP, inject BACK UP A corner case is when the screen turns off between the DOWN and UP event. In that case, a BACK UP event will be injected, so it's harmless. As a consequence of this change, the BACK button is now handled by Android on mouse released. This is consistent with the keyboard shortcut (Mod+b) behavior. PR #2259 link Refs #2258 link"
986,Fix typos,PR #2263 https://github.com/Genymobile/scrcpy/pull/2263 Signed-off-by: Romain Vimont rom@rom1v.com,Fix typos,PR #2263 link Signed-off-by: Romain Vimont rom@rom1v.com
987,Forward DOWN and UP separately for middle-click,"As a consequence of this change, the HOME button is now handled by Android on mouse released. This is consistent with the keyboard shortcut (MOD+h) behavior. PR #2259 https://github.com/Genymobile/scrcpy/pull/2259 Refs #2258 https://github.com/Genymobile/scrcpy/pull/2258",Forward DOWN and UP separately for middle-click,"As a consequence of this change, the HOME button is now handled by Android on mouse released. This is consistent with the keyboard shortcut (MOD+h) behavior. PR #2259 link Refs #2258 link"
988,"Prevent forwarding only ""mouse released"" events","Some mouse clicks DOWN are captured for shortcuts, but the matching UP events were still forwarded to the device. Instead, capture both DOWN and UP for shortcuts, and do nothing on UP. PR #2259 https://github.com/Genymobile/scrcpy/pull/2259 Refs #2258 https://github.com/Genymobile/scrcpy/pull/2258","Prevent forwarding only ""mouse released"" events","Some mouse clicks DOWN are captured for shortcuts, but the matching UP events were still forwarded to the device. Instead, capture both DOWN and UP for shortcuts, and do nothing on UP. PR #2259 link Refs #2258 link"
989,Fix options alphabetical order,"""verbosity"" < ""version""",Fix options alphabetical order,"""verbosity"" < ""version"""
990,Do not forward SDL_DROPFILE event,"The event is handled by scrcpy.c, it is not necessary to send it to screen or input_manager.",Do not forward SDL_DROPFILE event,"The event is handled by scrcpy.c, it is not necessary to send it to screen or input_manager."
991,Move resizing workaround to screen.c,,Move resizing workaround to screen.c,
992,Set initial fullscreen from screen.c,,Set initial fullscreen from screen.c,
993,Make screen_show_window() static,It is only used from screen.c now.,Make screen_show_window() static,It is only used from screen.c now.
994,Destroy screen once stream is finished,"The screen receives callbacks from the decoder, fed by the stream. The decoder is run from the stream thread, so waiting for the end of stream is sufficient to avoid possible use-after-destroy.",Destroy screen once stream is finished,"The screen receives callbacks from the decoder, fed by the stream. The decoder is run from the stream thread, so waiting for the end of stream is sufficient to avoid possible use-after-destroy."
995,Do not destroy uninitialized screen,"When --no-display was passed, screen_destroy() was called while screen_init() was never called. In practice, it did not crash because it just freed NULL pointers, but it was still incorrect.",Do not destroy uninitialized screen,"When --no-display was passed, screen_destroy() was called while screen_init() was never called. In practice, it did not crash because it just freed NULL pointers, but it was still incorrect."
996,Make internal recorder function static,,Make internal recorder function static,
997,Remove unused field from input_manager,,Remove unused field from input_manager,
998,Remove useless forward declaration from stream.h,,Remove useless forward declaration from stream.h,
999,Remove useless includes from decoder.c,,Remove useless includes from decoder.c,
1000,Fix typo in command-line help,Refs #2237 https://github.com/Genymobile/scrcpy/issues/2237,Fix typo in command-line help,Refs #2237 link
1001,Fix compilation error for old decoding API,Commits cb9c42bdcb198b0e3ebed893e00257b95f4dcedb and 441d3fb119ce05287e94b0ae0befbb2e75173688 updated the code only for the new decoding API.,Fix compilation error for old decoding API,Commits cb9c42bdcb198b0e3ebed893e00257b95f4dcedb and 441d3fb119ce05287e94b0ae0befbb2e75173688 updated the code only for the new decoding API.
1002,Remove HiDPI compilation flag,"Always enable HiDPI support, there is no reason to expose a compilation flag.",Remove HiDPI compilation flag,"Always enable HiDPI support, there is no reason to expose a compilation flag."
1003,Update brew java version to JDK 11,Refs f8524a2be738e6471ed2e48265f2663d8c21c0be Refs 7b51a0313ed9423f9252108fa573af68c11e6a2c,Update brew java version to JDK 11,Refs f8524a2be738e6471ed2e48265f2663d8c21c0be Refs 7b51a0313ed9423f9252108fa573af68c11e6a2c
1004,Update brew cask documentation,The command brew cask has been deprecated: https://github.com/Homebrew/discussions/discussions/340#discussioncomment-232364 Should be brew install directly now. PR #2231 https://github.com/Genymobile/scrcpy/pull/2231 Signed-off-by: Romain Vimont rom@rom1v.com,Update brew cask documentation,The command brew cask has been deprecated: link Should be brew install directly now. PR #2231 link Signed-off-by: Romain Vimont rom@rom1v.com
1005,Add instructions to uninstall,,Add instructions to uninstall,
1006,Add simplified installation script,Add a script to download the server and build scrcpy using the prebuilt server.,Add simplified installation script,Add a script to download the server and build scrcpy using the prebuilt server.
1007,Clarify the order of operations in BUILD.md,PR #2223 https://github.com/Genymobile/scrcpy/pull/2223 Signed-off-by: Romain Vimont rom@rom1v.com,Clarify the order of operations in BUILD.md,PR #2223 link Signed-off-by: Romain Vimont rom@rom1v.com
1008,Fix BUILD.md line wrapping,,Fix BUILD.md line wrapping,
1009,Fix typo in BUILD.md,,Fix typo in BUILD.md,
1010,Link release to main README in translations,This avoids to link an older version.,Link release to main README in translations,This avoids to link an older version.
1011,Add Japanese translation for README.md,PR #2195 https://github.com/Genymobile/scrcpy/pull/2195 Signed-off-by: Romain Vimont rom@rom1v.com,Add Japanese translation for README.md,PR #2195 link Signed-off-by: Romain Vimont rom@rom1v.com
1012,Improve --push-target example in README,A common use case for the --push-target option is to pass the device Download directory.,Improve --push-target example in README,A common use case for the --push-target option is to pass the device Download directory.
1013,Fix typo in README,Refs https://github.com/Genymobile/scrcpy/pull/2195#discussion_r595664697,Fix typo in README,Refs link
1014,"Add ""Get the app"" summary section",Give quick instructions to download/install scrcpy.,"Add ""Get the app"" summary section",Give quick instructions to download/install scrcpy.
1015,Support power off on close,PR #824 https://github.com/Genymobile/scrcpy/pull/824 Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com,Support power off on close,PR #824 link Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com
1016,Export static method to power off screen in Device,PR #824 https://github.com/Genymobile/scrcpy/pull/824 Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com,Export static method to power off screen in Device,PR #824 link Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com
1017,Pass scrcpy-noconsole arguments through to scrcpy,PR #2052 https://github.com/Genymobile/scrcpy/pull/2052 Signed-off-by: Romain Vimont rom@rom1v.com,Pass scrcpy-noconsole arguments through to scrcpy,PR #2052 link Signed-off-by: Romain Vimont rom@rom1v.com
1018,Do not set buttons on touch events,BUTTON_PRIMARY must not be set for touch events:  This button constant is not set in response to simple touches with a finger or stylus tip. The user must actually push a button.  https://developer.android.com/reference/android/view/MotionEvent#BUTTON_PRIMARY Fixes #2169 https://github.com/Genymobile/scrcpy/issues/2169,Do not set buttons on touch events,BUTTON_PRIMARY must not be set for touch events: This button constant is not set in response to simple touches with a finger or stylus tip. The user must actually push a button. link Fixes #2169 link
1019,Use device id 0 for touch/mouse events,"Virtual device is only for keyboard sources, not mouse or touchscreen sources. Here is the value of InputDevice.getDevice(-1).toString(): Input Device -1: Virtual   Descriptor: ...   Generation: 2   Location: built-in   Keyboard Type: alphabetic   Has Vibrator: false   Has mic: false   Sources: 0x301 ( keyboard dpad )  InputDevice.getDeviceId() documentation says:  An id of zero indicates that the event didn't come from a physical device and maps to the default keymap.  https://developer.android.com/reference/android/view/InputEvent#getDeviceId() However, injecting events with a device id of 0 causes event.getDevice() to be null on the client-side. Commit 26529d377fe8aae2fd1ffa91405aa801a0ce8a57 used -1 as a workaround to avoid a NPE on a specific Android TV device. But this is a bug in the device system, which wrongly assumes that input device may not be null. A similar issue was present in Flutter, but it is now fixed:  - https://github.com/flutter/flutter/issues/30665  - https://github.com/flutter/engine/pull/7986 On the other hand, using an id of -1 for touchscreen events (which is invalid) causes issues for some apps: https://github.com/Genymobile/scrcpy/issues/2125#issuecomment-790535792 Therefore, use a device id of 0. An alternative could be to find an existing device matching the source, like ""adb shell input"" does. See getInputDeviceId(): https://android.googlesource.com/platform/frameworks/base.git/+/master/cmds/input/src/com/android/commands/input/Input.java But it seems better to indicate that the event didn't come from a physical device, and it would not solve #962 anyway, because an Android TV has no touchscreen. Refs #962 https://github.com/Genymobile/scrcpy/issues/962 Fixes #2125 https://github.com/Genymobile/scrcpy/issues/2125",Use device id 0 for touch/mouse events,"Virtual device is only for keyboard sources, not mouse or touchscreen sources. Here is the value of InputDevice.getDevice(-1).toString(): Input Device -1: Virtual   Descriptor: ...   Generation: 2   Location: built-in   Keyboard Type: alphabetic   Has Vibrator: false   Has mic: false   Sources: 0x301 ( keyboard dpad ) InputDevice.getDeviceId() documentation says: An id of zero indicates that the event didn't come from a physical device and maps to the default keymap. link() However, injecting events with a device id of 0 causes event.getDevice() to be null on the client-side. Commit 26529d377fe8aae2fd1ffa91405aa801a0ce8a57 used -1 as a workaround to avoid a NPE on a specific Android TV device. But this is a bug in the device system, which wrongly assumes that input device may not be null. A similar issue was present in Flutter, but it is now fixed:  - link  - link On the other hand, using an id of -1 for touchscreen events (which is invalid) causes issues for some apps: link Therefore, use a device id of 0. An alternative could be to find an existing device matching the source, like ""adb shell input"" does. See getInputDeviceId(): link But it seems better to indicate that the event didn't come from a physical device, and it would not solve #962 anyway, because an Android TV has no touchscreen. Refs #962 link Fixes #2125 link"
1020,Fix encoder parameter suggestion,"The option is --encoder, not --encoder-name.",Fix encoder parameter suggestion,"The option is --encoder, not --encoder-name."
1021,meson: Do not use full path with mingw tools name,This helps to use mingw toolchains which are not in /usr/bin path. PR #2185 https://github.com/Genymobile/scrcpy/pull/2185 Signed-off-by: Romain Vimont rom@rom1v.com,meson: Do not use full path with mingw tools name,This helps to use mingw toolchains which are not in /usr/bin path. PR #2185 link Signed-off-by: Romain Vimont rom@rom1v.com
1022,Release frame data as soon as possible,"During a frame swap, one of the two frames involved can be released.",Release frame data as soon as possible,"During a frame swap, one of the two frames involved can be released."
1023,Factorize frame swap,,Factorize frame swap,
1024,Simplify screen initialization,Use a single function to initialize the screen instance.,Simplify screen initialization,Use a single function to initialize the screen instance.
1025,Group screen parameters into a struct,The function screen_init_rendering had too many parameters.,Group screen parameters into a struct,The function screen_init_rendering had too many parameters.
1026,Remove screen static initializer,Most of the fields are initialized dynamically.,Remove screen static initializer,Most of the fields are initialized dynamically.
1027,Use a callback to notify frame skip,"A skipped frame is detected when the producer offers a frame while the current pending frame has not been consumed. However, the producer (in practice the decoder) is not interested in the fact that a frame has been skipped, only the consumer (the renderer) is. Therefore, notify frame skip via a consumer callback. This allows to manage the skipped and rendered frames count at the same place, and remove fps_counter from decoder.",Use a callback to notify frame skip,"A skipped frame is detected when the producer offers a frame while the current pending frame has not been consumed. However, the producer (in practice the decoder) is not interested in the fact that a frame has been skipped, only the consumer (the renderer) is. Therefore, notify frame skip via a consumer callback. This allows to manage the skipped and rendered frames count at the same place, and remove fps_counter from decoder."
1028,Use a callback to notify a new frame,"Make the decoder independant of the SDL even mechanism, by making the consumer register a callback on the video_buffer.",Use a callback to notify a new frame,"Make the decoder independant of the SDL even mechanism, by making the consumer register a callback on the video_buffer."
1029,Initialize screen before starting the stream,"As soon as the stream is started, the video buffer could notify a new frame available. In order to pass this event to the screen without race condition, the screen must be initialized before the screen is started.",Initialize screen before starting the stream,"As soon as the stream is started, the video buffer could notify a new frame available. In order to pass this event to the screen without race condition, the screen must be initialized before the screen is started."
1030,Make video buffer more generic,"Video buffer is a tool between a frame producer and a frame consumer. For now, it is used between a decoder and a renderer, but in the future another instance might be used to swscale decoded frames.",Make video buffer more generic,"Video buffer is a tool between a frame producer and a frame consumer. For now, it is used between a decoder and a renderer, but in the future another instance might be used to swscale decoded frames."
1031,Move fps counter out of video buffer,"In order to make video buffer more generic, move out its specific responsibility to count the fps between the decoder and the renderer.",Move fps counter out of video buffer,"In order to make video buffer more generic, move out its specific responsibility to count the fps between the decoder and the renderer."
1032,Remove obsolete FAQ entry,Issue #15 had been fixed in v1.14 by e40532a3761da8b3aef484f1d435ef5f50d94574.,Remove obsolete FAQ entry,Issue #15 had been fixed in v1.14 by e40532a3761da8b3aef484f1d435ef5f50d94574.
1033,Mention adb debugging in FAQ,,Mention adb debugging in FAQ,
1034,Inject touch events with smallest detectable size,"A value of 1 means the ""largest detectable size"", a value of 0 means the ""smallest detectable size"". https://developer.android.com/reference/android/view/MotionEvent.PointerCoords#size https://developer.android.com/reference/android/view/MotionEvent#AXIS_SIZE Fixes #2125 https://github.com/Genymobile/scrcpy/issues/2125",Inject touch events with smallest detectable size,"A value of 1 means the ""largest detectable size"", a value of 0 means the ""smallest detectable size"". link link Fixes #2125 link"
1035,Remove unnecessary escape characters in manpage,PR #2123 https://github.com/Genymobile/scrcpy/pull/2123 Signed-off-by: Romain Vimont rom@rom1v.com,Remove unnecessary escape characters in manpage,PR #2123 link Signed-off-by: Romain Vimont rom@rom1v.com
1036,Update another java version in BUILD.md,"Commit f8524a2be738e6471ed2e48265f2663d8c21c0be updated one reference to the openjdk package, but there was another one.",Update another java version in BUILD.md,"Commit f8524a2be738e6471ed2e48265f2663d8c21c0be updated one reference to the openjdk package, but there was another one."
1037,Fix release instructions in BUILD.md,"Makefile.CrossWindows have been renamed to release.mk, which is called from release.sh.",Fix release instructions in BUILD.md,"Makefile.CrossWindows have been renamed to release.mk, which is called from release.sh."
1038,Simplify default values,"It makes sense to extract default values for bitrate and port range (which are arbitrary and might be changed in the future). However, the default values for ""max size"" and ""lock video orientation"" are naturally unlimited/unlocked, and will never be changed. Extracting these options just added complexity for no benefit, so hardcode them.",Simplify default values,"It makes sense to extract default values for bitrate and port range (which are arbitrary and might be changed in the future). However, the default values for ""max size"" and ""lock video orientation"" are naturally unlimited/unlocked, and will never be changed. Extracting these options just added complexity for no benefit, so hardcode them."
1039,Insert numerical values statically in usage string,,Insert numerical values statically in usage string,
1040,Remove unused no_window field,,Remove unused no_window field,
1041,Enable NDEBUG via Meson built-in option,,Enable NDEBUG via Meson built-in option,
1042,Handle im-related events from input_manager.c,,Handle im-related events from input_manager.c,
1043,Inline window events handling,"Now that all screen-related events are handled from screen.c, there is no need for a separate method for window events.",Inline window events handling,"Now that all screen-related events are handled from screen.c, there is no need for a separate method for window events."
1044,Handle screen-related events from screen.c,,Handle screen-related events from screen.c,
1045,Reference video buffer from screen,"This paves the way to handle EVENT_NEW_FRAME from screen.c, by allowing to call screen_update_frame() without an explicit video_buffer instance.",Reference video buffer from screen,"This paves the way to handle EVENT_NEW_FRAME from screen.c, by allowing to call screen_update_frame() without an explicit video_buffer instance."
1046,Improve error handling in screen initialization,"After the struct screen is initialized, the window, the renderer and the texture are necessarily valid, so there is no need to check in screen_destroy().",Improve error handling in screen initialization,"After the struct screen is initialized, the window, the renderer and the texture are necessarily valid, so there is no need to check in screen_destroy()."
1047,Handle window events only once visible,This will avoid corner cases where we need to resize while no frame has been received yet.,Handle window events only once visible,This will avoid corner cases where we need to resize while no frame has been received yet.
1048,Log mipmaps error only if mipmaps are enabled,,Log mipmaps error only if mipmaps are enabled,
1049,Make use_opengl local,"The flag is used only locally, there is no need to store it in the screen structure.",Make use_opengl local,"The flag is used only locally, there is no need to store it in the screen structure."
1050,Add intermediate frame in video buffer,"There were only two frames simultaneously:  - one used by the decoder;  - one used by the renderer. When the decoder finished decoding a frame, it swapped it with the rendering frame. Adding a third frame provides several benefits:  - the decoder do not have to wait for the renderer to release the    mutex;  - it simplifies the video_buffer API;  - it makes the rendering frame valid until the next call to    video_buffer_take_rendering_frame(), which will be useful for    swscaling on window resize.",Add intermediate frame in video buffer,"There were only two frames simultaneously:  - one used by the decoder;  - one used by the renderer. When the decoder finished decoding a frame, it swapped it with the rendering frame. Adding a third frame provides several benefits:  - the decoder do not have to wait for the renderer to release the    mutex;  - it simplifies the video_buffer API;  - it makes the rendering frame valid until the next call to    video_buffer_take_rendering_frame(), which will be useful for    swscaling on window resize."
1051,Assert non-recursive usage of mutexes,,Assert non-recursive usage of mutexes,
1052,Add mutex assertions,,Add mutex assertions,
1053,Expose mutex assertions,Add a function to assert that the mutex is held (or not).,Expose mutex assertions,Add a function to assert that the mutex is held (or not).
1054,Expose thread id,,Expose thread id,
1055,Wrap SDL thread functions into scrcpy-specific API,"The goal is to expose a consistent API for system tools, and paves the way to make the ""core"" independant of SDL in the future.",Wrap SDL thread functions into scrcpy-specific API,"The goal is to expose a consistent API for system tools, and paves the way to make the ""core"" independant of SDL in the future."
1056,Replace SDL_strdup() by strdup(),"The functions SDL_malloc(), SDL_free() and SDL_strdup() were used only because strdup() was not available everywhere. Now that it is available, use the native version of these functions.",Replace SDL_strdup() by strdup(),"The functions SDL_malloc(), SDL_free() and SDL_strdup() were used only because strdup() was not available everywhere. Now that it is available, use the native version of these functions."
1057,Provide strdup() compat,Make strdup() available on all platforms.,Provide strdup() compat,Make strdup() available on all platforms.
1058,Remove unused port_range field,"The port_range is used from ""struct server_params"", the copy in ""struct server"" was unused.",Remove unused port_range field,"The port_range is used from ""struct server_params"", the copy in ""struct server"" was unused."
1059,Remove unused custom event,,Remove unused custom event,
1060,Update java version in BUILD.md,PR #2064 https://github.com/Genymobile/scrcpy/pull/2064 Signed-off-by: Romain Vimont rom@rom1v.com,Update java version in BUILD.md,PR #2064 link Signed-off-by: Romain Vimont rom@rom1v.com
1061,Fix undefined left shift,"Small unsigned integers promote to signed int. As a consequence, if v is a uint8_t, then (v << 24) yields an int, so the left shift is undefined if the MSB is 1. Cast to uint32_t to yield an unsigned value. Reported by USAN (meson x -Db_sanitize=undefined): runtime error: left shift of 255 by 24 places cannot be represented in type 'int'",Fix undefined left shift,"Small unsigned integers promote to signed int. As a consequence, if v is a uint8_t, then (v << 24) yields an int, so the left shift is undefined if the MSB is 1. Cast to uint32_t to yield an unsigned value. Reported by USAN (meson x -Db_sanitize=undefined): runtime error: left shift of 255 by 24 places cannot be represented in type 'int'"
1062,Improve file handler error message,"Terminating the file handler current process may be either a ""push"" or ""install"" command.",Improve file handler error message,"Terminating the file handler current process may be either a ""push"" or ""install"" command."
1063,Kill process with SIGKILL signal,"An ""adb push"" command is not terminated by SIGTERM.",Kill process with SIGKILL signal,"An ""adb push"" command is not terminated by SIGTERM."
1064,Fix file_handler process race condition,"The current process could be waited both by run_file_handler() and file_handler_stop(). To avoid the race condition, wait the process without closing, then close with mutex locked.",Fix file_handler process race condition,"The current process could be waited both by run_file_handler() and file_handler_stop(). To avoid the race condition, wait the process without closing, then close with mutex locked."
1065,Expose a single process_wait(),There were two versions: process_wait() and process_wait_noclose(). Expose a single version with a flag (it was already implemented that way internally).,Expose a single process_wait(),There were two versions: process_wait() and process_wait_noclose(). Expose a single version with a flag (it was already implemented that way internally).
1066,Simplify process_wait(),"The function process_wait() returned a bool (true if the process terminated successfully) and provided the exit code via an output parameter exit_code. But the returned value was always equivalent to exit_code == 0, so just return the exit code instead.",Simplify process_wait(),"The function process_wait() returned a bool (true if the process terminated successfully) and provided the exit code via an output parameter exit_code. But the returned value was always equivalent to exit_code == 0, so just return the exit code instead."
1067,Fix size_t incorrectly assigned to int,The function control_msg_serialize() returns a size_t.,Fix size_t incorrectly assigned to int,The function control_msg_serialize() returns a size_t.
1068,Factorize meson compiler variable initialization,,Factorize meson compiler variable initialization,
1069,Define feature test macros in common.h,"This enables necessary functions once for all. As a consequence, define common.h before any other header.",Define feature test macros in common.h,"This enables necessary functions once for all. As a consequence, define common.h before any other header."
1070,Update README.zh-Hans to v1.17,PR #2029 https://github.com/Genymobile/scrcpy/pull/2029 Reviewed-by: Win7GM Signed-off-by: Romain Vimont rom@rom1v.com,Update README.zh-Hans to v1.17,PR #2029 link Reviewed-by: Win7GM Signed-off-by: Romain Vimont rom@rom1v.com
1071,Update README.pt-br to v1.17,PR #2034 https://github.com/Genymobile/scrcpy/pull/2034 Reviewed-by: latreta yves_henry13@hotmail.com Signed-off-by: Romain Vimont rom@rom1v.com,Update README.pt-br to v1.17,PR #2034 link Reviewed-by: latreta yves_henry13@hotmail.com Signed-off-by: Romain Vimont rom@rom1v.com
1072,Group common includes into common.h,"Include config.h and compat.h in common.h, and include common.h from all source files.",Group common includes into common.h,"Include config.h and compat.h in common.h, and include common.h from all source files."
1073,Move common structs to coords.h,"The size, point and position structs were defined in common.h. Move them to coords.h so that common.h could be used for generic code to be included in all source files.",Move common structs to coords.h,"The size, point and position structs were defined in common.h. Move them to coords.h so that common.h could be used for generic code to be included in all source files."
1074,Fix compat missing include,"The header libavformat/version.h was included, but not libavcodec/version.h. As a consequence, the LIBAVCODEC_VERSION_INT definition depended on the caller includes.",Fix compat missing include,"The header libavformat/version.h was included, but not libavcodec/version.h. As a consequence, the LIBAVCODEC_VERSION_INT definition depended on the caller includes."
1075,Remove unused struct port_range,It had been replaced by struct sc_port_range in scrcpy.h.,Remove unused struct port_range,It had been replaced by struct sc_port_range in scrcpy.h.
1076,Separate process wait and close,"On Linux, waitpid() both waits for the process to terminate and reaps it (closes its handle). On Windows, these actions are separated into WaitForSingleObject() and CloseHandle(). Expose these actions separately, so that it is possible to send a signal to a process while waiting for its termination without race condition. This allows to wait for server termination normally, but kill the process without race condition if it is not terminated after some delay.",Separate process wait and close,"On Linux, waitpid() both waits for the process to terminate and reaps it (closes its handle). On Windows, these actions are separated into WaitForSingleObject() and CloseHandle(). Expose these actions separately, so that it is possible to send a signal to a process while waiting for its termination without race condition. This allows to wait for server termination normally, but kill the process without race condition if it is not terminated after some delay."
1077,Rename process_simple_wait to process_wait,"Adding ""simple"" in the function name brings no benefit.",Rename process_simple_wait to process_wait,"Adding ""simple"" in the function name brings no benefit."
1078,Move conditional src files in meson.build,Declare all the source files (including the platform-specific ones) at the beginning.,Move conditional src files in meson.build,Declare all the source files (including the platform-specific ones) at the beginning.
1079,Split command into process and adb,"The process API provides the system-specific implementation, the adb API uses it to expose adb commands.",Split command into process and adb,"The process API provides the system-specific implementation, the adb API uses it to expose adb commands."
1080,Increase display id range,Some devices use big display id values. Refs #2009 https://github.com/Genymobile/scrcpy/issues/2009,Increase display id range,Some devices use big display id values. Refs #2009 link
1081,Fix possibly uninitialized value,"Due to gotos, ""ret"" may be returned uninitialized.",Fix possibly uninitialized value,"Due to gotos, ""ret"" may be returned uninitialized."
1082,Use --cask for latest versions of brew,PR #2004 https://github.com/Genymobile/scrcpy/pull/2004 Signed-off-by: Romain Vimont rom@rom1v.com,Use --cask for latest versions of brew,PR #2004 link Signed-off-by: Romain Vimont rom@rom1v.com
1083,Update links to v1.17 in README and BUILD,,Update links to v1.17 in README and BUILD,
1084,Bump version to 1.17,,Bump version to 1.17,
1085,Kill the server only after a small delay,"Let the server terminate properly once all the sockets are closed. If it does not terminate (this can happen if the device is asleep), then kill it. Note: since the server process termination is detected by a flag set after waitpid() returns, there is a small chance that the process terminates (and the PID assigned to a new process) before the flag is set but before the kill() call. This race condition already existed before this commit. Fixes #1992 https://github.com/Genymobile/scrcpy/issues/1992",Kill the server only after a small delay,"Let the server terminate properly once all the sockets are closed. If it does not terminate (this can happen if the device is asleep), then kill it. Note: since the server process termination is detected by a flag set after waitpid() returns, there is a small chance that the process terminates (and the PID assigned to a new process) before the flag is set but before the kill() call. This race condition already existed before this commit. Fixes #1992 link"
1086,Call CloseHandle() after wait on Windows,"TerminateProcess() is ""equivalent"" to kill(), while WaitForSingleObject() is ""equivalent"" to waitpid(), so the handle must be closed after WaitForSingleObject().",Call CloseHandle() after wait on Windows,"TerminateProcess() is ""equivalent"" to kill(), while WaitForSingleObject() is ""equivalent"" to waitpid(), so the handle must be closed after WaitForSingleObject()."
1087,Initialize server struct dynamically,This will allow to add mutex/cond fields.,Initialize server struct dynamically,This will allow to add mutex/cond fields.
1088,Interrupt device threads on stop,"The (non-daemon) threads were not interrupted on video stream stopped, leaving the server process alive. Interrupt them to wake up their blocking call so that they terminate properly. Refs #1992 https://github.com/Genymobile/scrcpy/issues/1992",Interrupt device threads on stop,"The (non-daemon) threads were not interrupted on video stream stopped, leaving the server process alive. Interrupt them to wake up their blocking call so that they terminate properly. Refs #1992 link"
1089,Mention how to add default arguments on Windows,Mention that it is possible to add default arguments by editing the wrapper scripts.,Mention how to add default arguments on Windows,Mention that it is possible to add default arguments by editing the wrapper scripts.
1090,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1091,Happy new year 2021!,,Happy new year 2021!,
1092,Upgrade SDL (2.0.14) for Windows,Include the latest version of SDL in Windows releases.,Upgrade SDL (2.0.14) for Windows,Include the latest version of SDL in Windows releases.
1093,Rename release.make to release.mk,"It's more standard, and benefits from syntax coloration in vi.",Rename release.make to release.mk,"It's more standard, and benefits from syntax coloration in vi."
1094,Unify release makefile,"Before this change, release.sh built some native stuff, and Makefile.CrossWindows built the Windows releases. Instead, use a single release.make to build the whole release. It also avoids to build the server one more time.",Unify release makefile,"Before this change, release.sh built some native stuff, and Makefile.CrossWindows built the Windows releases. Instead, use a single release.make to build the whole release. It also avoids to build the server one more time."
1095,Replace noconsole binary by a wrapper script,This simplifies the build system. Refs https://github.com/Genymobile/scrcpy/issues/1975#issuecomment-745314161,Replace noconsole binary by a wrapper script,This simplifies the build system. Refs link
1096,Improve rotation documentation,,Improve rotation documentation,
1097,Document Windows command line usage,PR #1973 https://github.com/Genymobile/scrcpy/pull/1973 Reviewed-by: Yu-Chen Lin npes87184@gmail.com,Document Windows command line usage,PR #1973 link Reviewed-by: Yu-Chen Lin npes87184@gmail.com
1098,Remove duplicate include,,Remove duplicate include,
1099,Upgrade JUnit to 4.13,,Upgrade JUnit to 4.13,
1100,Pause on error from a wrapper script,"On Windows, scrcpy paused on error before exiting to give the user a chance to see the user message. This was a hack and causes issues when using scrcpy from batch scripts. Disable this pause from the scrcpy binary, and provide a batch wrapper (scrcpy-console.bat) to pause on error. Fixes #1875 https://github.com/Genymobile/scrcpy/issues/1875",Pause on error from a wrapper script,"On Windows, scrcpy paused on error before exiting to give the user a chance to see the user message. This was a hack and causes issues when using scrcpy from batch scripts. Disable this pause from the scrcpy binary, and provide a batch wrapper (scrcpy-console.bat) to pause on error. Fixes #1875 link"
1101,Reference encoder section from FAQ,,Reference encoder section from FAQ,
1102,Reference FFmpeg Windows builds from GitHub,Refs #1753 https://github.com/Genymobile/scrcpy/issues/1753,Reference FFmpeg Windows builds from GitHub,Refs #1753 link
1103,Upgrade platform-tools (30.0.5) for Windows,Include the latest version of adb in Windows releases.,Upgrade platform-tools (30.0.5) for Windows,Include the latest version of adb in Windows releases.
1104,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1105,Fix build errors for macOS,PR #1960 https://github.com/Genymobile/scrcpy/pull/1960 Signed-off-by: Romain Vimont rom@rom1v.com,Fix build errors for macOS,PR #1960 link Signed-off-by: Romain Vimont rom@rom1v.com
1106,Document shell command to get the device IP,PR #1944 https://github.com/Genymobile/scrcpy/pull/1944 Signed-off-by: Romain Vimont rom@rom1v.com,Document shell command to get the device IP,PR #1944 link Signed-off-by: Romain Vimont rom@rom1v.com
1107,Upgrade gradle build tools to 4.0.1,,Upgrade gradle build tools to 4.0.1,
1108,Fix size_t format specifier for Windows,"Use ""%Iu"" on Windows. This fixes the following warning: ../app/src/sys/win/command.c:17:14: warning: unknown conversion type character l in format [-Wformat=]    17 |         LOGE(""Command too long (%"" PRIsizet "" chars)"", len - 1);",Fix size_t format specifier for Windows,"Use ""%Iu"" on Windows. This fixes the following warning: ../app/src/sys/win/command.c:17:14: warning: unknown conversion type character l in format [-Wformat=]    17 |         LOGE(""Command too long (%"" PRIsizet "" chars)"", len - 1);"
1109,Document --encoder option,Add documentation for the new option --encoder in the manpage and in README.md.,Document --encoder option,Add documentation for the new option --encoder in the manpage and in README.md.
1110,List available encoders on invalid name specified,"If an invalid encoder name is given via the --encoder option, list all the H.264 encoders available on the device.",List available encoders on invalid name specified,"If an invalid encoder name is given via the --encoder option, list all the H.264 encoders available on the device."
1111,Log encoder name,"When the encoder is selected automatically, log the name of the selected encoder.",Log encoder name,"When the encoder is selected automatically, log the name of the selected encoder."
1112,Adding new option --encoder,"Some devices have more than one encoder, and some encoders may cause issues or crash. With this option we can specify which encoder we want the device to use. PR #1827 https://github.com/Genymobile/scrcpy/pull/1827 Fixes #1810 https://github.com/Genymobile/scrcpy/issues/1810 Signed-off-by: Romain Vimont rom@rom1v.com",Adding new option --encoder,"Some devices have more than one encoder, and some encoders may cause issues or crash. With this option we can specify which encoder we want the device to use. PR #1827 link Fixes #1810 link Signed-off-by: Romain Vimont rom@rom1v.com"
1113,Add option to force legacy method for pasting,Some devices do not behave as expected when setting the device clipboard programmatically. Add an option --legacy-paste to change the behavior of Ctrl+v and MOD+v so that they inject the computer clipboard text as a sequence of key events (the same way as MOD+Shift+v). Fixes #1750 https://github.com/Genymobile/scrcpy/issues/1750 Fixes #1771 https://github.com/Genymobile/scrcpy/issues/1771,Add option to force legacy method for pasting,Some devices do not behave as expected when setting the device clipboard programmatically. Add an option --legacy-paste to change the behavior of Ctrl+v and MOD+v so that they inject the computer clipboard text as a sequence of key events (the same way as MOD+Shift+v). Fixes #1750 link Fixes #1771 link
1114,Add an option to forward all clicks,Add --forward-all-clicks to disable mouse shortcuts and forward middle and right clicks to the device instead. Fixes #1302 https://github.com/Genymobile/scrcpy/issues/1302 Fixes #1613 https://github.com/Genymobile/scrcpy/issues/1613,Add an option to forward all clicks,Add --forward-all-clicks to disable mouse shortcuts and forward middle and right clicks to the device instead. Fixes #1302 link Fixes #1613 link
1115,Add local.properties to gitignore,,Add local.properties to gitignore,
1116,Remove spurious space,,Remove spurious space,
1117,Mention version of Indonesian translation,,Mention version of Indonesian translation,
1118,Add Indonesian translation for README.md,PR #1802 https://github.com/Genymobile/scrcpy/pull/1802 Signed-off-by: Romain Vimont rom@rom1v.com,Add Indonesian translation for README.md,PR #1802 link Signed-off-by: Romain Vimont rom@rom1v.com
1119,Enable Java deprecation warnings details,"Without the option, gradle reports a lint issue, but without any details.",Enable Java deprecation warnings details,"Without the option, gradle reports a lint issue, but without any details."
1120,Remove deprecation warning,"As a workaround for some devices, we need to prepare the main looper. The method is now deprecated, but we still want to call it.",Remove deprecation warning,"As a workaround for some devices, we need to prepare the main looper. The method is now deprecated, but we still want to call it."
1121,Fix options order,,Fix options order,
1122,Fix FAQ.ko.md,PR #1767 https://github.com/Genymobile/scrcpy/pull/1767 Signed-off-by: Romain Vimont rom@rom1v.com,Fix FAQ.ko.md,PR #1767 link Signed-off-by: Romain Vimont rom@rom1v.com
1123,"Fix ""press Enter key"" message","The message said ""Press any key to continue..."", whereas only Enter/Return is accepted. PR #1783 https://github.com/Genymobile/scrcpy/pull/1783 Fixes #1757 https://github.com/Genymobile/scrcpy/issues/1757 Reviewed-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com","Fix ""press Enter key"" message","The message said ""Press any key to continue..."", whereas only Enter/Return is accepted. PR #1783 link Fixes #1757 link Reviewed-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com"
1124,Remove unused field,Fixes #1775 https://github.com/Genymobile/scrcpy/issues/1775 Reported-by: lordnn,Remove unused field,Fixes #1775 link Reported-by: lordnn
1125,Add missing mutex unlock on error,Fixes #1770 https://github.com/Genymobile/scrcpy/issues/1770 Reported-by: lordnn,Add missing mutex unlock on error,Fixes #1770 link Reported-by: lordnn
1126,Add simplified Chinese translation for README.md,PR #1723 https://github.com/Genymobile/scrcpy/pull/1723 Co-authored-by: Shaw Yu shawyu.nz@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com,Add simplified Chinese translation for README.md,PR #1723 link Co-authored-by: Shaw Yu shawyu.nz@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com
1127,Fix README indentation,,Fix README indentation,
1128,Upgrade Android SDK to 30,,Upgrade Android SDK to 30,
1129,Use portable shebang for all bash scripts,Refs #426 https://github.com/Genymobile/scrcpy/pull/426 Refs #1716 https://github.com/Genymobile/scrcpy/pull/1716,Use portable shebang for all bash scripts,Refs #426 link Refs #1716 link
1130,Use a more portable shebang for bash,This should increase the portability of bash scripts across various *nix systems such as BSD-like distributions. PR #1716 https://github.com/Genymobile/scrcpy/pull/1716 Signed-off-by: Lus Ferreira contact@lsferreira.net Signed-off-by: Romain Vimont rom@rom1v.com,Use a more portable shebang for bash,This should increase the portability of bash scripts across various *nix systems such as BSD-like distributions. PR #1716 link Signed-off-by: Lus Ferreira contact@lsferreira.net Signed-off-by: Romain Vimont rom@rom1v.com
1131,"Use ""/usr/bin/env bash"" for build-wrapper.sh",PR #426 https://github.com/Genymobile/scrcpy/pull/426 Signed-off-by: Romain Vimont rom@rom1v.com,"Use ""/usr/bin/env bash"" for build-wrapper.sh",PR #426 link Signed-off-by: Romain Vimont rom@rom1v.com
1132,Adapt call() on ContentProvider for Android 11,"This commit in AOSP framework_base added a parameter ""attributionTag"" to the call() method: https://android.googlesource.com/platform/frameworks/base.git/+/12ac3f406fed87cb9cd3a28b9947e7202a2d14bd%5E%21/#F17 As a consequence, the method did not exist, so scrcpy used the legacy call() method (using the authority ""unknown"") as a fallback, which fails for security reasons. Fixes #1468 https://github.com/Genymobile/scrcpy/issues/1468",Adapt call() on ContentProvider for Android 11,"This commit in AOSP framework_base added a parameter ""attributionTag"" to the call() method: link As a consequence, the method did not exist, so scrcpy used the legacy call() method (using the authority ""unknown"") as a fallback, which fails for security reasons. Fixes #1468 link"
1133,Fix feature test macro,The expected feature test macro is _POSIX_C_SOURCE having a value greater or equal to 200809L. Fixes #1726 https://github.com/Genymobile/scrcpy/issues/1726,Fix feature test macro,The expected feature test macro is _POSIX_C_SOURCE having a value greater or equal to 200809L. Fixes #1726 link
1134,Fix more log format warning,"The expression port + 1 is promoted to int, but printed as uint16_t. This is the same mistake fixed for a different log by 7eb16ce36458011d87972715f08bd9f03ff39807. Refs #1726 https://github.com/Genymobile/scrcpy/issues/1726",Fix more log format warning,"The expression port + 1 is promoted to int, but printed as uint16_t. This is the same mistake fixed for a different log by 7eb16ce36458011d87972715f08bd9f03ff39807. Refs #1726 link"
1135,Reset power mode only if screen is on,PR #1670 https://github.com/Genymobile/scrcpy/pull/1670 Signed-off-by: Romain Vimont rom@rom1v.com,Reset power mode only if screen is on,PR #1670 link Signed-off-by: Romain Vimont rom@rom1v.com
1136,Make Device methods static when possible,The behavior of some methods do not depend on the user-provided options. These methods can be static. This will allow to call them directly from the cleanup process.,Make Device methods static when possible,The behavior of some methods do not depend on the user-provided options. These methods can be static. This will allow to call them directly from the cleanup process.
1137,Add undetected device error message in FAQ,,Add undetected device error message in FAQ,
1138,List available shortcut keys on error,Fixes #1681 https://github.com/Genymobile/scrcpy/issues/1681 Suggested-by: Moritz Schulz moritzleni@gmail.com,List available shortcut keys on error,Fixes #1681 link Suggested-by: Moritz Schulz moritzleni@gmail.com
1139,Reference --shortcut-mod from shortcuts list,Fixes #1681 https://github.com/Genymobile/scrcpy/issues/1681 Suggested-by: Moritz Schulz moritzleni@gmail.com,Reference --shortcut-mod from shortcuts list,Fixes #1681 link Suggested-by: Moritz Schulz moritzleni@gmail.com
1140,Update links to v1.16 in README and BUILD,,Update links to v1.16 in README and BUILD,
1141,Bump version to 1.16,,Bump version to 1.16,
1142,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1143,Add pinch-to-zoom simulation,"If Ctrl is hold when the left-click button is pressed, enable pinch-to-zoom to scale and rotate relative to the center of the screen. Fixes #24 https://github.com/Genymobile/scrcpy/issues/24",Add pinch-to-zoom simulation,"If Ctrl is hold when the left-click button is pressed, enable pinch-to-zoom to scale and rotate relative to the center of the screen. Fixes #24 link"
1144,Add reference of the translations in README,Reviewed-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com,Add reference of the translations in README,Reviewed-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com
1145,Add Traditional Chinese translation for README,Reviewed-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com,Add Traditional Chinese translation for README,Reviewed-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com
1146,Fix clipboard paste condition,"To avoid possible copy-paste loops between the computer and the device, the device clipboard is not set if it already contains the expected content. But the condition was wrong: it was not set also if it was empty. Refs 1223a72eb83ebafb878a25356250896c45b5cefa Fixes #1658 https://github.com/Genymobile/scrcpy/issues/1658",Fix clipboard paste condition,"To avoid possible copy-paste loops between the computer and the device, the device clipboard is not set if it already contains the expected content. But the condition was wrong: it was not set also if it was empty. Refs 1223a72eb83ebafb878a25356250896c45b5cefa Fixes #1658 link"
1147,"Revert ""Inject WAKEUP instead of POWER""",WAKEUP does not work on some devices. Fixes #1655 https://github.com/Genymobile/scrcpy/issues/1655 This reverts commit 322f1512ea806611eb37f508cd952bbbc050f853.,"Revert ""Inject WAKEUP instead of POWER""",WAKEUP does not work on some devices. Fixes #1655 link This reverts commit 322f1512ea806611eb37f508cd952bbbc050f853.
1148,Fix missing change of Ctrl key in README,PR #1652 https://github.com/Genymobile/scrcpy/pull/1652 Signed-off-by: Romain Vimont rom@rom1v.com,Fix missing change of Ctrl key in README,PR #1652 link Signed-off-by: Romain Vimont rom@rom1v.com
1149,Add packaging status,PR #1650 https://github.com/Genymobile/scrcpy/pull/1650 Signed-off-by: Romain Vimont rom@rom1v.com,Add packaging status,PR #1650 link Signed-off-by: Romain Vimont rom@rom1v.com
1150,Update links to v1.15.1 in README and BUILD,,Update links to v1.15.1 in README and BUILD,
1151,Bump version to 1.15.1,,Bump version to 1.15.1,
1152,Fix uninitialized repeat count in key events,"A new ""repeat"" field has been added by 3c1ed5d86c38bcbd5353b0a7e6ef5653d6c44d0d, but it was not initialized in every code path. As a consequence, keycodes generated by shortcuts were sent with an undetermined value, breaking some shortcuts (especially HOME) randomly. Fixes #1643 https://github.com/Genymobile/scrcpy/issues/1643",Fix uninitialized repeat count in key events,"A new ""repeat"" field has been added by 3c1ed5d86c38bcbd5353b0a7e6ef5653d6c44d0d, but it was not initialized in every code path. As a consequence, keycodes generated by shortcuts were sent with an undetermined value, breaking some shortcuts (especially HOME) randomly. Fixes #1643 link"
1153,Update links to v1.15 in README and BUILD,,Update links to v1.15 in README and BUILD,
1154,Bump version to 1.15,,Bump version to 1.15,
1155,Upgrade FFmpeg (4.3.1) for Windows,Include the latest version of FFmpeg in Windows releases.,Upgrade FFmpeg (4.3.1) for Windows,Include the latest version of FFmpeg in Windows releases.
1156,Upgrade platform-tools (30.0.4) for Windows,Include the latest version of adb in Windows releases.,Upgrade platform-tools (30.0.4) for Windows,Include the latest version of adb in Windows releases.
1157,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1158,Keep the screen off on powering on,PR #1577 https://github.com/Genymobile/scrcpy/pull/1577 Fixes #1573 https://github.com/Genymobile/scrcpy/issues/1573 Signed-off-by: Romain Vimont rom@rom1v.com,Keep the screen off on powering on,PR #1577 link Fixes #1573 link Signed-off-by: Romain Vimont rom@rom1v.com
1159,Add --no-key-repeat cli option,Add an option to avoid forwarding repeated key events. PR #1623 https://github.com/Genymobile/scrcpy/pull/1623 Refs #1013 https://github.com/Genymobile/scrcpy/issues/1013 Signed-off-by: Romain Vimont rom@rom1v.com,Add --no-key-repeat cli option,Add an option to avoid forwarding repeated key events. PR #1623 link Refs #1013 link Signed-off-by: Romain Vimont rom@rom1v.com
1160,Pass full options struct to static functions,"This avoids to pass specific options values individually. Since these function are static (internal to the file), this is not a problem to make them depend on scrcpy_options. Refs #1623 https://github.com/Genymobile/scrcpy/pull/1623 Signed-off-by: Romain Vimont rom@rom1v.com",Pass full options struct to static functions,"This avoids to pass specific options values individually. Since these function are static (internal to the file), this is not a problem to make them depend on scrcpy_options. Refs #1623 link Signed-off-by: Romain Vimont rom@rom1v.com"
1161,Copy the options used in input manager init,This avoids to pass additional options to some input manager functions. Refs #1623 https://github.com/Genymobile/scrcpy/pull/1623,Copy the options used in input manager init,This avoids to pass additional options to some input manager functions. Refs #1623 link
1162,Mention that MENU unlocks screen,Pressing MENU while in lock screen unlocks (it still asks for the schema or code if enabled).,Mention that MENU unlocks screen,Pressing MENU while in lock screen unlocks (it still asks for the schema or code if enabled).
1163,Use  HTML tag for keys,It's prettyier in a browser.,Use  HTML tag for keys,It's prettyier in a browser.
1164,Mention in README that Ctrl is forwarded,,Mention in README that Ctrl is forwarded,
1165,Update copy-paste section in README,Update documentation regarding the recent copy-paste changes.,Update copy-paste section in README,Update documentation regarding the recent copy-paste changes.
1166,Swap paste shortcuts,"For consistency with MOD+c and MOD+x, use MOD+v to inject PASTE. Use Mod+Shift+v to inject clipboard content as a sequence of text events.",Swap paste shortcuts,"For consistency with MOD+c and MOD+x, use MOD+v to inject PASTE. Use Mod+Shift+v to inject clipboard content as a sequence of text events."
1167,Add shortcuts for COPY and CUT,"Send COPY and CUT on MOD+c and MOD+x (only supported for Android >= 7). The shortcuts Ctrl+c and Ctrl+x should generally also work (even before Android 7), but the active Android app may use them for other actions instead.",Add shortcuts for COPY and CUT,"Send COPY and CUT on MOD+c and MOD+x (only supported for Android >= 7). The shortcuts Ctrl+c and Ctrl+x should generally also work (even before Android 7), but the active Android app may use them for other actions instead."
1168,"Change ""resize to fit"" shortcut to MOD+w","For convenience, MOD+x will be used for injecting the CUT keycode.","Change ""resize to fit"" shortcut to MOD+w","For convenience, MOD+x will be used for injecting the CUT keycode."
1169,"Remove ""get clipboard"" call","Now that every device clipboard change is automatically synchronized to the computer, the ""get clipboard"" request (bound to MOD+c) is useless.","Remove ""get clipboard"" call","Now that every device clipboard change is automatically synchronized to the computer, the ""get clipboard"" request (bound to MOD+c) is useless."
1170,Set computer clipboard only if necessary,"Do not explicitly set the clipboard text if it already contains the expected content. Even if copy-paste loops are avoided by the previous commit, this avoids to trigger a clipboard change on the computer-side. Refs #1580 https://github.com/Genymobile/scrcpy/issues/1580",Set computer clipboard only if necessary,"Do not explicitly set the clipboard text if it already contains the expected content. Even if copy-paste loops are avoided by the previous commit, this avoids to trigger a clipboard change on the computer-side. Refs #1580 link"
1171,Set device clipboard only if necessary,Do not explicitly set the clipboard text if it already contains the expected content. This avoids possible copy-paste loops between the computer and the device.,Set device clipboard only if necessary,Do not explicitly set the clipboard text if it already contains the expected content. This avoids possible copy-paste loops between the computer and the device.
1172,Synchronize clipboard on Ctrl+v,"Pressing Ctrl+v on the device will typically paste the clipboard content. Before sending the key event, synchronize the computer clipboard to the device clipboard to allow seamless copy-paste.",Synchronize clipboard on Ctrl+v,"Pressing Ctrl+v on the device will typically paste the clipboard content. Before sending the key event, synchronize the computer clipboard to the device clipboard to allow seamless copy-paste."
1173,Forward Shift to the device,This allows to select text using Shift+(arrow keys). Fixes #942 https://github.com/Genymobile/scrcpy/issues/942,Forward Shift to the device,This allows to select text using Shift+(arrow keys). Fixes #942 link
1174,Forward Ctrl to the device,"Now that the scrcpy shortcut modifier is Alt by default (and can be configured), forward Ctrl to the device. This allows to trigger Android shortcuts. Fixes #555 https://github.com/Genymobile/scrcpy/issues/555",Forward Ctrl to the device,"Now that the scrcpy shortcut modifier is Alt by default (and can be configured), forward Ctrl to the device. This allows to trigger Android shortcuts. Fixes #555 link"
1175,Ignore text events for shortcuts,"Pressing Alt+c generates a text event containing ""c"", so ""c"" was sent to the device when --prefer-text was enabled. Ignore text events when the mod state matches a shortcut modifier.",Ignore text events for shortcuts,"Pressing Alt+c generates a text event containing ""c"", so ""c"" was sent to the device when --prefer-text was enabled. Ignore text events when the mod state matches a shortcut modifier."
1176,Accept Super as shortcut modifier,"In addition to (left) Alt, also accept (left) Super. This is especially convenient for macOS users (Super is the Cmd key).",Accept Super as shortcut modifier,"In addition to (left) Alt, also accept (left) Super. This is especially convenient for macOS users (Super is the Cmd key)."
1177,Customize shortcut modifier,"Add --shortcut-mod, and use Alt as default modifier. This paves the way to forward the Ctrl key to the device.",Customize shortcut modifier,"Add --shortcut-mod, and use Alt as default modifier. This paves the way to forward the Ctrl key to the device."
1178,Use Ctrl for all shortcuts,"Remove the Cmd modifier on macOS, which was possible only for some shortcuts but not all. This paves the way to make the shortcut modifier customizable.",Use Ctrl for all shortcuts,"Remove the Cmd modifier on macOS, which was possible only for some shortcuts but not all. This paves the way to make the shortcut modifier customizable."
1179,Make expression order consistent,"The condition ""cmd"" was always before ""shift"" in all expressions except 4.",Make expression order consistent,"The condition ""cmd"" was always before ""shift"" in all expressions except 4."
1180,"Simplify PASTE option for ""set clipboard""","When the client requests to set the clipboard, it may request to press the PASTE key in addition. To be a bit generic, it was stored as a flag in ControlMessage.java. But flags suggest that it represents a bitwise union. Use a simple boolean instead.","Simplify PASTE option for ""set clipboard""","When the client requests to set the clipboard, it may request to press the PASTE key in addition. To be a bit generic, it was stored as a flag in ControlMessage.java. But flags suggest that it represents a bitwise union. Use a simple boolean instead."
1181,Declare main() with argc/argv params in tests,"Declaring the main method as ""int main(void)"" causes issues with SDL. Fixes #1209 https://github.com/Genymobile/scrcpy/issues/1209",Declare main() with argc/argv params in tests,"Declaring the main method as ""int main(void)"" causes issues with SDL. Fixes #1209 link"
1182,Inject WAKEUP instead of POWER,"To power the device on, inject KEYCODE_WAKEUP to avoid a possible race condition (the device might become off between the test isScreenOn() and the POWER keycode injection).",Inject WAKEUP instead of POWER,"To power the device on, inject KEYCODE_WAKEUP to avoid a possible race condition (the device might become off between the test isScreenOn() and the POWER keycode injection)."
1183,Restore power mode to normal on cleanup,This avoids to let the device screen turned off (as enabled by Ctrl+o or --turn-screen-off). PR #1576 https://github.com/Genymobile/scrcpy/pull/1576 Fixes #1572 https://github.com/Genymobile/scrcpy/issues/1572,Restore power mode to normal on cleanup,This avoids to let the device screen turned off (as enabled by Ctrl+o or --turn-screen-off). PR #1576 link Fixes #1572 link
1184,Warn on ignored touch event,"In theory, this was expected to only happen when a touch event is sent just before the device is rotated, but some devices do not respect the encoding size, causing an unexpected mismatch. Refs #1518 https://github.com/Genymobile/scrcpy/issues/1518",Warn on ignored touch event,"In theory, this was expected to only happen when a touch event is sent just before the device is rotated, but some devices do not respect the encoding size, causing an unexpected mismatch. Refs #1518 link"
1185,Send touch event without pressure on button up,Refs #1518 https://github.com/Genymobile/scrcpy/issues/1518,Send touch event without pressure on button up,Refs #1518 link
1186,Update BUILD.md,Update the macOS section. PR #1559 https://github.com/Genymobile/scrcpy/pull/1559 Signed-off-by: Romain Vimont rom@rom1v.com,Update BUILD.md,Update the macOS section. PR #1559 link Signed-off-by: Romain Vimont rom@rom1v.com
1187,Fix constants name in comment,,Fix constants name in comment,
1188,Make setScreenPowerMode() method static,Its implementation does not use the instance at all.,Make setScreenPowerMode() method static,Its implementation does not use the instance at all.
1189,Do not crash on missing clipboard manager,"Some devices have no clipboard manager. In that case, do not try to enable clipboard synchronization to avoid a crash. Fixes #1440 https://github.com/Genymobile/scrcpy/issues/1440 Fixes #1556 https://github.com/Genymobile/scrcpy/issues/1556",Do not crash on missing clipboard manager,"Some devices have no clipboard manager. In that case, do not try to enable clipboard synchronization to avoid a crash. Fixes #1440 link Fixes #1556 link"
1190,README: Add Fedora install instructions,PR #1549 https://github.com/Genymobile/scrcpy/pull/1549 Signed-off-by: Romain Vimont rom@rom1v.com,README: Add Fedora install instructions,PR #1549 link Signed-off-by: Romain Vimont rom@rom1v.com
1191,Fix touch events HiDPI-scaling,"Touch events were HiDPI-scaled twice:  - once because the position (provided as floats between 0 and 1) were    converted in pixels using the drawable size (not the window size)  - once due to screen_convert_to_frame_coords() One possible fix could be to compute the position in pixels from the window size instead, but this would unnecessarily round the event position to the nearest window coordinates (instead of drawable coordinates). Instead, expose two separate functions to convert to frame coordinates from either window or drawable coordinates. Fixes #1536 https://github.com/Genymobile/scrcpy/issues/1536 Refs #15 https://github.com/Genymobile/scrcpy/issues/15 Refs e40532a3761da8b3aef484f1d435ef5f50d94574",Fix touch events HiDPI-scaling,"Touch events were HiDPI-scaled twice:  - once because the position (provided as floats between 0 and 1) were    converted in pixels using the drawable size (not the window size)  - once due to screen_convert_to_frame_coords() One possible fix could be to compute the position in pixels from the window size instead, but this would unnecessarily round the event position to the nearest window coordinates (instead of drawable coordinates). Instead, expose two separate functions to convert to frame coordinates from either window or drawable coordinates. Fixes #1536 link Refs #15 link Refs e40532a3761da8b3aef484f1d435ef5f50d94574"
1192,Improve linguistic,PR #1543 https://github.com/Genymobile/scrcpy/pull/1543 Signed-off-by: Romain Vimont rom@rom1v.com,Improve linguistic,PR #1543 link Signed-off-by: Romain Vimont rom@rom1v.com
1193,Handle repeating keycodes,"Initialize ""repeat"" count on key events. PR #1519 https://github.com/Genymobile/scrcpy/pull/1519 Refs #1013 https://github.com/Genymobile/scrcpy/pull/1013 Signed-off-by: Romain Vimont rom@rom1v.com",Handle repeating keycodes,"Initialize ""repeat"" count on key events. PR #1519 link Refs #1013 link Signed-off-by: Romain Vimont rom@rom1v.com"
1194,Make scrcpy.h independant of other headers,"The header scrcpy.h is intended to be the ""public"" API. It should not depend on other internal headers. Therefore, declare all required structs in this header and adapt internal code.",Make scrcpy.h independant of other headers,"The header scrcpy.h is intended to be the ""public"" API. It should not depend on other internal headers. Therefore, declare all required structs in this header and adapt internal code."
1195,Remove fprintf() call in tests,It should never have been committed.,Remove fprintf() call in tests,It should never have been committed.
1196,Add option for disabling screensaver,PR #1502 https://github.com/Genymobile/scrcpy/pull/1502 Fixes #1370 https://github.com/Genymobile/scrcpy/issues/1370 Signed-off-by: Romain Vimont rom@rom1v.com,Add option for disabling screensaver,PR #1502 link Fixes #1370 link Signed-off-by: Romain Vimont rom@rom1v.com
1197,Fix typo in README.md,PR #1523 https://github.com/Genymobile/scrcpy/pull/1523 Signed-off-by: Romain Vimont rom@rom1v.com,Fix typo in README.md,PR #1523 link Signed-off-by: Romain Vimont rom@rom1v.com
1198,Make message buffer static,"Now that the message max size is 256k, do not put the buffer on the stack.",Make message buffer static,"Now that the message max size is 256k, do not put the buffer on the stack."
1199,Increase clipboard size from 4k to 256k,"Beyond 256k, SDL_GetClipboardText() returns an empty string on my computer. Fixes #1117 https://github.com/Genymobile/scrcpy/issues/1117",Increase clipboard size from 4k to 256k,"Beyond 256k, SDL_GetClipboardText() returns an empty string on my computer. Fixes #1117 link"
1200,Fix receiver on partial device messages,"If a single device message was read in several chunks from the control socket, the communication was broken.",Fix receiver on partial device messages,"If a single device message was read in several chunks from the control socket, the communication was broken."
1201,Serialize text size on 4 bytes,This will allow to send text having a size greater than 65535 bytes.,Serialize text size on 4 bytes,This will allow to send text having a size greater than 65535 bytes.
1202,Rename MSG_SERIALIZED_MAX_SIZE to MSG_MAX_SIZE,For simplicity and consistency with the server part.,Rename MSG_SERIALIZED_MAX_SIZE to MSG_MAX_SIZE,For simplicity and consistency with the server part.
1203,Add unit test for big clipboard device message,Test clipboard synchronization from the device to the computer.,Add unit test for big clipboard device message,Test clipboard synchronization from the device to the computer.
1204,"Rename test names from ""event"" to ""msg""","The meson test names had not been changed when ""event"" had been renamed to ""message"". Ref: 28980bbc90ab93cf61bdc4b36d2448b8cebbb7df","Rename test names from ""event"" to ""msg""","The meson test names had not been changed when ""event"" had been renamed to ""message"". Ref: 28980bbc90ab93cf61bdc4b36d2448b8cebbb7df"
1205,Avoid additional copy on Java text parsing,Directly pass the buffer range to the String constructor.,Avoid additional copy on Java text parsing,Directly pass the buffer range to the String constructor.
1206,Reorganize message size constants,Make the max clipboard text length depend on the max message size.,Reorganize message size constants,Make the max clipboard text length depend on the max message size.
1207,Mention sndcpy,,Mention sndcpy,
1208,Add missing file in build_without_gradle.sh,Fixes #1481 https://github.com/Genymobile/scrcpy/issues/1481 PR #1482 https://github.com/Genymobile/scrcpy/pull/1482 Signed-off-by: Louis Leseur louis.leseur@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com,Add missing file in build_without_gradle.sh,Fixes #1481 link PR #1482 link Signed-off-by: Louis Leseur louis.leseur@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com
1209,Configure log level for application only,Do not expose internal SDL logs to users. Fixes #1441 https://github.com/Genymobile/scrcpy/issues/1441,Configure log level for application only,Do not expose internal SDL logs to users. Fixes #1441 link
1210,Fix incorrect log return value,"The function must return a SDL_LogPriority, but returned an enum sc_log_level. (It was harmless because this specific return should never happen, as asserted.)",Fix incorrect log return value,"The function must return a SDL_LogPriority, but returned an enum sc_log_level. (It was harmless because this specific return should never happen, as asserted.)"
1211,Git-ignore release directories,,Git-ignore release directories,
1212,Avoid repetition for some shortcuts,"Keeping the key pressed generate ""repeat"" events. It does not make sense to repeat the event for rotation or turn screen off.",Avoid repetition for some shortcuts,"Keeping the key pressed generate ""repeat"" events. It does not make sense to repeat the event for rotation or turn screen off."
1213,Mention stay awake limitation,"The ""stay awake"" feature only works when the device is plugged in. Refs #1445 https://github.com/Genymobile/scrcpy/issues/1445",Mention stay awake limitation,"The ""stay awake"" feature only works when the device is plugged in. Refs #1445 link"
1214,Mention how to turn the screen on in README,"Now that Ctrl+Shift+o has been reactivated, mention it in the ""turn screen off"" section.",Mention how to turn the screen on in README,"Now that Ctrl+Shift+o has been reactivated, mention it in the ""turn screen off"" section."
1215,Update links to v1.14 in README and BUILD,,Update links to v1.14 in README and BUILD,
1216,Bump version to 1.14,,Bump version to 1.14,
1217,"Reactivate ""turn device screen on"" feature","This reverts commit 8c8649cfcd710859ce18eab557ed2af8cedb9a42. I cannot reproduce the issue with Ctrl+Shift+o on any device, so in practice it works, it's too bad to remove the feature for a random bug on some Android versions on some devices.","Reactivate ""turn device screen on"" feature","This reverts commit 8c8649cfcd710859ce18eab557ed2af8cedb9a42. I cannot reproduce the issue with Ctrl+Shift+o on any device, so in practice it works, it's too bad to remove the feature for a random bug on some Android versions on some devices."
1218,Push clipboard text only if not null,"In practice, it does not change anything (it just avoids a spurious wake-up), but semantically, it makes no sense to call pushClipboardText() with a null value.",Push clipboard text only if not null,"In practice, it does not change anything (it just avoids a spurious wake-up), but semantically, it makes no sense to call pushClipboardText() with a null value."
1219,Improve manpage formatting,Add a new line to avoid unwanted text justification,Improve manpage formatting,Add a new line to avoid unwanted text justification
1220,Initialize a default log level,"Clean up has been broken by 3df63c579da7a35048458c6884f5f386154d2353. The verbosity was correctly initialized for the Server process, but not for the CleanUp process. To avoid the problem, initialize a default log level.",Initialize a default log level,"Clean up has been broken by 3df63c579da7a35048458c6884f5f386154d2353. The verbosity was correctly initialized for the Server process, but not for the CleanUp process. To avoid the problem, initialize a default log level."
1221,Upgrade platform-tools (30.0.0) for Windows,Include the latest version of adb in Windows releases.,Upgrade platform-tools (30.0.0) for Windows,Include the latest version of adb in Windows releases.
1222,"Paste on ""set clipboard"" if possible","Ctrl+Shift+v synchronizes the computer clipboard to the Android device clipboard. This feature had been added to provide a way to copy UTF-8 text from the computer to the device. To make such a paste more straightforward, if the device runs at least Android 7, also send a PASTE keycode to paste immediately. https://developer.android.com/reference/android/view/KeyEvent.html#KEYCODE_PASTE Fixes #786 https://github.com/Genymobile/scrcpy/issues/786","Paste on ""set clipboard"" if possible","Ctrl+Shift+v synchronizes the computer clipboard to the Android device clipboard. This feature had been added to provide a way to copy UTF-8 text from the computer to the device. To make such a paste more straightforward, if the device runs at least Android 7, also send a PASTE keycode to paste immediately. link Fixes #786 link"
1223,Fix union typo,"The ""set clipboard"" event used the wrong union type to store its text. In practice, it worked because both are at the same offset.",Fix union typo,"The ""set clipboard"" event used the wrong union type to store its text. In practice, it worked because both are at the same offset."
1224,Move injection methods to Device,"Only the main injection method was exposed on Device, the convenience methods were implemented in Controller. For consistency, move them all to the Device class.",Move injection methods to Device,"Only the main injection method was exposed on Device, the convenience methods were implemented in Controller. For consistency, move them all to the Device class."
1225,Avoid clipboard synchronization loop,"The Android device listens for clipboard changes to synchronize with the computer clipboard. However, if the change comes from scrcpy (for example via Ctrl+Shift+v), do not notify the change.",Avoid clipboard synchronization loop,"The Android device listens for clipboard changes to synchronize with the computer clipboard. However, if the change comes from scrcpy (for example via Ctrl+Shift+v), do not notify the change."
1226,Log actions on the caller side,"Some actions are exposed by the Device class, but logging success should be done by the caller.",Log actions on the caller side,"Some actions are exposed by the Device class, but logging success should be done by the caller."
1227,Pass a Locale to toUpperCase(),Make lint happy.,Pass a Locale to toUpperCase(),Make lint happy.
1228,Rename THRESHOLD to threshold,"Since the field is not final anymore, lint expects the name not to be capitalized.",Rename THRESHOLD to threshold,"Since the field is not final anymore, lint expects the name not to be capitalized."
1229,Add --force-adb-forward,"Add a command-line option to force ""adb forward"", without attempting ""adb reverse"" first. This is especially useful for using SSH tunnels without enabling remote port forwarding.",Add --force-adb-forward,"Add a command-line option to force ""adb forward"", without attempting ""adb reverse"" first. This is especially useful for using SSH tunnels without enabling remote port forwarding."
1230,Fix typo in manpage,,Fix typo in manpage,
1231,Add cli option to set the verbosity level,"The verbosity was set either to info (in release mode) or debug (in debug mode). Add a command-line argument to change it, so that users can enable debug logs using the release: scrcpy -Vdebug",Add cli option to set the verbosity level,"The verbosity was set either to info (in release mode) or debug (in debug mode). Add a command-line argument to change it, so that users can enable debug logs using the release: scrcpy -Vdebug"
1232,Configure server verbosity from the client,Send the requested log level from the client. This paves the way to configure it via a command-line argument.,Configure server verbosity from the client,Send the requested log level from the client. This paves the way to configure it via a command-line argument.
1233,Avoid compiler warning,"The field lock_video_orientation may only take values between -1 and 3 (included). But the compiler may trigger a warning on the sprintf() call, because its type could represent values which could overflow the string (like ""-128""):  warning: %i directive writing between 1 and 4 bytes into a region of size 3 [-Wformat-overflow=]  Increase the buffer size to remove the warning.",Avoid compiler warning,"The field lock_video_orientation may only take values between -1 and 3 (included). But the compiler may trigger a warning on the sprintf() call, because its type could represent values which could overflow the string (like ""-128""): warning: %i directive writing between 1 and 4 bytes into a region of size 3 [-Wformat-overflow=] Increase the buffer size to remove the warning."
1234,Add --codec-options,"Add a command-line parameter to pass custom options to the device encoder (as a comma-separated list of ""key[:type]=value""). The list of possible codec options is available in the Android documentation: https://d.android.com/reference/android/media/MediaFormat PR #1325 https://github.com/Genymobile/scrcpy/pull/1325 Refs #1226 https://github.com/Genymobile/scrcpy/pull/1226 Co-authored-by: Romain Vimont rom@rom1v.com",Add --codec-options,"Add a command-line parameter to pass custom options to the device encoder (as a comma-separated list of ""key[:type]=value""). The list of possible codec options is available in the Android documentation: link PR #1325 link Refs #1226 link Co-authored-by: Romain Vimont rom@rom1v.com"
1235,"Add unit test for big ""set clipboard"" event",Add a unit test to avoid regressions. Refs #1425 https://github.com/Genymobile/scrcpy/issues/1425,"Add unit test for big ""set clipboard"" event",Add a unit test to avoid regressions. Refs #1425 link
1236,"Increase buffer size to fix ""set clipboard"" event","The buffer size must be greater than any event message. Clipboard events may take up to 4096 bytes, so increase the buffer size. Fixes #1425 https://github.com/Genymobile/scrcpy/issues/1425","Increase buffer size to fix ""set clipboard"" event","The buffer size must be greater than any event message. Clipboard events may take up to 4096 bytes, so increase the buffer size. Fixes #1425 link"
1237,Synchronize device clipboard to computer,Automatically synchronize the device clipboard to the computer any time it changes. This allows seamless copy-paste from Android to the computer. Fixes #1056 https://github.com/Genymobile/scrcpy/issues/1056#issuecomment-631363684 PR #1423 https://github.com/Genymobile/scrcpy/pull/1423,Synchronize device clipboard to computer,Automatically synchronize the device clipboard to the computer any time it changes. This allows seamless copy-paste from Android to the computer. Fixes #1056 link PR #1423 link
1238,Remove useless exception declaration,"The interface declares it can throw a RemoteException, but the implementation never throws such exception.",Remove useless exception declaration,"The interface declares it can throw a RemoteException, but the implementation never throws such exception."
1239,Simplify rotation watcher call,Remove unnecessary private method (which was wrongly public).,Simplify rotation watcher call,Remove unnecessary private method (which was wrongly public).
1240,Increase LOD bias for mipmapping,Mipmapping caused too much blurring. Using a LOD bias of -1 instead of -0.5 seems a better compromise to avoid low-quality downscaling while keeping sharp edges in any case. Refs https://github.com/Genymobile/scrcpy/issues/1394 Refs https://github.com/Genymobile/scrcpy/issues/40#issuecomment-591917787,Increase LOD bias for mipmapping,Mipmapping caused too much blurring. Using a LOD bias of -1 instead of -0.5 seems a better compromise to avoid low-quality downscaling while keeping sharp edges in any case. Refs link Refs link
1241,Remove warning when renderer is not OpenGL,"Trilinear filtering can currently only be enabled for OpenGL renderers. Do not print a warning if the renderer is not OpenGL, as it can confuses users, while nothing is wrong.",Remove warning when renderer is not OpenGL,"Trilinear filtering can currently only be enabled for OpenGL renderers. Do not print a warning if the renderer is not OpenGL, as it can confuses users, while nothing is wrong."
1242,Reset window size on initialization,"On macOS with renderer ""metal"", HiDPI scaling may be incorrect on initialization when several displays are connected. Resetting the window size fixes the problem. Refs #15 https://github.com/Genymobile/scrcpy/issues/15",Reset window size on initialization,"On macOS with renderer ""metal"", HiDPI scaling may be incorrect on initialization when several displays are connected. Resetting the window size fixes the problem. Refs #15 link"
1243,Manually position and scale the content,"Position and scale the content ""manually"" instead of relying on the renderer ""logical size"". This avoids possible rounding differences between the computed window size and the content size, causing one row or column of black pixels on the bottom or on the right. This also avoids HiDPI scale issues, by computing the scaling manually. This will also enable to draw items at their expected size on the screen (unscaled). Fixes #15 https://github.com/Genymobile/scrcpy/issues/15",Manually position and scale the content,"Position and scale the content ""manually"" instead of relying on the renderer ""logical size"". This avoids possible rounding differences between the computed window size and the content size, causing one row or column of black pixels on the bottom or on the right. This also avoids HiDPI scale issues, by computing the scaling manually. This will also enable to draw items at their expected size on the screen (unscaled). Fixes #15 link"
1244,Extract optimal window size detection,Extract the computation to detect whether the current size of the window is already optimal. This will allow to reuse it for rendering.,Extract optimal window size detection,Extract the computation to detect whether the current size of the window is already optimal. This will allow to reuse it for rendering.
1245,"Disable ""resize to fit"" in maximized state","In maximized state (but not fullscreen), it was possible to resize to fit the device screen (with Ctrl+x or double-clicking on black borders). This caused problems on macOS with the ""expand to fullscreen"" feature, which behaves like a fullscreen mode but is seen as maximized by SDL. In that state, resizing to fit causes unexpected results. To keep the behavior consistent on all platforms, just disable ""resize to fit"" when the window is maximized.","Disable ""resize to fit"" in maximized state","In maximized state (but not fullscreen), it was possible to resize to fit the device screen (with Ctrl+x or double-clicking on black borders). This caused problems on macOS with the ""expand to fullscreen"" feature, which behaves like a fullscreen mode but is seen as maximized by SDL. In that state, resizing to fit causes unexpected results. To keep the behavior consistent on all platforms, just disable ""resize to fit"" when the window is maximized."
1246,Workaround maximized+fullscreen on Windows,"On Windows, in maximized+fullscreen state, disabling fullscreen mode unexpectedly triggers the ""restored"" then ""maximized"" events, leaving the window in a weird state (maximized according to the events, but not maximized visually). Moreover, apply_pending_resize() asserts that fullscreen is disabled. To avoid the issue, if fullscreen is set, just ignore the ""restored"" event.",Workaround maximized+fullscreen on Windows,"On Windows, in maximized+fullscreen state, disabling fullscreen mode unexpectedly triggers the ""restored"" then ""maximized"" events, leaving the window in a weird state (maximized according to the events, but not maximized visually). Moreover, apply_pending_resize() asserts that fullscreen is disabled. To avoid the issue, if fullscreen is set, just ignore the ""restored"" event."
1247,Simplify size changes in fullscreen or maximized,"If the content size changes (due to rotation for example) while the window is maximized or fullscreen, the resize must be applied once fullscreen and maximized are disabled. The previous strategy consisted in storing the windowed size, computing the target size on rotation, and applying it on window restoration. But tracking the windowed size (while ignoring the non-windowed size) was tricky, due to unspecified order of SDL events (e.g. size changes can be notified before ""maximized"" events), race conditions when reading window flags, different behaviors on different platforms... To simplify the whole resize management, store the old content size (the frame size, possibly rotated) when it changes while the window is maximized or fullscreen, so that the new optimal size can be computed on window restoration.",Simplify size changes in fullscreen or maximized,"If the content size changes (due to rotation for example) while the window is maximized or fullscreen, the resize must be applied once fullscreen and maximized are disabled. The previous strategy consisted in storing the windowed size, computing the target size on rotation, and applying it on window restoration. But tracking the windowed size (while ignoring the non-windowed size) was tricky, due to unspecified order of SDL events (e.g. size changes can be notified before ""maximized"" events), race conditions when reading window flags, different behaviors on different platforms... To simplify the whole resize management, store the old content size (the frame size, possibly rotated) when it changes while the window is maximized or fullscreen, so that the new optimal size can be computed on window restoration."
1248,Factorize window resize,"When the content size changes, either on frame size or client rotation changes, the window must be resized. Factorize for both cases.",Factorize window resize,"When the content size changes, either on frame size or client rotation changes, the window must be resized. Factorize for both cases."
1249,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1250,Fix Windows Ctrl Handler declaration,The handler function signature must include the calling convention declaration. Ref: https://stackoverflow.com/questions/61717439/why-calling-setconsolectrlhandler-triggers-a-warning,Fix Windows Ctrl Handler declaration,The handler function signature must include the calling convention declaration. Ref: link
1251,Reference README.md from localized versions,Mention that the README.md is the only one being up-to-date.,Reference README.md from localized versions,Mention that the README.md is the only one being up-to-date.
1252,Add Brazilian Portuguese translation,Signed-off-by: Romain Vimont rom@rom1v.com,Add Brazilian Portuguese translation,Signed-off-by: Romain Vimont rom@rom1v.com
1253,Properly handle Ctrl+C on Windows,"By default, Ctrl+C just kills the process on Windows. This caused corrupted video files on recording. Handle Ctrl+C properly to clean up properly. Fixes #818 https://github.com/Genymobile/scrcpy/issues/818",Properly handle Ctrl+C on Windows,"By default, Ctrl+C just kills the process on Windows. This caused corrupted video files on recording. Handle Ctrl+C properly to clean up properly. Fixes #818 link"
1254,Send scroll events as a touchscreen,"Scroll events were sent with a mouse input device. When scrolling on a list, this could cause the whole list to be focused, and drawn with the focus color as background. Send scroll events with a touchscreen input device instead (like motion events). Fixes #1362 https://github.com/Genymobile/scrcpy/issues/1362",Send scroll events as a touchscreen,"Scroll events were sent with a mouse input device. When scrolling on a list, this could cause the whole list to be focused, and drawn with the focus color as background. Send scroll events with a touchscreen input device instead (like motion events). Fixes #1362 link"
1255,Improve bug report template,Insert a code block to (hopefully) increase the chances that users format their terminal output.,Improve bug report template,Insert a code block to (hopefully) increase the chances that users format their terminal output.
1256,Add a note about multi-display limitation,Secondary display mirroring is read-only before Android 10.,Add a note about multi-display limitation,Secondary display mirroring is read-only before Android 10.
1257,"Revert ""Improve resizing workaround""","This reverts commit 92cb3a666109b67598cd36b9c0088fb697abbd23, which broke the fullscreen/maximized restoration size on Windows. Fixes #1346 https://github.com/Genymobile/scrcpy/issues/1346","Revert ""Improve resizing workaround""","This reverts commit 92cb3a666109b67598cd36b9c0088fb697abbd23, which broke the fullscreen/maximized restoration size on Windows. Fixes #1346 link"
1258,Simplify ScreenEncoder more,Commit 927d655ff66fa439ccd27e054ae6d54a651640cc removed the iFrameInternal field and constructor argument. Also remove it from createFormat() arguments.,Simplify ScreenEncoder more,Commit 927d655ff66fa439ccd27e054ae6d54a651640cc removed the iFrameInternal field and constructor argument. Also remove it from createFormat() arguments.
1259,Add an option to keep the device awake,Add an option to prevent the device to sleep: scrcpy --stay-awake scrcpy -w  The initial state is restored on exit. Fixes #631 https://github.com/Genymobile/scrcpy/issues/631,Add an option to keep the device awake,Add an option to prevent the device to sleep: scrcpy --stay-awake scrcpy -w The initial state is restored on exit. Fixes #631 link
1260,Reorder options in alphabetical order,,Reorder options in alphabetical order,
1261,"Handle ""show touches"" on the device-side","Now that the server can access the Android settings and clean up properly, handle the ""show touches"" option from the server. The initial state is now correctly restored, even on device disconnection.","Handle ""show touches"" on the device-side","Now that the server can access the Android settings and clean up properly, handle the ""show touches"" option from the server. The initial state is now correctly restored, even on device disconnection."
1262,Move constants to ServiceManager,"PACKAGE_NAME and USER_ID could be use by several ""managers"", so move them to the service manager.",Move constants to ServiceManager,"PACKAGE_NAME and USER_ID could be use by several ""managers"", so move them to the service manager."
1263,Add a clean up process on the device,"In order to clean up on close, use a separate process which is not killed when the device is disconnected (even if the main process itself is killed).",Add a clean up process on the device,"In order to clean up on close, use a separate process which is not killed when the device is disconnected (even if the main process itself is killed)."
1264,Implement access to settings without Context,"Expose methods to access the Android settings using private APIs. This allows to read and write settings values immediately without starting a new process to call ""settings"".",Implement access to settings without Context,"Expose methods to access the Android settings using private APIs. This allows to read and write settings values immediately without starting a new process to call ""settings""."
1265,Apply workarounds only on error,"To avoid NullPointerException on some devices, workarounds have been implemented. But these workaround produce (harmless) internal errors causing exceptions to be printed in the console. To avoid this problem, apply the workarounds only if it fails without them. Fixes #994 https://github.com/Genymobile/scrcpy/issues/994 Refs #365 https://github.com/Genymobile/scrcpy/issues/365 Refs #940 https://github.com/Genymobile/scrcpy/issues/940",Apply workarounds only on error,"To avoid NullPointerException on some devices, workarounds have been implemented. But these workaround produce (harmless) internal errors causing exceptions to be printed in the console. To avoid this problem, apply the workarounds only if it fails without them. Fixes #994 link Refs #365 link Refs #940 link"
1266,Fix AutoAdb url,PR #1344 https://github.com/Genymobile/scrcpy/pull/1344 Signed-off-by: Romain Vimont rom@rom1v.com,Fix AutoAdb url,PR #1344 link Signed-off-by: Romain Vimont rom@rom1v.com
1267,Update links to v1.13 in README and BUILD,,Update links to v1.13 in README and BUILD,
1268,Bump version to 1.13,,Bump version to 1.13,
1269,Upgrade SDL (2.0.12) for Windows,Include the latest version of SDL in Windows releases.,Upgrade SDL (2.0.12) for Windows,Include the latest version of SDL in Windows releases.
1270,Upgrade FFmpeg (4.2.2) for Windows,Include the latest version of FFmpeg in Windows releases.,Upgrade FFmpeg (4.2.2) for Windows,Include the latest version of FFmpeg in Windows releases.
1271,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1272,Fix typo in comments,,Fix typo in comments,
1273,Stabilize auto-resize,"The window dimensions are integers, so resizing to fit the content may not be exact. When computing the optimal size, it could cause to reduce alternatively the width and height by few pixels, making the ""optimal size"" unstable. To avoid this problem, check if the optimal size is already correct either by keeping the width or the height.",Stabilize auto-resize,"The window dimensions are integers, so resizing to fit the content may not be exact. When computing the optimal size, it could cause to reduce alternatively the width and height by few pixels, making the ""optimal size"" unstable. To avoid this problem, check if the optimal size is already correct either by keeping the width or the height."
1274,Improve resizing workaround,"Call the same method as when the event is received on the event loop, so that the behavior is the same in both cases.",Improve resizing workaround,"Call the same method as when the event is received on the event loop, so that the behavior is the same in both cases."
1275,Mention Ubuntu 20.04 package,"Ubuntu 20.04 has been released today, and scrcpy is available in their repositories: https://packages.ubuntu.com/focal/scrcpy",Mention Ubuntu 20.04 package,"Ubuntu 20.04 has been released today, and scrcpy is available in their repositories: link"
1276,Move rotation coordinates to screen,Move the window-to-frame coordinates conversion from the input manager to the screen. This will allow to apply more screen-related transformations without impacting the input manager.,Move rotation coordinates to screen,Move the window-to-frame coordinates conversion from the input manager to the screen. This will allow to apply more screen-related transformations without impacting the input manager.
1277,Log new size on auto-resize request,"On ""resize to fit"" and ""resize to pixel-perfect"", log the new size.",Log new size on auto-resize request,"On ""resize to fit"" and ""resize to pixel-perfect"", log the new size."
1278,Use MediaFormat constant for MIME type,"Replace ""video/avc"" by MIMETYPE_VIDEO_AVC. Signed-off-by: Romain Vimont rom@rom1v.com",Use MediaFormat constant for MIME type,"Replace ""video/avc"" by MIMETYPE_VIDEO_AVC. Signed-off-by: Romain Vimont rom@rom1v.com"
1279,Fix touch coordinates on rotated display,The touch coordinates were not rotated.,Fix touch coordinates on rotated display,The touch coordinates were not rotated.
1280,Disable input events when necessary,"Disable input events on secondary displays before Android 10, even if FLAG_PRESENTATION is not set. Refs #1288 https://github.com/Genymobile/scrcpy/issues/1288",Disable input events when necessary,"Disable input events on secondary displays before Android 10, even if FLAG_PRESENTATION is not set. Refs #1288 link"
1281,Mention mipmapping in FAQ,,Mention mipmapping in FAQ,
1282,Add option --no-mipmaps,Add an option to disable trilinear filtering even if mipmapping is available.,Add option --no-mipmaps,Add an option to disable trilinear filtering even if mipmapping is available.
1283,Enable trilinear filtering for OpenGL,Improve downscaling quality if mipmapping is available. Suggested-by: Giumo Clanjor (/) cjxgm2@gmail.com Fixes #40 https://github.com/Genymobile/scrcpy/issues/40 Ref: https://github.com/Genymobile/scrcpy/issues/40#issuecomment-591917787,Enable trilinear filtering for OpenGL,Improve downscaling quality if mipmapping is available. Suggested-by: Giumo Clanjor (/) cjxgm2@gmail.com Fixes #40 link Ref: link
1284,Add --render-driver command-line option,Add an option to set a render driver hint (SDL_HINT_RENDER_DRIVER).,Add --render-driver command-line option,Add an option to set a render driver hint (SDL_HINT_RENDER_DRIVER).
1285,Fix typo in README,,Fix typo in README,
1286,Require Meson 0.48 to get rid of warnings,"Debian buster (stable) provides Meson 0.49, which is also available in stretch (oldstable) backports. It's time to abandon Meson 0.37. Ref: 20b3f101a40cd7455cc5b41e381291504deec5ba",Require Meson 0.48 to get rid of warnings,"Debian buster (stable) provides Meson 0.49, which is also available in stretch (oldstable) backports. It's time to abandon Meson 0.37. Ref: 20b3f101a40cd7455cc5b41e381291504deec5ba"
1287,Rename max length constant for text injection,"To avoid confusion with the max text size for clipboard, rename the constant limiting the text injection length.",Rename max length constant for text injection,"To avoid confusion with the max text size for clipboard, rename the constant limiting the text injection length."
1288,Workaround compiler warning,Some compilers warns on uninitialized value in impossible case: warning: variable 'result' is used uninitialized whenever switch default is taken [-Wsometimes-uninitialized],Workaround compiler warning,Some compilers warns on uninitialized value in impossible case: warning: variable 'result' is used uninitialized whenever switch default is taken [-Wsometimes-uninitialized]
1289,Add missing include string.h,Include  for strdup() and strtok_r().,Add missing include string.h,Include  for strdup() and strtok_r().
1290,Fix log format warning,"The expression port + 1 is promoted to int, but printed as uint16_t.",Fix log format warning,"The expression port + 1 is promoted to int, but printed as uint16_t."
1291,Simplify ScreenEncoder,"Do not handle iFrameInterval field and parameter, it is never used dynamically.",Simplify ScreenEncoder,"Do not handle iFrameInterval field and parameter, it is never used dynamically."
1292,Remove unused lockedVideoOrientation field,"During PR #1151, this field has been moved to ScreenInfo, but has not been removed from ScreenEncoder.",Remove unused lockedVideoOrientation field,"During PR #1151, this field has been moved to ScreenInfo, but has not been removed from ScreenEncoder."
1293,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1294,Reorder options in alphabetical order,,Reorder options in alphabetical order,
1295,Fix double click on rotated display,A double-click outside the device content (in the black borders) resizes so that black borders are removed. But the display rotation was not taken into account to detect the content. Use the content size instead of the frame size to fix the issue. Ref: https://github.com/Genymobile/scrcpy/issues/898#issuecomment-610993695,Fix double click on rotated display,A double-click outside the device content (in the black borders) resizes so that black borders are removed. But the display rotation was not taken into account to detect the content. Use the content size instead of the frame size to fix the issue. Ref: link
1296,Remap event positions on rotated display,"If the display is rotated, the position of clicks must be adapted.",Remap event positions on rotated display,"If the display is rotated, the position of clicks must be adapted."
1297,Store rotated content size,This avoids to compute it every time from the frame size.,Store rotated content size,This avoids to compute it every time from the frame size.
1298,Register rotation watcher on selected display,PR #1275 https://github.com/Genymobile/scrcpy/pull/1275 Signed-off-by: Kostiantyn Luzan vblack2006@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com,Register rotation watcher on selected display,PR #1275 link Signed-off-by: Kostiantyn Luzan vblack2006@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com
1299,Suppress DiscouragedPrivateApi lint warning,,Suppress DiscouragedPrivateApi lint warning,
1300,Remove --fullscreen validation,"Many options are meaningless if --no-display is set. We don't want to validate all possible combinations, so don't make an exception for --fullscreen.",Remove --fullscreen validation,"Many options are meaningless if --no-display is set. We don't want to validate all possible combinations, so don't make an exception for --fullscreen."
1301,Improve documentation for consistency,Make --lock-video-orientation documentation consistent with that of --rotation.,Improve documentation for consistency,Make --lock-video-orientation documentation consistent with that of --rotation.
1302,Add --rotation command-line option,"In addition to Ctrl+Left and Ctrl+Right shortcuts, add a command-line parameter to set the initial rotation.",Add --rotation command-line option,"In addition to Ctrl+Left and Ctrl+Right shortcuts, add a command-line parameter to set the initial rotation."
1303,Add shortcuts to rotate display,"Add Ctrl+Left and Ctrl+Right shortcuts to rotate the display (the content of the scrcpy window). Contrary to --lock-video-orientation, the rotation has no impact on recording, and can be changed dynamically (and immediately). Fixes #218 https://github.com/Genymobile/scrcpy/issues/218",Add shortcuts to rotate display,"Add Ctrl+Left and Ctrl+Right shortcuts to rotate the display (the content of the scrcpy window). Contrary to --lock-video-orientation, the rotation has no impact on recording, and can be changed dynamically (and immediately). Fixes #218 link"
1304,Format shortcut documentation,"For consistency, start the descriptions with a capital letter.",Format shortcut documentation,"For consistency, start the descriptions with a capital letter."
1305,Add a note about prebuilt server in BUILD.md,Mention that it works with a matching client version.,Add a note about prebuilt server in BUILD.md,Mention that it works with a matching client version.
1306,Explain master and dev branches in BUILD,People may not guess that master is not the development branch.,Explain master and dev branches in BUILD,People may not guess that master is not the development branch.
1307,"Improve ""low quality"" section in FAQ",,"Improve ""low quality"" section in FAQ",
1308,Add Android device and version in issue template,,Add Android device and version in issue template,
1309,Add issue templates,Closes #1157 https://github.com/Genymobile/scrcpy/issues/1157,Add issue templates,Closes #1157 link
1310,gitignore: Add x/ directory,People following default build instructions can be caught off guard by seeing the build artifacts in the git tree. Signed-off-by: Harsh Shandilya me@msfjarvis.dev Signed-off-by: Romain Vimont rom@rom1v.com,gitignore: Add x/ directory,People following default build instructions can be caught off guard by seeing the build artifacts in the git tree. Signed-off-by: Harsh Shandilya me@msfjarvis.dev Signed-off-by: Romain Vimont rom@rom1v.com
1311,Update to Gradle 6.3,Signed-off-by: Harsh Shandilya me@msfjarvis.dev Signed-off-by: Romain Vimont rom@rom1v.com -- Note from committer: The binary gradle/wrapper/gradle-wrapper.jar has the expected SHA-256 checksum: $ curl -L https://services.gradle.org/distributions/gradle-6.3-wrapper.jar.sha256 1cef53de8dc192036e7b0cc47584449b0cf570a00d560bfaa6c9eabe06e1fc06  All the changed files match an upgrade executed independently: https://docs.gradle.org/current/userguide/gradle_wrapper.html#sec:upgrading_wrapper,Update to Gradle 6.3,Signed-off-by: Harsh Shandilya me@msfjarvis.dev Signed-off-by: Romain Vimont rom@rom1v.com -- Note from committer: The binary gradle/wrapper/gradle-wrapper.jar has the expected SHA-256 checksum: $ curl -L link 1cef53de8dc192036e7b0cc47584449b0cf570a00d560bfaa6c9eabe06e1fc06 All the changed files match an upgrade executed independently: link
1312,Update to AGP 3.6.2,Signed-off-by: Harsh Shandilya me@msfjarvis.dev,Update to AGP 3.6.2,Signed-off-by: Harsh Shandilya me@msfjarvis.dev
1313,Replace SDL_Atomic by stdatomic from C11,There is no reason to use SDL atomics.,Replace SDL_Atomic by stdatomic from C11,There is no reason to use SDL atomics.
1314,Do not log success on failure,"If calling the private API does not work, an exception is printed. In that case, do not log that the action succeeded.",Do not log success on failure,"If calling the private API does not work, an exception is printed. In that case, do not log that the action succeeded."
1315,Do not warn on terminating the server,"If the server is already dead, terminating it fails. This is expected.",Do not warn on terminating the server,"If the server is already dead, terminating it fails. This is expected."
1316,Do not block on accept() if server died,"The server may die before connecting to the client. In that case, the client was blocked indefinitely (until Ctrl+C) on accept(). To avoid the problem, close the server socket once the server process is dead.",Do not block on accept() if server died,"The server may die before connecting to the client. In that case, the client was blocked indefinitely (until Ctrl+C) on accept(). To avoid the problem, close the server socket once the server process is dead."
1317,Wait server from a separate thread,Create a thread just to wait for the server process exit. This paves the way to simply wake up a blocking accept() in a portable way.,Wait server from a separate thread,Create a thread just to wait for the server process exit. This paves the way to simply wake up a blocking accept() in a portable way.
1318,Refactor server_start() error handling,This avoids cleanup duplication.,Refactor server_start() error handling,This avoids cleanup duplication.
1319,Add display id parameter,Add --display command line parameter to specify a display id. PR #1238 https://github.com/Genymobile/scrcpy/pull/1238 Signed-off-by: Romain Vimont rom@rom1v.com,Add display id parameter,Add --display command line parameter to specify a display id. PR #1238 link Signed-off-by: Romain Vimont rom@rom1v.com
1320,Remove MagicNumber checkstyle,"There are a lot of ""magic numbers"" that we really don't want to extract as a constant. Until now, many @SuppressWarnings annotations were added, but it makes no sense to check for magic number if we silent the warnings everywhere.",Remove MagicNumber checkstyle,"There are a lot of ""magic numbers"" that we really don't want to extract as a constant. Until now, many @SuppressWarnings annotations were added, but it makes no sense to check for magic number if we silent the warnings everywhere."
1321,Log device details on server start,,Log device details on server start,
1322,Fix static_assert() parameters,"In C11, static_assert() expects a message.",Fix static_assert() parameters,"In C11, static_assert() expects a message."
1323,Accept negative window position,It seems to work on some window managers. Fixes #1242 https://github.com/Genymobile/scrcpy/issues/1242,Accept negative window position,It seems to work on some window managers. Fixes #1242 link
1324,Add tests for control message length,This will avoid regressions for #1245. https://github.com/Genymobile/scrcpy/issues/1245,Add tests for control message length,This will avoid regressions for #1245. link
1325,Fix expected message length for touch events,"The expected length for a touch event control message was incorrect. As a consequence, a BufferUnderflowException could occur. Fixes #1245 https://github.com/Genymobile/scrcpy/issues/1245",Fix expected message length for touch events,"The expected length for a touch event control message was incorrect. As a consequence, a BufferUnderflowException could occur. Fixes #1245 link"
1326,Remove unused constant,It has not been removed when mouse and touch events have been merged.,Remove unused constant,It has not been removed when mouse and touch events have been merged.
1327,Fix the printed versions (were opposite),PR #1224 https://github.com/Genymobile/scrcpy/pull/1224 Signed-off-by: Romain Vimont rom@rom1v.com,Fix the printed versions (were opposite),PR #1224 link Signed-off-by: Romain Vimont rom@rom1v.com
1328,Improve FAQ,,Improve FAQ,
1329,Mention AutoAdb in README,,Mention AutoAdb in README,
1330,Fix server debugger for Android >= 9,Add a compilation flag to select the debugger method to use:  - old: Android < 9  - new: Android >= 9 See https://github.com/Genymobile/scrcpy/issues/1187#issuecomment-599075661,Fix server debugger for Android >= 9,Add a compilation flag to select the debugger method to use:  - old: Android < 9  - new: Android >= 9 See link
1331,Handle NumPad events when NumLock is disabled,PR #1188 https://github.com/Genymobile/scrcpy/pull/1188 Fixes #1048 https://github.com/Genymobile/scrcpy/issues/1048 Signed-off-by: Romain Vimont rom@rom1v.com,Handle NumPad events when NumLock is disabled,PR #1188 link Fixes #1048 link Signed-off-by: Romain Vimont rom@rom1v.com
1332,Add scoop instructions for Windows,PR #1202 https://github.com/Genymobile/scrcpy/pull/1202 Signed-off-by: Romain Vimont rom@rom1v.com,Add scoop instructions for Windows,PR #1202 link Signed-off-by: Romain Vimont rom@rom1v.com
1333,Simplify Chocolatey documentation,,Simplify Chocolatey documentation,
1334,Handle locked video orientation from ScreenInfo,Centralize video size management in ScreenInfo. This allows to always send the correct initial video size to the client if the video orientation is locked.,Handle locked video orientation from ScreenInfo,Centralize video size management in ScreenInfo. This allows to always send the correct initial video size to the client if the video orientation is locked.
1335,"Rename ""rotation"" to ""device rotation""",This paves the way to reduce confusion in ScreenInfo when it will handle locked video orientation.,"Rename ""rotation"" to ""device rotation""",This paves the way to reduce confusion in ScreenInfo when it will handle locked video orientation.
1336,Compute all screen info from ScreenInfo,Screen information was partially initialized from Device. Move this initialization to ScreenInfo.,Compute all screen info from ScreenInfo,Screen information was partially initialized from Device. Move this initialization to ScreenInfo.
1337,Remove useles import,,Remove useles import,
1338,Remove link to Windows 32 bits release,"Binaries created with MinGW (even a simple Hello World) are detected as malware by some anti-virus. For some reason, only the 32 bits version of scrcpy is impacted. Since users should use the 64 bits version by default anyway, remove the link to the 32 bits version from the main page. The 32 bits release is still available in the ""releases"" tab. See https://github.com/Genymobile/scrcpy/issues/1102",Remove link to Windows 32 bits release,"Binaries created with MinGW (even a simple Hello World) are detected as malware by some anti-virus. For some reason, only the 32 bits version of scrcpy is impacted. Since users should use the 64 bits version by default anyway, remove the link to the 32 bits version from the main page. The 32 bits release is still available in the ""releases"" tab. See link"
1339,Show a friendly hint for adb installation,Signed-off-by: Romain Vimont rom@rom1v.com,Show a friendly hint for adb installation,Signed-off-by: Romain Vimont rom@rom1v.com
1340,Add option to lock video orientation,PR #1151 https://github.com/Genymobile/scrcpy/pull/1151 Signed-off-by: Romain Vimont rom@rom1v.com,Add option to lock video orientation,PR #1151 link Signed-off-by: Romain Vimont rom@rom1v.com
1341,Retrieve screen info once,"The method getScreenInfo() is synchronized, and the result may change between calls. Call it once and store the result in a local variable.",Retrieve screen info once,"The method getScreenInfo() is synchronized, and the result may change between calls. Call it once and store the result in a local variable."
1342,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1343,Use linear filtering,Anisotropic filtering makes no sense for scrcpy use case. This (semantically) reverts 9e328ef98b0fc730036aa389f33649a31737d0e3.,Use linear filtering,Anisotropic filtering makes no sense for scrcpy use case. This (semantically) reverts 9e328ef98b0fc730036aa389f33649a31737d0e3.
1344,Documentation rectifications,PR #1151 https://github.com/Genymobile/scrcpy/pull/1151 Signed-off-by: Romain Vimont rom@rom1v.com,Documentation rectifications,PR #1151 link Signed-off-by: Romain Vimont rom@rom1v.com
1345,Add Chocolatey for Windows install,PR #1144 https://github.com/Genymobile/scrcpy/pull/1144 Signed-off-by: Romain Vimont rom@rom1v.com,Add Chocolatey for Windows install,PR #1144 link Signed-off-by: Romain Vimont rom@rom1v.com
1346,Indicate that -s can also be used for TCP/IP,,Indicate that -s can also be used for TCP/IP,
1347,Mention scrcpy Debian package in README,,Mention scrcpy Debian package in README,
1348,Happy new year 2020!,,Happy new year 2020!,
1349,Do not report workarounds errors,"Some workarounds are needed on some devices. But applying them may cause exceptions on other devices, where they are not necessary anyway. Do not report these errors in release builds. Closes #994 https://github.com/Genymobile/scrcpy/issues/994",Do not report workarounds errors,"Some workarounds are needed on some devices. But applying them may cause exceptions on other devices, where they are not necessary anyway. Do not report these errors in release builds. Closes #994 link"
1350,Accept port range,"Accept a range of ports to listen to, so that it does not fail if another instance of scrcpy is currently starting. The range can be passed via the command line: scrcpy -p 27183:27186 scrcpy -p 27183  # implicitly 27183:27183, as before  The default is 27183:27199. Closes #951 https://github.com/Genymobile/scrcpy/issues/951",Accept port range,"Accept a range of ports to listen to, so that it does not fail if another instance of scrcpy is currently starting. The range can be passed via the command line: scrcpy -p 27183:27186 scrcpy -p 27183  # implicitly 27183:27183, as before The default is 27183:27199. Closes #951 link"
1351,Add util function to parse a list of integers,This will help parsing arguments like '1234:5678' into a list of integers.,Add util function to parse a list of integers,This will help parsing arguments like '1234:5678' into a list of integers.
1352,Refactor server tunnel initialization,"Start the server socket in enable_tunnel() directly. For the caller point of view, enabling the tunnel opens a port (either the server socket locally or the ""adb forward"" process).",Refactor server tunnel initialization,"Start the server socket in enable_tunnel() directly. For the caller point of view, enabling the tunnel opens a port (either the server socket locally or the ""adb forward"" process)."
1353,Reorder functions,Move functions so that they can be called from enable_tunnel() (in the following commit).,Reorder functions,Move functions so that they can be called from enable_tunnel() (in the following commit).
1354,Fix include order,,Fix include order,
1355,Accept --max-fps before Android 10,KEY_MAX_FPS_TO_ENCODER existed privately before Android 10: https://github.com/Genymobile/scrcpy/issues/488#issuecomment-567321437,Accept --max-fps before Android 10,KEY_MAX_FPS_TO_ENCODER existed privately before Android 10: link
1356,Simplify net.c,"The platform-specific code for net.c was implemented in sys/*/net.c. But the differences are quite limited, so use ifdef-blocks in the single net.c instead.",Simplify net.c,"The platform-specific code for net.c was implemented in sys/*/net.c. But the differences are quite limited, so use ifdef-blocks in the single net.c instead."
1357,Merge pull request #1002 into dev,Fix utf-8 char path in windows https://github.com/Genymobile/scrcpy/pull/1002,Merge pull request #1002 into dev,Fix utf-8 char path in windows link
1358,Get env in windows correctly,Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com,Get env in windows correctly,Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com
1359,Fix utf-8 char path in windows,"The file 'E:\\scrcpy-win64-v1.12.1-1-g31bd950\scrcpy-server' exists, however, it will show msg as follow: INFO: scrcpy 1.12.1 <https://github.com/Genymobile/scrcpy> stat: No such file or directory ERROR: 'E:\\scrcpy-win64-v1.12.1-1-g31bd950\scrcpy-server' does not exist or is not a regular file Press any key to continue...  This patch fixes it. Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com",Fix utf-8 char path in windows,"The file 'E:\\scrcpy-win64-v1.12.1-1-g31bd950\scrcpy-server' exists, however, it will show msg as follow: INFO: scrcpy 1.12.1 <link stat: No such file or directory ERROR: 'E:\\scrcpy-win64-v1.12.1-1-g31bd950\scrcpy-server' does not exist or is not a regular file Press any key to continue... This patch fixes it. Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com"
1360,Fix memory leak on portable builds,"The function get_server_path() sometimes returned an owned string, sometimes a non-owned string. Always return an allocated (owned) string, and free it after usage.",Fix memory leak on portable builds,"The function get_server_path() sometimes returned an owned string, sometimes a non-owned string. Always return an allocated (owned) string, and free it after usage."
1361,Update links to v1.12.1 in README and BUILD,,Update links to v1.12.1 in README and BUILD,
1362,Bump version to 1.12.1,,Bump version to 1.12.1,
1363,Limit bitrate range to 31 bits integer,"A proper solution could be to use ""long long"" instead (guaranteed to be at least 64 bits), but it adds its own problems (e.g. ""%lld"" is not supported as a printf format on all platforms). In practice, we don't need such high values, so keep it simple. Fixes #995 https://github.com/Genymobile/scrcpy/issues/995",Limit bitrate range to 31 bits integer,"A proper solution could be to use ""long long"" instead (guaranteed to be at least 64 bits), but it adds its own problems (e.g. ""%lld"" is not supported as a printf format on all platforms). In practice, we don't need such high values, so keep it simple. Fixes #995 link"
1364,Update links to v1.12 in README and BUILD,,Update links to v1.12 in README and BUILD,
1365,Bump version to 1.12,,Bump version to 1.12,
1366,Do not build tests in release mode,"Assertions would not be executed. And as a side effect, it causes ""unused variable"" warnings.",Do not build tests in release mode,"Assertions would not be executed. And as a side effect, it causes ""unused variable"" warnings."
1367,Define SDL_MAIN_HANDLED in all tests,"Each test defines its own main() function. If this flag is not set, then SDL redefines it to SDL_main(), causing compilation failures.",Define SDL_MAIN_HANDLED in all tests,"Each test defines its own main() function. If this flag is not set, then SDL redefines it to SDL_main(), causing compilation failures."
1368,Fix meson.build codestyle,,Fix meson.build codestyle,
1369,Describe screen rotation shortcut in README,,Describe screen rotation shortcut in README,
1370,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1371,Configure log priority early,"The log priority must be configured before parsing command-line arguments, in order to get logs as expected.",Configure log priority early,"The log priority must be configured before parsing command-line arguments, in order to get logs as expected."
1372,Add missing consts,String parsing functions should not be able to modify their input.,Add missing consts,String parsing functions should not be able to modify their input.
1373,Use ARRAY_LEN() macro in tests,,Use ARRAY_LEN() macro in tests,
1374,Add tests for command-line parsing,,Add tests for command-line parsing,
1375,Move command-line parsing to a separate file,,Move command-line parsing to a separate file,
1376,Factorize integer argument parsing,"Add util functions for integer parsing (with tests), and factorize integer argument parsing to avoid code duplication.",Factorize integer argument parsing,"Add util functions for integer parsing (with tests), and factorize integer argument parsing to avoid code duplication."
1377,Refuse to push a non-regular file server,"If SCRCPY_SERVER_PATH points to a directory, then a directory will be pushed to /data/local/tmp/scrcpy-server.jar. When executing it, app_process will just abort and leave the directory on the device, causing scrcpy to always fail. To avoid the problem, check that the server is a regular file before pushing it. Closes #956 https://github.com/Genymobile/scrcpy/issues/956",Refuse to push a non-regular file server,"If SCRCPY_SERVER_PATH points to a directory, then a directory will be pushed to /data/local/tmp/scrcpy-server.jar. When executing it, app_process will just abort and leave the directory on the device, causing scrcpy to always fail. To avoid the problem, check that the server is a regular file before pushing it. Closes #956 link"
1378,Fix test compilation on mingw,Including SDL2/SDL.h redefines main to SDL_main by default.,Fix test compilation on mingw,Including SDL2/SDL.h redefines main to SDL_main by default.
1379,Fix checkstyle warning,,Fix checkstyle warning,
1380,Add shortcut to rotate screen,"On Ctrl+r, disable auto-rotation (if enabled), set the screen rotation and re-enable auto-rotation (if it was enabled). Closes #11 https://github.com/Genymobile/scrcpy/issues/11",Add shortcut to rotate screen,"On Ctrl+r, disable auto-rotation (if enabled), set the screen rotation and re-enable auto-rotation (if it was enabled). Closes #11 link"
1381,Refactor wrappers for Android SDK classes,"Internally, a failure to invoke a method via reflection was partially managed using exceptions, partially using a null return value. Handle all errors at the same place, by not catching NoSuchMethodException too early.",Refactor wrappers for Android SDK classes,"Internally, a failure to invoke a method via reflection was partially managed using exceptions, partially using a null return value. Handle all errors at the same place, by not catching NoSuchMethodException too early."
1382,Try new methods before legacy ones,Use the legacy methods when the new ones do not exist.,Try new methods before legacy ones,Use the legacy methods when the new ones do not exist.
1383,Merge pull request #967 into dev,Add some tests https://github.com/Genymobile/scrcpy/pull/967,Merge pull request #967 into dev,Add some tests link
1384,Correct coding style,Signed-off-by: Yu-Chen Lin npes87184@gmail.com,Correct coding style,Signed-off-by: Yu-Chen Lin npes87184@gmail.com
1385,Add test_buffer_util,Signed-off-by: Yu-Chen Lin npes87184@gmail.com,Add test_buffer_util,Signed-off-by: Yu-Chen Lin npes87184@gmail.com
1386,Add test_strquote,Signed-off-by: Yu-Chen Lin npes87184@gmail.com,Add test_strquote,Signed-off-by: Yu-Chen Lin npes87184@gmail.com
1387,"Fix ""natural scrolling"""," Movements down (scroll backward) generate negative y values and up (scroll forward) generate positive y values. If direction is SDL_MOUSEWHEEL_FLIPPED the values in x and y will be opposite. Multiply by -1 to change them back.  https://wiki.libsdl.org/SDL_MouseWheelEvent#Remarks The x and y values already take the scrolling configuration into account. Reversing the values when the direction is flipped cancels the scrolling configuration. Therefore, just ignore the direction field. Fixes https://github.com/Genymobile/scrcpy/issues/966","Fix ""natural scrolling""","Movements down (scroll backward) generate negative y values and up (scroll forward) generate positive y values. If direction is SDL_MOUSEWHEEL_FLIPPED the values in x and y will be opposite. Multiply by -1 to change them back. link The x and y values already take the scrolling configuration into account. Reversing the values when the direction is flipped cancels the scrolling configuration. Therefore, just ignore the direction field. Fixes link"
1388,Update BUILD.md to install adb package,PR https://github.com/Genymobile/scrcpy/pull/965 Signed-off-by: Romain Vimont rom@rom1v.com,Update BUILD.md to install adb package,PR link Signed-off-by: Romain Vimont rom@rom1v.com
1389,Fix max size default value,Suggested-by: jurkov Closes https://github.com/Genymobile/scrcpy/issues/978,Fix max size default value,Suggested-by: jurkov Closes link
1390,Suggest workaround for error 0xfffffc0e,"When the hardware encoder is not able to encode at the given definition, it fails with an error 0xfffffc0e. It is documented in the FAQ: https://github.com/Genymobile/scrcpy/blob/master/FAQ.md#i-get-an-error-could-not-open-video-stream But it is better to directly suggest the workaround in the console.",Suggest workaround for error 0xfffffc0e,"When the hardware encoder is not able to encode at the given definition, it fails with an error 0xfffffc0e. It is documented in the FAQ: link But it is better to directly suggest the workaround in the console."
1391,Use virtual device id to avoid NPE,Inject mouse events using id -1 (virtual device) instead of 0 which does not exist (and causes the InputDevice to be null). Fixes https://github.com/Genymobile/scrcpy/issues/962,Use virtual device id to avoid NPE,Inject mouse events using id -1 (virtual device) instead of 0 which does not exist (and causes the InputDevice to be null). Fixes link
1392,Assert return value of mutex functions,"Mutex functions may only fail due to a programming error. Use assertions in debug builds, and ignore the value in release builds.",Assert return value of mutex functions,"Mutex functions may only fail due to a programming error. Use assertions in debug builds, and ignore the value in release builds."
1393,Remove unused includes,No mutex is used in decoder.c and stream.c.,Remove unused includes,No mutex is used in decoder.c and stream.c.
1394,Replace SDL_assert() by assert(),SDL_assert() open a dialog on assertion failure. There is no reason not to use assert() directly.,Replace SDL_assert() by assert(),SDL_assert() open a dialog on assertion failure. There is no reason not to use assert() directly.
1395,Replace BUILD_DEBUG by NDEBUG,"Use the ""standard"" NDEBUG definition, which is used by assert().",Replace BUILD_DEBUG by NDEBUG,"Use the ""standard"" NDEBUG definition, which is used by assert()."
1396,Remove path argument from cmd_execute(),It is always equal to argv[0] (or not used on Windows).,Remove path argument from cmd_execute(),It is always equal to argv[0] (or not used on Windows).
1397,Fix warnings on Windows,fix warnings reported with -Dwarning_level=2 on Windows.,Fix warnings on Windows,fix warnings reported with -Dwarning_level=2 on Windows.
1398,Fix windows build,"Utilities have been moved to util/, but includes had not been updated in Windows-specific files. Ref: dfd0707a2925e9569aaa2ae6b88b161a12376a49",Fix windows build,"Utilities have been moved to util/, but includes had not been updated in Windows-specific files. Ref: dfd0707a2925e9569aaa2ae6b88b161a12376a49"
1399,Fix manpage format,,Fix manpage format,
1400,Compile with warning_level=2 by default,,Compile with warning_level=2 by default,
1401,Fix warnings,Fix warnings reported with -Dwarning_level=2.,Fix warnings,Fix warnings reported with -Dwarning_level=2.
1402,Reformat Java code,Reformated by Android studio to match the 150 characters column defined in checkstyle.,Reformat Java code,Reformated by Android studio to match the 150 characters column defined in checkstyle.
1403,Initialize Application object to avoid NPE,"When an ApplicationInfo is set (commit 90293240cc622bb58cb1de741f86cbc0889c03e8), some devices (Nvidia Shield TV) attempt to access the Application object, causing a NullPointerException. As a workaround, initialize an Application object. Fixes https://github.com/Genymobile/scrcpy/issues/940",Initialize Application object to avoid NPE,"When an ApplicationInfo is set (commit 90293240cc622bb58cb1de741f86cbc0889c03e8), some devices (Nvidia Shield TV) attempt to access the Application object, causing a NullPointerException. As a workaround, initialize an Application object. Fixes link"
1404,Rename variable for consistency,"Use suffix ""Field"" for fields variables.",Rename variable for consistency,"Use suffix ""Field"" for fields variables."
1405,Move utilities to util/,,Move utilities to util/,
1406,Add Korean translation for README and FAQ,PR https://github.com/Genymobile/scrcpy/pull/934 Signed-off-by: Romain Vimont rom@rom1v.com,Add Korean translation for README and FAQ,PR link Signed-off-by: Romain Vimont rom@rom1v.com
1407,Restore the .jar extension on the device side,"Commit 3da95b52bd21ae0f4d81ee933caea63b78191deb renamed 'scrcpy-server.jar' to 'scrcpy-server' to avoid issues on the client side. However, removing the extension may cause issues with app_process, so restore the extension only on the device side. Fixes https://github.com/Genymobile/scrcpy/issues/944",Restore the .jar extension on the device side,"Commit 3da95b52bd21ae0f4d81ee933caea63b78191deb renamed 'scrcpy-server.jar' to 'scrcpy-server' to avoid issues on the client side. However, removing the extension may cause issues with app_process, so restore the extension only on the device side. Fixes link"
1408,Use the existing constants for device server path,,Use the existing constants for device server path,
1409,Fix aidl option in build_without_gradle.sh,Debian's aidl complains about the missing path for -o option. Signed-off-by: Romain Vimont rom@rom1v.com,Fix aidl option in build_without_gradle.sh,Debian's aidl complains about the missing path for -o option. Signed-off-by: Romain Vimont rom@rom1v.com
1410,Update links to v1.11 in README and BUILD,,Update links to v1.11 in README and BUILD,
1411,Bump version to 1.11,,Bump version to 1.11,
1412,Upgrade platform-tools (29.0.5) for Windows,Include the latest version of adb in Windows releases.,Upgrade platform-tools (29.0.5) for Windows,Include the latest version of adb in Windows releases.
1413,Upgrade FFmpeg (4.2.1) for Windows,Include the latest version of FFmpeg in Windows releases.,Upgrade FFmpeg (4.2.1) for Windows,Include the latest version of FFmpeg in Windows releases.
1414,Remove deprecated options from help and manpage,Ref: ff061b4f30c54dedc5073a588c6c697477b805db,Remove deprecated options from help and manpage,Ref: ff061b4f30c54dedc5073a588c6c697477b805db
1415,Fix help for --window-width and --window-height,"The default value is 0 (automatic), not -1.",Fix help for --window-width and --window-height,"The default value is 0 (automatic), not -1."
1416,Document scrcpy via SSH tunnel in README,,Document scrcpy via SSH tunnel in README,
1417,Document copy-paste and --prefer-text in README,,Document copy-paste and --prefer-text in README,
1418,Reorganize features in README,,Reorganize features in README,
1419,Fix meizu 16th NPE,Fill AppInfo to avoid NullPointerException on some devices. Fixes https://github.com/Genymobile/scrcpy/issues/365 Signed-off-by: Romain Vimont rom@rom1v.com,Fix meizu 16th NPE,Fill AppInfo to avoid NullPointerException on some devices. Fixes link Signed-off-by: Romain Vimont rom@rom1v.com
1420,Move workarounds to a separate class,Extract workarounds (currently only one) to a separate class to avoid polluting the main code.,Move workarounds to a separate class,Extract workarounds (currently only one) to a separate class to avoid polluting the main code.
1421,Fix noconsole.exe,"The linker flag ""-mwindows"" has no effect on my current MinGW. Instead, passing ""-Wl,--subsystem,windows"" works. Fixes https://github.com/Genymobile/scrcpy/issues/691",Fix noconsole.exe,"The linker flag ""-mwindows"" has no effect on my current MinGW. Instead, passing ""-Wl,--subsystem,windows"" works. Fixes link"
1422,Fix typos,PR https://github.com/Genymobile/scrcpy/pull/927 Signed-off-by: Romain Vimont rom@rom1v.com,Fix typos,PR link Signed-off-by: Romain Vimont rom@rom1v.com
1423,Extract DEBUG flag in build_without_gradle.sh,,Extract DEBUG flag in build_without_gradle.sh,
1424,Generate VERSION_NAME in build_without_gradle.sh,"Since commit b963a3b9d56f744cceba2e19cba3f9fef858c058, the server uses BuildConfig.VERSION_NAME. Generate this field manually for building without gradle.",Generate VERSION_NAME in build_without_gradle.sh,"Since commit b963a3b9d56f744cceba2e19cba3f9fef858c058, the server uses BuildConfig.VERSION_NAME. Generate this field manually for building without gradle."
1425,Add option --max-fps,Add an option to limit the capture frame rate. It only works for devices with Android >= 10. Fixes https://github.com/Genymobile/scrcpy/issues/488,Add option --max-fps,Add an option to limit the capture frame rate. It only works for devices with Android >= 10. Fixes link
1426,Do not expose frame rate in ScreenEncoder,"The KEY_FRAME_RATE parameter value is necessary for the configuration of the encoder, but its actual value does not impact the frame rate (only resources used by the encoder). Therefore, it's an internal detail and should not be exposed by the ScreenEncoder class.",Do not expose frame rate in ScreenEncoder,"The KEY_FRAME_RATE parameter value is necessary for the configuration of the encoder, but its actual value does not impact the frame rate (only resources used by the encoder). Therefore, it's an internal detail and should not be exposed by the ScreenEncoder class."
1427,Fix error message,,Fix error message,
1428,Update manpage for --window-borderless option,,Update manpage for --window-borderless option,
1429,Add option to disable window decoration,Add --window-borderless parameter. Signed-off-by: Romain Vimont rom@rom1v.com,Add option to disable window decoration,Add --window-borderless parameter. Signed-off-by: Romain Vimont rom@rom1v.com
1430,Add option to specify the initial window size,"Add --window-width and --window-height parameters. If only one is provided, the other is computed so that the aspect ratio is preserved.",Add option to specify the initial window size,"Add --window-width and --window-height parameters. If only one is provided, the other is computed so that the aspect ratio is preserved."
1431,"Update manpage for --window-{x,y} options",,"Update manpage for --window-{x,y} options",
1432,Add option to specify the initial window position,Add --window-x and --window-y parameters. Signed-off-by: Romain Vimont rom@rom1v.com,Add option to specify the initial window position,Add --window-x and --window-y parameters. Signed-off-by: Romain Vimont rom@rom1v.com
1433,Do not write invalid packet duration,Configuration packets have no PTS. Do not compute a packet duration from their PTS. Fixes recording to mp4 on device rotation.,Do not write invalid packet duration,Configuration packets have no PTS. Do not compute a packet duration from their PTS. Fixes recording to mp4 on device rotation.
1434,Merge pull request #920 into dev,Compare server and client version at the start of scrcpy,Merge pull request #920 into dev,Compare server and client version at the start of scrcpy
1435,Check client and server mismatch,Send client version as first parameter and check it at server start. Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com,Check client and server mismatch,Send client version as first parameter and check it at server start. Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com
1436,Accept resize shortcuts on maximized window,"Allow ""resize to fit"" and ""resize to pixel-perfect"" on maximized window: restore the window to normal size then resize.",Accept resize shortcuts on maximized window,"Allow ""resize to fit"" and ""resize to pixel-perfect"" on maximized window: restore the window to normal size then resize."
1437,Fix rotation while the window is maximized,Keep the windowed window size to handle maximized window the same way as fullscreen window. Fixes https://github.com/Genymobile/scrcpy/issues/750,Fix rotation while the window is maximized,Keep the windowed window size to handle maximized window the same way as fullscreen window. Fixes link
1438,Handle window events from screen.c,Only the screen knows what to do on window events. This paves the way to handle more window events.,Handle window events from screen.c,Only the screen knows what to do on window events. This paves the way to handle more window events.
1439,Log device disconnection,"If scrcpy closes due to socket disconnection, log a warning.",Log device disconnection,"If scrcpy closes due to socket disconnection, log a warning."
1440,Call Looper.prepareMainLooper() to avoid exception,"Some devices internally create a Handler when creating an input Surface, causing an exception:  Surface: java.lang.RuntimeException: Can't create handler inside thread that has not called Looper.prepare()  As a workaround, call Looper.prepareMainLooper() beforehand. Fixes:  - https://github.com/Genymobile/scrcpy/issues/240  - https://github.com/Genymobile/scrcpy/issues/921 Signed-off-by: Romain Vimont rom@rom1v.com",Call Looper.prepareMainLooper() to avoid exception,"Some devices internally create a Handler when creating an input Surface, causing an exception: Surface: java.lang.RuntimeException: Can't create handler inside thread that has not called Looper.prepare() As a workaround, call Looper.prepareMainLooper() beforehand. Fixes:  - link  - link Signed-off-by: Romain Vimont rom@rom1v.com"
1441,Fix segfault on empty file recorded,"Write the file trailer only if the file header have been written, to avoid a segfault in libav. Fixes https://github.com/Genymobile/scrcpy/issues/918.",Fix segfault on empty file recorded,"Write the file trailer only if the file header have been written, to avoid a segfault in libav. Fixes link."
1442,Add --prefer-text option,"Expose an option to configure how key/text events are forwarded to the Android device. Enabling the option avoids issues when combining multiple keys to enter special characters, but breaks the expected behavior of alpha keys in games (typically WASD). Fixes https://github.com/Genymobile/scrcpy/issues/650",Add --prefer-text option,"Expose an option to configure how key/text events are forwarded to the Android device. Enabling the option avoids issues when combining multiple keys to enter special characters, but breaks the expected behavior of alpha keys in games (typically WASD). Fixes link"
1443,Deprecate short options for advanced features,The short options will be removed in the future (and may be reused for other features).,Deprecate short options for advanced features,The short options will be removed in the future (and may be reused for other features).
1444,Fix indentation,,Fix indentation,
1445,Fix include recorder.h,,Fix include recorder.h,
1446,Factorize scrcpy options and command-line args,Do not duplicate all scrcpy options fields in the structure storing the parsed command-line arguments.,Factorize scrcpy options and command-line args,Do not duplicate all scrcpy options fields in the structure storing the parsed command-line arguments.
1447,Pass screen to mouse event converters,"Mouse events coordinates depend on the screen size and location, so the converter need to access the screen. The fact that it needs the position or the size is an internal detail, so pass a pointer to the whole screen structure.",Pass screen to mouse event converters,"Mouse events coordinates depend on the screen size and location, so the converter need to access the screen. The fact that it needs the position or the size is an internal detail, so pass a pointer to the whole screen structure."
1448,Move event conversion to input_manager,Only keep helper functions separated. This will help to convert coordinates internally when necessary.,Move event conversion to input_manager,Only keep helper functions separated. This will help to convert coordinates internally when necessary.
1449,"Rename ""input_manager"" variables to ""im""","It is used a lot, a short name improves readability.","Rename ""input_manager"" variables to ""im""","It is used a lot, a short name improves readability."
1450,Document how to attach a debugger to the server,,Document how to attach a debugger to the server,
1451,Fix manpage option parameter format,The parameter for --window-title was not underlined the same way as others.,Fix manpage option parameter format,The parameter for --window-title was not underlined the same way as others.
1452,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1453,Call ninja without changing directory,"In build instructions, use: ninja -Cx ...  instead of: cd x ninja ...",Call ninja without changing directory,"In build instructions, use: ninja -Cx ... instead of: cd x ninja ..."
1454,Add scrcpy version in recorded video metadata,It might help to understand problems in recorded videos.,Add scrcpy version in recorded video metadata,It might help to understand problems in recorded videos.
1455,Merge pull request #896 from yangfl/upstream,Add manpage for scrcpy,Merge pull request #896 from yangfl/upstream,Add manpage for scrcpy
1456,Add manpage for scrcpy,,Add manpage for scrcpy,
1457,Rename scrcpy-server.jar to scrcpy-server,"The server name ending with .jar has several drawbacks:  - meson requires the jar executable to attempt to modify it:      https://github.com/Genymobile/scrcpy/issues/404#issuecomment-456065923 https://github.com/mesonbuild/meson/issues/4844  - meson warns during ""ninja install""      https://github.com/Genymobile/scrcpy/issues/458  - some users try to execute it on the computer as a java executable Removing the extension solves all these problems.",Rename scrcpy-server.jar to scrcpy-server,"The server name ending with .jar has several drawbacks:  - meson requires the jar executable to attempt to modify it:      link link  - meson warns during ""ninja install""      link  - some users try to execute it on the computer as a java executable Removing the extension solves all these problems."
1458,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1459,Fix help for --record-format,Record format requires a parameter.,Fix help for --record-format,Record format requires a parameter.
1460,Add a script to build the server without gradle,Gradle versions may sometimes cause problems. This script offers an alternative.,Add a script to build the server without gradle,Gradle versions may sometimes cause problems. This script offers an alternative.
1461,Fix mouse events conversion,The conversion from SDL mouse state to Android mouse state used wrong constants as mask. Fixes https://github.com/Genymobile/scrcpy/issues/635,Fix mouse events conversion,The conversion from SDL mouse state to Android mouse state used wrong constants as mask. Fixes link
1462,Inject button state for touch/mouse events,"The buttons state was forwarded, but ignored by the server.",Inject button state for touch/mouse events,"The buttons state was forwarded, but ignored by the server."
1463,Rename window size functions for clarity,"Now, get_window_size() returns the current window size (fullscreen or not), while get_windowed_window_size() always returned the windowed size (the size when fullscreen is disabled).",Rename window size functions for clarity,"Now, get_window_size() returns the current window size (fullscreen or not), while get_windowed_window_size() always returned the windowed size (the size when fullscreen is disabled)."
1464,"Fix ""turn screen off"" on Android Q","Call getInternalDisplayToken(), which retrieve the id of the first physical display (which is not necessarily 0 anymore). Fixes https://github.com/Genymobile/scrcpy/issues/835","Fix ""turn screen off"" on Android Q","Call getInternalDisplayToken(), which retrieve the id of the first physical display (which is not necessarily 0 anymore). Fixes link"
1465,Adapt copy-paste methods for Android 10,The methods getPrimaryClip() and setPrimaryClip() expect an additional parameter since Android 10. Fixes https://github.com/Genymobile/scrcpy/issues/796.,Adapt copy-paste methods for Android 10,The methods getPrimaryClip() and setPrimaryClip() expect an additional parameter since Android 10. Fixes link.
1466,Extract String literal to static constant,,Extract String literal to static constant,
1467,Do not crash on control error,"Some devices do not have some methods that we invoke via reflection, or their call do not return the expected value. In that case, do not crash the whole controller.",Do not crash on control error,"Some devices do not have some methods that we invoke via reflection, or their call do not return the expected value. In that case, do not crash the whole controller."
1468,Merge mouse and touch events,Both are handled the very same way on the device.,Merge mouse and touch events,Both are handled the very same way on the device.
1469,"Rename ""touch pointer"" to ""pointer""","There are only touch pointers now, mouse pointers have been removed.","Rename ""touch pointer"" to ""pointer""","There are only touch pointers now, mouse pointers have been removed."
1470,Use common pointers for mouse and touch,The mouse is a pointer like any other.,Use common pointers for mouse and touch,The mouse is a pointer like any other.
1471,Ignore duplicate mouse events,"In SDL, a touch event may simulate an identical mouse event. Since we already handle touch event, ignore these duplicates.",Ignore duplicate mouse events,"In SDL, a touch event may simulate an identical mouse event. Since we already handle touch event, ignore these duplicates."
1472,Send touch events from the client,"On SDL touch events, send control messages to the server.",Send touch events from the client,"On SDL touch events, send control messages to the server."
1473,Inject touch events on the server,"On receiving an ""inject touch"" control message, update the local pointers state and inject touches.",Inject touch events on the server,"On receiving an ""inject touch"" control message, update the local pointers state and inject touches."
1474,"Add ""inject touch"" control message",Add a control message type in the protocol to forward touch events to the device.,"Add ""inject touch"" control message",Add a control message type in the protocol to forward touch events to the device.
1475,"Rename ""pointer"" to ""mouse pointer""","This will help to distinguish them from ""touch pointers"".","Rename ""pointer"" to ""mouse pointer""","This will help to distinguish them from ""touch pointers""."
1476,Add buffer_write64be(),Add a function to write 64 bits in big-endian from a uint64_t.,Add buffer_write64be(),Add a function to write 64 bits in big-endian from a uint64_t.
1477,Include config.h everywhere,Ref: https://github.com/Genymobile/scrcpy/issues/829 Suggested-by: Louis Kruger louisk@gmail.com,Include config.h everywhere,Ref: link Suggested-by: Louis Kruger louisk@gmail.com
1478,Include config.h to fix HIDPI support,Ref: https://github.com/Genymobile/scrcpy/issues/829 Signed-off-by: Romain Vimont rom@rom1v.com,Include config.h to fix HIDPI support,Ref: link Signed-off-by: Romain Vimont rom@rom1v.com
1479,"Remove ""make"" from build dependencies",The project is built with meson+ninja.,"Remove ""make"" from build dependencies",The project is built with meson+ninja.
1480,Fix gradle warnings in tests,,Fix gradle warnings in tests,
1481,input_manager.c: Correct log,Signed-off-by: Yu-Chen Lin npes87184@gmail.com,input_manager.c: Correct log,Signed-off-by: Yu-Chen Lin npes87184@gmail.com
1482,"Fix option ""record-format"" related short opt",,"Fix option ""record-format"" related short opt",
1483,Rename event converter functions,"Rename ""XXX_from_sdl_to_android"" to ""convert_XXX"", to avoid huge function names.",Rename event converter functions,"Rename ""XXX_from_sdl_to_android"" to ""convert_XXX"", to avoid huge function names."
1484,"Rename ""convert.h"" to ""event_converter.h""",The filename gave no hint about what was converted.,"Rename ""convert.h"" to ""event_converter.h""",The filename gave no hint about what was converted.
1485,"Rename variable names ""event"" to ""msg""","Some variable names had not been renamed when ""event"" was renamed to ""message"" (28980bbc90ab93cf61bdc4b36d2448b8cebbb7df).","Rename variable names ""event"" to ""msg""","Some variable names had not been renamed when ""event"" was renamed to ""message"" (28980bbc90ab93cf61bdc4b36d2448b8cebbb7df)."
1486,Fix control message reader test,The mouse event test actually tested a key event control message.,Fix control message reader test,The mouse event test actually tested a key event control message.
1487,Improve FAQ,,Improve FAQ,
1488,Fix segfault on recording with old FFmpeg,"The AVPacket fields side_data and side_data_elems were not initialized by av_packet_ref() in old FFmpeg versions (prior to 1). As a consequence, on av_packet_unref(), side_data was freed, causing a segfault. Fixes https://github.com/Genymobile/scrcpy/issues/707",Fix segfault on recording with old FFmpeg,"The AVPacket fields side_data and side_data_elems were not initialized by av_packet_ref() in old FFmpeg versions (prior to 1). As a consequence, on av_packet_unref(), side_data was freed, causing a segfault. Fixes link"
1489,Print gradle output on compiling,"Enable the attribute ""console"" of custom_target() introduced in meson 0.48. This allows to get a feedback of what gradle does (which can takes a very long time). This produces warnings because we declare to support meson >= 0.37, but we don't want to stop supporting older versions for that. Older versions just ignore the option:  WARNING: Unknown keyword arguments in target scrcpy-server: console  Newer meson versions use it, but warn because we declare supporting older versions:  WARNING: Project targetting '>= 0.37' but tried to use feature introduced in '0.48.0': console arg in custom_target  Meson does not support conditional branches to suppress such warnings, so just keep the warnings.",Print gradle output on compiling,"Enable the attribute ""console"" of custom_target() introduced in meson 0.48. This allows to get a feedback of what gradle does (which can takes a very long time). This produces warnings because we declare to support meson >= 0.37, but we don't want to stop supporting older versions for that. Older versions just ignore the option: WARNING: Unknown keyword arguments in target scrcpy-server: console Newer meson versions use it, but warn because we declare supporting older versions: WARNING: Project targetting '>= 0.37' but tried to use feature introduced in '0.48.0': console arg in custom_target Meson does not support conditional branches to suppress such warnings, so just keep the warnings."
1490,Merge pull request #708 from toddsierens/patch-1,Update WindowManager.java,Merge pull request #708 from toddsierens/patch-1,Update WindowManager.java
1491,Update WindowManager.java,,Update WindowManager.java,
1492,Record a packet with its duration,"Record a packet only once the following has been received, so that we can set its duration before muxing it. Fixes https://github.com/Genymobile/scrcpy/issues/702",Record a packet with its duration,"Record a packet only once the following has been received, so that we can set its duration before muxing it. Fixes link"
1493,Merge pull request #692 from msfjarvis/msf/uprev-dependencies,Upgrade build dependencies,Merge pull request #692 from msfjarvis/msf/uprev-dependencies,Upgrade build dependencies
1494,Uprev Gradle wrapper to latest stable,Signed-off-by: Harsh Shandilya msfjarvis@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com,Uprev Gradle wrapper to latest stable,Signed-off-by: Harsh Shandilya msfjarvis@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com
1495,Uprev AGP to latest stable,Signed-off-by: Harsh Shandilya msfjarvis@gmail.com,Uprev AGP to latest stable,Signed-off-by: Harsh Shandilya msfjarvis@gmail.com
1496,Merge pull request #695 from schwabe/schwabe/fix_null_queue,Fix building on OS X (missing NULL in queue.h),Merge pull request #695 from schwabe/schwabe/fix_null_queue,Fix building on OS X (missing NULL in queue.h)
1497,Fix building on OS X (missing NULL in queue.h),"Headers seem to be a bit different in Apple land and you need to include stddef.h explicitly to the NULL declaration. This also makes the code a bit more correct, as stddef.h is the header in the C standard that defines NULL (https://en.cppreference.com/w/cpp/header/cstddef).",Fix building on OS X (missing NULL in queue.h),"Headers seem to be a bit different in Apple land and you need to include stddef.h explicitly to the NULL declaration. This also makes the code a bit more correct, as stddef.h is the header in the C standard that defines NULL (link)."
1498,Update links to v1.10 in README and BUILD,,Update links to v1.10 in README and BUILD,
1499,Bump version to 1.10,,Bump version to 1.10,
1500,List scrcpy characteristics in README,They were listed in the blog post introducing scrcpy: https://blog.rom1v.com/2018/03/introducing-scrcpy/,List scrcpy characteristics in README,They were listed in the blog post introducing scrcpy: link/
1501,Upgrade SDL (2.0.10) for Windows,Include the latest version of SDL in Windows releases.,Upgrade SDL (2.0.10) for Windows,Include the latest version of SDL in Windows releases.
1502,Update platform-tools (29.0.2) for Windows,Include the latest version of adb in Windows releases.,Update platform-tools (29.0.2) for Windows,Include the latest version of adb in Windows releases.
1503,Upgrade FFmpeg (4.1.4) for Windows,Include the latest version of FFmpeg in Windows releases.,Upgrade FFmpeg (4.1.4) for Windows,Include the latest version of FFmpeg in Windows releases.
1504,"Initialize queue ""last"" field","The compiler is not always able to see that ""last"" is always initialized before being used, so always initialize it.","Initialize queue ""last"" field","The compiler is not always able to see that ""last"" is always initialized before being used, so always initialize it."
1505,Use Cmd instead of Ctrl on macOS when possible,Fixes https://github.com/Genymobile/scrcpy/issues/642,Use Cmd instead of Ctrl on macOS when possible,Fixes link
1506,Use generic FIFO queue for recording,Replace the specific recording queue by the new generic FIFO queue implementation.,Use generic FIFO queue for recording,Replace the specific recording queue by the new generic FIFO queue implementation.
1507,Add generic intrusive FIFO queue,"We need several FIFO queues (a queue of packets, a queue of messages, etc.). Some of them are implemented using cbuf, a generic circular buffer. But for recording, we need to store the packets in an unbounded queue until they are written, so the queue was implemented manually. Create a generic implementation (using macros) to avoid reimplementing it every time.",Add generic intrusive FIFO queue,"We need several FIFO queues (a queue of packets, a queue of messages, etc.). Some of them are implemented using cbuf, a generic circular buffer. But for recording, we need to store the packets in an unbounded queue until they are written, so the queue was implemented manually. Create a generic implementation (using macros) to avoid reimplementing it every time."
1508,Fix cbuf documentation,,Fix cbuf documentation,
1509,Remove unnecessary backslash in cbuf,,Remove unnecessary backslash in cbuf,
1510,Remove root directory from Windows zip releases,Put the scrcpy files at the root of the zip archive. This avoids an unnecessary level of directories when extracting.,Remove root directory from Windows zip releases,Put the scrcpy files at the root of the zip archive. This avoids an unnecessary level of directories when extracting.
1511,Log recording failure,"If recording fails, log ""recording failed"" instead of ""recording complete"".",Log recording failure,"If recording fails, log ""recording failed"" instead of ""recording complete""."
1512,Log scrcpy version and URL on start,Keep --version which also print the version of dependencies.,Log scrcpy version and URL on start,Keep --version which also print the version of dependencies.
1513,Record asynchronously,"The record file was written from the stream thread. As a consequence, any blocking I/O to write the file delayed the decoder. For maximum performance even when recording is enabled, send (refcounted) packets to a separate recording thread.",Record asynchronously,"The record file was written from the stream thread. As a consequence, any blocking I/O to write the file delayed the decoder. For maximum performance even when recording is enabled, send (refcounted) packets to a separate recording thread."
1514,Reduce latency by 1 frame,"To packetize the H.264 raw stream, av_parser_parse2() (called by av_read_frame()) knows that it has received a full frame only after it has received some data for the next frame. As a consequence, the client always waited until the next frame before sending the current frame to the decoder! On the device side, we know packets boundaries. To reduce latency, make the device always transmit the ""frame meta"" to packetize the stream manually (it was already implemented to send PTS, but only enabled on recording). On the client side, replace av_read_frame() by manual packetizing and parsing. https://stackoverflow.com/questions/50682518/replacing-av-read-frame-to-reduce-delay https://trac.ffmpeg.org/ticket/3354",Reduce latency by 1 frame,"To packetize the H.264 raw stream, av_parser_parse2() (called by av_read_frame()) knows that it has received a full frame only after it has received some data for the next frame. As a consequence, the client always waited until the next frame before sending the current frame to the decoder! On the device side, we know packets boundaries. To reduce latency, make the device always transmit the ""frame meta"" to packetize the stream manually (it was already implemented to send PTS, but only enabled on recording). On the client side, replace av_read_frame() by manual packetizing and parsing. link link"
1515,Add option to change the push target,A drag & drop always pushed the file to /sdcard/. Add an option to customize the target directory. Fixes https://github.com/Genymobile/scrcpy/issues/659,Add option to change the push target,A drag & drop always pushed the file to /sdcard/. Add an option to customize the target directory. Fixes link
1516,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1517,Add unit test for device message serialization,"There was a test for the deserialization, but not for the serialization.",Add unit test for device message serialization,"There was a test for the deserialization, but not for the serialization."
1518,"Rename ""build_"" to ""compile_""","Recent versions of meson complain about an option having name starting with ""build_"":  DEPRECATION: Option uses prefix ""build_"", which is reserved for Meson. This will become an error in the future.  Use ""compile_"" instead.","Rename ""build_"" to ""compile_""","Recent versions of meson complain about an option having name starting with ""build_"": DEPRECATION: Option uses prefix ""build_"", which is reserved for Meson. This will become an error in the future. Use ""compile_"" instead."
1519,Update README.md,Signed-off-by: Romain Vimont rom@rom1v.com,Update README.md,Signed-off-by: Romain Vimont rom@rom1v.com
1520,Add me as copyright owner,,Add me as copyright owner,
1521,Fix double-free on error,"If writing the recording header fails, do not clean the resources immediately to avoid double-free.",Fix double-free on error,"If writing the recording header fails, do not clean the resources immediately to avoid double-free."
1522,Close decoder on stream ended,Add missing call to decoder_close().,Close decoder on stream ended,Add missing call to decoder_close().
1523,Document --window-title in README,,Document --window-title in README,
1524,Merge pull request #614 from beango1:window-title-simple,add option window-title to set the title,Merge pull request #614 from beango1:window-title-simple,add option window-title to set the title
1525,Add option --window-title,Add an option to set a custom window title. Signed-off-by: Romain Vimont rom@rom1v.com,Add option --window-title,Add an option to set a custom window title. Signed-off-by: Romain Vimont rom@rom1v.com
1526,"Replace ""cannot"" by ""could not""",,"Replace ""cannot"" by ""could not""",
1527,Fix expected parameters count in error message,,Fix expected parameters count in error message,
1528,Close socket on error,Suggested-by: barry-ran https://github.com/Genymobile/scrcpy/issues/607,Close socket on error,Suggested-by: barry-ran link
1529,Prevent to turn screen off if no control,"If --no-control is set, then the controller is not initialized (both in the client and the server), so it is not possible to control the device to turn its screen off. See https://github.com/Genymobile/scrcpy/issues/608.",Prevent to turn screen off if no control,"If --no-control is set, then the controller is not initialized (both in the client and the server), so it is not possible to control the device to turn its screen off. See link."
1530,Reference USBaudio from README,,Reference USBaudio from README,
1531,Fix --serial help,Make explicit that --serial excepts a parameter.,Fix --serial help,Make explicit that --serial excepts a parameter.
1532,Merge pull request #595 from taaem/fix_build_fedora,The Java JDK is needed to build the server,Merge pull request #595 from taaem/fix_build_fedora,The Java JDK is needed to build the server
1533,Fix required java package for Fedora,"The Java JDK is needed to build the server. The relevant Fedora package is java-devel, not java. Signed-off-by: Romain Vimont rom@rom1v.com",Fix required java package for Fedora,"The Java JDK is needed to build the server. The relevant Fedora package is java-devel, not java. Signed-off-by: Romain Vimont rom@rom1v.com"
1534,Remove useless else,The if-block ends with a return.,Remove useless else,The if-block ends with a return.
1535,Improve comment,Rephrase to simplify and add a link to the issue.,Improve comment,Rephrase to simplify and add a link to the issue.
1536,Merge pull request #587 from schwabe/fix_586_screen_off_qbeta,Use getPhysicalDisplayToken if getBuiltInDisplay is not found,Merge pull request #587 from schwabe/fix_586_screen_off_qbeta,Use getPhysicalDisplayToken if getBuiltInDisplay is not found
1537,Use getPhysicalDisplayToken on Anroid Q+ instead of getBuiltInDisplay,This makes the -S (screen off) parameter work on Android Q beta 4 Closes #586,Use getPhysicalDisplayToken on Anroid Q+ instead of getBuiltInDisplay,This makes the -S (screen off) parameter work on Android Q beta 4 Closes #586
1538,"Remove compilation flag ""skip_frames""",It is unused since ebccb9f6cc111e8acfbe10d656cac5c1f1b744a0.,"Remove compilation flag ""skip_frames""",It is unused since ebccb9f6cc111e8acfbe10d656cac5c1f1b744a0.
1539,Disable portable build by default,The default value of a boolean meson option is true. We want non-portable build by default.,Disable portable build by default,The default value of a boolean meson option is true. We want non-portable build by default.
1540,Merge pull request #587 from zzndb/patch-1,,Merge pull request #587 from zzndb/patch-1,
1541,Fix a spell mistake,After commented default portable option in app/meson.build get some error and then find this. :) Signed-off-by: Romain Vimont rom@rom1v.com,Fix a spell mistake,After commented default portable option in app/meson.build get some error and then find this. :) Signed-off-by: Romain Vimont rom@rom1v.com
1542,Add link to Snap package in README,https://github.com/Genymobile/scrcpy/issues/523,Add link to Snap package in README,link
1543,Fix typo in README,,Fix typo in README,
1544,Update links to v1.9 in README and BUILD,,Update links to v1.9 in README and BUILD,
1545,Merge branch 'dev',,Merge branch 'dev',
1546,Bump version to 1.9,,Bump version to 1.9,
1547,Upgrade tarketSdkVersion to 29,This fixes a lint warning.,Upgrade tarketSdkVersion to 29,This fixes a lint warning.
1548,Fix deprecation warning in Java unit test,,Fix deprecation warning in Java unit test,
1549,Fix typo in test name,,Fix typo in test name,
1550,Remove obsolete detail in README,"Now that scrcpy-server.jar is found in the same directory as the scrcpy executable, using SCRCPY_SERVER_PATH is not particularly useful on Windows anymore",Remove obsolete detail in README,"Now that scrcpy-server.jar is found in the same directory as the scrcpy executable, using SCRCPY_SERVER_PATH is not particularly useful on Windows anymore"
1551,Remove obsolete explanation in FAQ,Issue 9 was about stdout/stderr not printed in Windows console. This is solved since the Windows version is cross-compiled from Linux.,Remove obsolete explanation in FAQ,Issue 9 was about stdout/stderr not printed in Windows console. This is solved since the Windows version is cross-compiled from Linux.
1552,Update DEVELOP.md,,Update DEVELOP.md,
1553,Update platform-tools (29.0.1) for Windows,Include the latest version of adb in Windows releases.,Update platform-tools (29.0.1) for Windows,Include the latest version of adb in Windows releases.
1554,Downgrade SDL to 2.0.8 for Windows,"Revert ""Update SDL (2.0.9) for Windows"" Several users experienced freezes with SDL 2.0.9. This reverts commit a5787dccd62fe4ff9dc05d597d3aab06da717edd. See:  - https://github.com/Genymobile/scrcpy/issues/425  - https://discourse.libsdl.org/t/unstable-frame-rate-unexpectedly/25783",Downgrade SDL to 2.0.8 for Windows,"Revert ""Update SDL (2.0.9) for Windows"" Several users experienced freezes with SDL 2.0.9. This reverts commit a5787dccd62fe4ff9dc05d597d3aab06da717edd. See:  - link  - link"
1555,Upgrade FFmpeg (4.1.3) for Windows,Include the latest version of FFmpeg in Windows releases.,Upgrade FFmpeg (4.1.3) for Windows,Include the latest version of FFmpeg in Windows releases.
1556,Improve portable builds,"In portable builds, scrcpy-server.jar was supposed to be present in the current directory, so in practice it worked only if scrcpy was launched from its own directory. Instead, find the absolute path of the executable and build a suitable path to use scrcpy-server.jar from the same directory.",Improve portable builds,"In portable builds, scrcpy-server.jar was supposed to be present in the current directory, so in practice it worked only if scrcpy was launched from its own directory. Instead, find the absolute path of the executable and build a suitable path to use scrcpy-server.jar from the same directory."
1557,Add functions to convert wide char to UTF-8,"There was already utf8_to_wide_char(), used to correctly execute commands on Windows. Add the reverse converter: utf8_from_wide_char(). We will need it to build the scrcpy-server path based on the executable directory.",Add functions to convert wide char to UTF-8,"There was already utf8_to_wide_char(), used to correctly execute commands on Windows. Add the reverse converter: utf8_from_wide_char(). We will need it to build the scrcpy-server path based on the executable directory."
1558,"Extract ""scrcpy-server.jar"" string",The filename is used at several places.,"Extract ""scrcpy-server.jar"" string",The filename is used at several places.
1559,Simplify portable build configuration,"To create a portable build (with scrcpy-server.jar accessible from the scrcpy directory), replace OVERRIDE_SERVER_PATH by a simple compilation flag: PORTABLE. This paves the way to use more complex rules to determine the path of scrcpy-server.jar in portable builds.",Simplify portable build configuration,"To create a portable build (with scrcpy-server.jar accessible from the scrcpy directory), replace OVERRIDE_SERVER_PATH by a simple compilation flag: PORTABLE. This paves the way to use more complex rules to determine the path of scrcpy-server.jar in portable builds."
1560,Simplify scrcpy-server path configuration,"The full path of scrcpy-server.jar was partially configured from meson.build then concatenated by C code. Instead, directly write the path in C.",Simplify scrcpy-server path configuration,"The full path of scrcpy-server.jar was partially configured from meson.build then concatenated by C code. Instead, directly write the path in C."
1561,Never return 0 for stream protocol,"On socket disconnection, on Linux, recv() returns -1 and errno is set. But on Windows, errno is 0. In that case, AVERROR(errno) == 0, leading to the warning:  Invalid return value 0 for stream protocol  To avoid the problem, if errno is 0, return AVERROR_EOF. Ref: commit 2876463d394c3bc4dc239a605e65ebab75598353",Never return 0 for stream protocol,"On socket disconnection, on Linux, recv() returns -1 and errno is set. But on Windows, errno is 0. In that case, AVERROR(errno) == 0, leading to the warning: Invalid return value 0 for stream protocol To avoid the problem, if errno is 0, return AVERROR_EOF. Ref: commit 2876463d394c3bc4dc239a605e65ebab75598353"
1562,Truncate device name at UTF-8 code point boundary,Just in case.,Truncate device name at UTF-8 code point boundary,Just in case.
1563,Inline lock_util functions,They are just tiny wrappers.,Inline lock_util functions,They are just tiny wrappers.
1564,Improve framerate counting,"The FPS counter was called only on new frames, so it could not print values regularly, especially when there are very few FPS (when the device surface does not change). To the extreme, it was never able to display 0 fps. Add a separate thread to print framerate every second.",Improve framerate counting,"The FPS counter was called only on new frames, so it could not print values regularly, especially when there are very few FPS (when the device surface does not change). To the extreme, it was never able to display 0 fps. Add a separate thread to print framerate every second."
1565,Add cond_wait_timeout(),"Add a ""timed out"" version of cond_wait().",Add cond_wait_timeout(),"Add a ""timed out"" version of cond_wait()."
1566,Fix controller cleanup,"After commit bfb86ca2c23c29cf768c9216dbfff3a89d5d0b5f, the controller was not stopped and destroyed on quit.",Fix controller cleanup,"After commit bfb86ca2c23c29cf768c9216dbfff3a89d5d0b5f, the controller was not stopped and destroyed on quit."
1567,Add runtime option to render expired frames,"Replace the compilation flag SKIP_FRAMES by a runtime flag to force rendering of expired frames. By default, the expired frames are skipped.",Add runtime option to render expired frames,"Replace the compilation flag SKIP_FRAMES by a runtime flag to force rendering of expired frames. By default, the expired frames are skipped."
1568,Indent command-line options,Prepare indentation for --render-expired-frames.,Indent command-line options,Prepare indentation for --render-expired-frames.
1569,Add README section explaining --turn-screen-off,,Add README section explaining --turn-screen-off,
1570,Replace android-tools-adb by adb,"Here is the description of the adb package in Debian:  Description: Android Debug Bridge A versatile command line tool that lets you communicate with an emulator instance or connected Android-powered device. This package recommends ""android-sdk-platform-tools-common"" which contains the udev rules for Android devices. Without this package, adb and fastboot need to be running with root permission.  And android-tools-adb:  Description: transitional package This is a transitional package. It can safely be removed.",Replace android-tools-adb by adb,"Here is the description of the adb package in Debian: Description: Android Debug Bridge A versatile command line tool that lets you communicate with an emulator instance or connected Android-powered device. This package recommends ""android-sdk-platform-tools-common"" which contains the udev rules for Android devices. Without this package, adb and fastboot need to be running with root permission. And android-tools-adb: Description: transitional package This is a transitional package. It can safely be removed."
1571,Merge pull request #574 from crow1170/patch-1,Fix dependencies,Merge pull request #574 from crow1170/patch-1,Fix dependencies
1572,Fix dependencies,Some missing or misspelled dependencies. Checked on Ubuntu 19.04.,Fix dependencies,Some missing or misspelled dependencies. Checked on Ubuntu 19.04.
1573,Add option to turn device screen off,"In addition to the shortcut (Ctrl+o) to turn the device screen off, add a command-line argument to turn it off on start.",Add option to turn device screen off,"In addition to the shortcut (Ctrl+o) to turn the device screen off, add a command-line argument to turn it off on start."
1574,Indent command-line options,Preparse indentation for --turn-screen-off.,Indent command-line options,Preparse indentation for --turn-screen-off.
1575,Disable server controller if --no-control,"If --no-control is disabled, there is no need for a controller. It also avoids to power on the device on start if control is disabled.",Disable server controller if --no-control,"If --no-control is disabled, there is no need for a controller. It also avoids to power on the device on start if control is disabled."
1576,Group server params in a struct,"Starting the server requires more and more parameters. For clarity, group them in a struct.",Group server params in a struct,"Starting the server requires more and more parameters. For clarity, group them in a struct."
1577,Use positive options names internally,"For clarity, store the flag resulting of the command-line options --no-control and --no-display into ""control"" and ""display"".",Use positive options names internally,"For clarity, store the flag resulting of the command-line options --no-control and --no-display into ""control"" and ""display""."
1578,Rename unused field,"The flag is used only in the server_start() implementation, there is no need to store it in the structure.",Rename unused field,"The flag is used only in the server_start() implementation, there is no need to store it in the structure."
1579,"Remove ""turn device screen on"" feature","Only keep ""turn device screen off"" and POWER button. After we turn the device screen off (with Ctrl+o), turning it back on does not always work, and leaves the device in a weird state, where even the power button may not be sufficient: https://github.com/Genymobile/scrcpy/issues/175#issuecomment-497946596 This is not an acceptable behavior, so disable the shortcut to turn the physical device screen on. We can use the POWER button (or Ctrl+p) instead.","Remove ""turn device screen on"" feature","Only keep ""turn device screen off"" and POWER button. After we turn the device screen off (with Ctrl+o), turning it back on does not always work, and leaves the device in a weird state, where even the power button may not be sufficient: link This is not an acceptable behavior, so disable the shortcut to turn the physical device screen on. We can use the POWER button (or Ctrl+p) instead."
1580,"Rename function to ""power on""","This will reduce confusion between ""power on"" when the device is off and ""turn device screen off"" while mirroring.","Rename function to ""power on""","This will reduce confusion between ""power on"" when the device is off and ""turn device screen off"" while mirroring."
1581,Improve key processing readability,"The condition ""event->type == SDL_KEYDOWN"" and the variable input_manager->controller are used many times. Replace them by local variables to reduce verbosity.",Improve key processing readability,"The condition ""event->type == SDL_KEYDOWN"" and the variable input_manager->controller are used many times. Replace them by local variables to reduce verbosity."
1582,Use net_close() to close sockets,So that it also works on Windows.,Use net_close() to close sockets,So that it also works on Windows.
1583,Remove unused import,Introduced by the previous commit.,Remove unused import,Introduced by the previous commit.
1584,Implement device screen off while mirroring,"Add two shortcuts:  - Ctrl+o to turn the device screen off while mirroring  - Ctrl+Shift+o to turn it back on On power on (either via the POWER key or BACK while screen is off), both the device screen and the mirror are turned on. https://github.com/Genymobile/scrcpy/issues/175",Implement device screen off while mirroring,"Add two shortcuts:  - Ctrl+o to turn the device screen off while mirroring  - Ctrl+Shift+o to turn it back on On power on (either via the POWER key or BACK while screen is off), both the device screen and the mirror are turned on. link"
1585,Fix comment style,For consistency.,Fix comment style,For consistency.
1586,Prevent socket leak on error,Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com,Prevent socket leak on error,Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com
1587,Use consistent variable names,Use the same variable name in functions declaration and definition. Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com,Use consistent variable names,Use the same variable name in functions declaration and definition. Signed-off-by: Yu-Chen Lin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com
1588,Add clipboard logs,Synchronizing local and device clipboards in invisible. Add INFO logs on success.,Add clipboard logs,Synchronizing local and device clipboards in invisible. Add INFO logs on success.
1589,Do not minimize on focus loss,The default behavior seems annoying. Fixes https://github.com/Genymobile/scrcpy/issues/554,Do not minimize on focus loss,The default behavior seems annoying. Fixes link
1590,Prefix server logs,"Sometimes, it is not obvious whether a log is generated by the server or by the client. Prefix server logs for clarity.",Prefix server logs,"Sometimes, it is not obvious whether a log is generated by the server or by the client. Prefix server logs for clarity."
1591,"Rename ""event"" to ""message""","After the recent refactorings, a ""control event"" is not necessarily an ""event"" (it may be a ""command""). Similarly, the unique ""device event"" used to send the device clipboard content is more a ""reponse"" to the request from the client than an ""event"". Rename both to ""message"", and rename the message types to better describe their intent.","Rename ""event"" to ""message""","After the recent refactorings, a ""control event"" is not necessarily an ""event"" (it may be a ""command""). Similarly, the unique ""device event"" used to send the device clipboard content is more a ""reponse"" to the request from the client than an ""event"". Rename both to ""message"", and rename the message types to better describe their intent."
1592,Merge pull request #568 from npes87184/dev,Correct return value type in handle_event,Merge pull request #568 from npes87184/dev,Correct return value type in handle_event
1593,Correct return value type in handle_event,handle_event return the type enum event_result not bool Signed-off-by: Yu-Chen Lin npes87184@gmail.com,Correct return value type in handle_event,handle_event return the type enum event_result not bool Signed-off-by: Yu-Chen Lin npes87184@gmail.com
1594,server/meson.build: Prevent using input field for directory,This will fix build warning in newer meson. Fix #540. Signed-off-by: Yu-Chen Lin npes87184@gmail.com,server/meson.build: Prevent using input field for directory,This will fix build warning in newer meson. Fix #540. Signed-off-by: Yu-Chen Lin npes87184@gmail.com
1595,Update DEVELOP after recent refactorings,,Update DEVELOP after recent refactorings,
1596,Implement computer-to-device clipboard copy,"It was already possible to paste (with Ctrl+v) the content of the computer clipboard on the device. Technically, it injects a sequence of events to generate the text. Add a new feature (Ctrl+Shift+v) to copy to the device clipboard instead, without injecting the content. Contrary to events injection, this preserves the UTF-8 content exactly, so the text is not broken by special characters. https://github.com/Genymobile/scrcpy/issues/413",Implement computer-to-device clipboard copy,"It was already possible to paste (with Ctrl+v) the content of the computer clipboard on the device. Technically, it injects a sequence of events to generate the text. Add a new feature (Ctrl+Shift+v) to copy to the device clipboard instead, without injecting the content. Contrary to events injection, this preserves the UTF-8 content exactly, so the text is not broken by special characters. link"
1597,Extract control event String parsing,"Parsing a String from a serialized control event, encoded as length (2 bytes) + data, will be necessary in several events. Extract it to a separate method.",Extract control event String parsing,"Parsing a String from a serialized control event, encoded as length (2 bytes) + data, will be necessary in several events. Extract it to a separate method."
1598,Fix control event String parsing,At least 2 bytes must be available to read the length of the String.,Fix control event String parsing,At least 2 bytes must be available to read the length of the String.
1599,Implement device-to-computer clipboard copy,"On Ctrl+C:  - the client sends a GET_CLIPBOARD command to the device;  - the device retrieve its current clipboard text and sends it in a    GET_CLIPBOARD device event;  - the client sets this text as the system clipboard text, so that it    can be pasted in another application. Fixes https://github.com/Genymobile/scrcpy/issues/145",Implement device-to-computer clipboard copy,"On Ctrl+C:  - the client sends a GET_CLIPBOARD command to the device;  - the device retrieve its current clipboard text and sends it in a    GET_CLIPBOARD device event;  - the client sets this text as the system clipboard text, so that it    can be pasted in another application. Fixes link"
1600,Add device event sender,"Create a separate component to send device events, managed by the controller.",Add device event sender,"Create a separate component to send device events, managed by the controller."
1601,Add device event receiver,"Create a separate component to handle device events, managed by the controller.",Add device event receiver,"Create a separate component to handle device events, managed by the controller."
1602,Add GET_CLIPBOARD device event,"Add the first device event, used to forward the device clipboard to the computer.",Add GET_CLIPBOARD device event,"Add the first device event, used to forward the device clipboard to the computer."
1603,Use two sockets for video and control,"The socket used the device-to-computer direction to stream the video and the computer-to-device direction to send control events. Some features, like copy-paste from device to computer, require to send non-video data from the device to the computer. To make them possible, use two sockets:  - one for streaming the video from the device to the client;  - one for control/events in both directions.",Use two sockets for video and control,"The socket used the device-to-computer direction to stream the video and the computer-to-device direction to send control events. Some features, like copy-paste from device to computer, require to send non-video data from the device to the computer. To make them possible, use two sockets:  - one for streaming the video from the device to the client;  - one for control/events in both directions."
1604,Extract control event string serialization,"A string is serialized as a length (2 bytes) followed by the string data (non nul-terminated). For now, it is used only once, but we will need to serialize strings in other events.",Extract control event string serialization,"A string is serialized as a length (2 bytes) followed by the string data (non nul-terminated). For now, it is used only once, but we will need to serialize strings in other events."
1605,Truncate UTF-8 properly,This will avoid to produce invalid UTF-8 results (although unlikely).,Truncate UTF-8 properly,This will avoid to produce invalid UTF-8 results (although unlikely).
1606,Add helpers to truncate UTF-8 at code points,"This will help to avoid truncating a UTF-8 string in the middle of a code point, producing an invalid UTF-8 result.",Add helpers to truncate UTF-8 at code points,"This will help to avoid truncating a UTF-8 string in the middle of a code point, producing an invalid UTF-8 result."
1607,Add unit tests for control events serialization,Add missing tests for serialization and deserialization of control events.,Add unit tests for control events serialization,Add missing tests for serialization and deserialization of control events.
1608,Fix wrong comment in unit test,,Fix wrong comment in unit test,
1609,Use custom class Point,The framework class android.graphics.Point cannot be used in unit tests. Implement our own Point.,Use custom class Point,The framework class android.graphics.Point cannot be used in unit tests. Implement our own Point.
1610,Merge commands with other control events,"Several commands were grouped under the same event type ""command"", with a separate field to indicate the actual command. Move these commands at the same level as other control events. It will allow to implement commands with arguments.",Merge commands with other control events,"Several commands were grouped under the same event type ""command"", with a separate field to indicate the actual command. Move these commands at the same level as other control events. It will allow to implement commands with arguments."
1611,Stop stream immediately on quit,"If the stream is stopped, av_read_frame() will be woken up and yield a corrupted packet. Do not try to decode or record it.",Stop stream immediately on quit,"If the stream is stopped, av_read_frame() will be woken up and yield a corrupted packet. Do not try to decode or record it."
1612,Close server socket before killing process,The sockets may be closed and shutdown on server_stop(). This will interrupt the stream and controller threads more quickly and gracefully.,Close server socket before killing process,The sockets may be closed and shutdown on server_stop(). This will interrupt the stream and controller threads more quickly and gracefully.
1613,Simplify cleanup,"The cleanup is not linear: for example, the server must be stopped and its sockets must be shutdown after the stream and controller are stopped (so that they don't continue processing garbage), but before they are joined, to avoid a deadlock if they are blocked on a socket read. Simplify the spaghetti-cleanup by keeping trace of initialization at runtime.",Simplify cleanup,"The cleanup is not linear: for example, the server must be stopped and its sockets must be shutdown after the stream and controller are stopped (so that they don't continue processing garbage), but before they are joined, to avoid a deadlock if they are blocked on a socket read. Simplify the spaghetti-cleanup by keeping trace of initialization at runtime."
1614,Use net_recv() to read only one byte,"Partial read is impossible for 1 byte, so net_recv_all() is useless.",Use net_recv() to read only one byte,"Partial read is impossible for 1 byte, so net_recv_all() is useless."
1615,Simplify server_connect_to(),"Only use 2 branches, using either forward or remote tunnel.",Simplify server_connect_to(),"Only use 2 branches, using either forward or remote tunnel."
1616,Make server_connect_to() return a bool,"The resulting socket is accessible from the server instance, there is no need to return it. This paves the way to use several sockets in parallel.",Make server_connect_to() return a bool,"The resulting socket is accessible from the server instance, there is no need to return it. This paves the way to use several sockets in parallel."
1617,Add missing return 0 in unit test,,Add missing return 0 in unit test,
1618,Use cbuf for file handler request queue,Replace the file_handler_request_queue implementation by cbuf.,Use cbuf for file handler request queue,Replace the file_handler_request_queue implementation by cbuf.
1619,Use cbuf for control event queue,Replace the control_event_queue implementation by cbuf.,Use cbuf for control event queue,Replace the control_event_queue implementation by cbuf.
1620,Add generic circular buffer,"Add a circular buffer implementation, to factorize multiple specific queues implementation.",Add generic circular buffer,"Add a circular buffer implementation, to factorize multiple specific queues implementation."
1621,Add buffer_read16be(),Add a function to read 16 bits in big-endian to a uint16_t.,Add buffer_read16be(),Add a function to read 16 bits in big-endian to a uint16_t.
1622,Make buffer util functions accept const buffers,So that they can be used both on const and non-const input buffers.,Make buffer util functions accept const buffers,So that they can be used both on const and non-const input buffers.
1623,Make control_event_serialize() return size_t,"control_event_serialize() returns the number of bytes written, so the type should be size_t.",Make control_event_serialize() return size_t,"control_event_serialize() returns the number of bytes written, so the type should be size_t."
1624,Fix memory leak on error,The variable condition was not destroyed on strdup() failure.,Fix memory leak on error,The variable condition was not destroyed on strdup() failure.
1625,Fix event ownership comment,,Fix event ownership comment,
1626,Prefix control event constants by namespace,This will avoid conflicts with future device events.,Prefix control event constants by namespace,This will avoid conflicts with future device events.
1627,Make macro expansion-safe,"Use parentheses to avoid unexpected results. For example, make: 2 * SERIALIZED_EVENT_MAX_SIZE  expand to: 2 * (3 + TEXT_MAX_LENGTH)  instead of: 2 * 3 + TEXT_MAX_LENGTH",Make macro expansion-safe,"Use parentheses to avoid unexpected results. For example, make: 2 * SERIALIZED_EVENT_MAX_SIZE expand to: 2 * (3 + TEXT_MAX_LENGTH) instead of: 2 * 3 + TEXT_MAX_LENGTH"
1628,Remove unused includes,"The struct control_event does not use mutexes, and net.h does not need SDL_platform.h.",Remove unused includes,"The struct control_event does not use mutexes, and net.h does not need SDL_platform.h."
1629,Fix indentation,Previous refactorings broke indentation.,Fix indentation,Previous refactorings broke indentation.
1630,Format meson.build for readability,,Format meson.build for readability,
1631,Replace SDL_bool by bool in tests,"Commit dfed1b250e5aada1c0b4c75fbaf54aebc19a92d5 replaced SDL types by standard types in sources, but tests were not updated.",Replace SDL_bool by bool in tests,"Commit dfed1b250e5aada1c0b4c75fbaf54aebc19a92d5 replaced SDL types by standard types in sources, but tests were not updated."
1632,Always use SDL_malloc() and SDL_free(),"To avoid mixing SDL_malloc()/SDL_strdup() with free(), or malloc() with SDL_free(), always use the SDL version.",Always use SDL_malloc() and SDL_free(),"To avoid mixing SDL_malloc()/SDL_strdup() with free(), or malloc() with SDL_free(), always use the SDL version."
1633,Fix checkstyle warning,Checkstyle wants a specific order of imports.,Fix checkstyle warning,Checkstyle wants a specific order of imports.
1634,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1635,Bind Home key to MOVE_HOME,"On pressing Home key on the computer, move the cursor to the beginning of the line instead of going back to the home screen. https://developer.android.com/reference/android/view/KeyEvent.html#KEYCODE_HOME https://developer.android.com/reference/android/view/KeyEvent.html#KEYCODE_MOVE_HOME Fixes (part of) https://github.com/Genymobile/scrcpy/issues/555.",Bind Home key to MOVE_HOME,"On pressing Home key on the computer, move the cursor to the beginning of the line instead of going back to the home screen. link link Fixes (part of) link."
1636,Make owned filename a pointer-to-non-const,"The file handler owns the filename string, so it needs to free it. Therefore, it should not be a pointer-to-const.",Make owned filename a pointer-to-non-const,"The file handler owns the filename string, so it needs to free it. Therefore, it should not be a pointer-to-const."
1637,Make owned serial a pointer-to-non-const,"The file handler owns the serial, so it needs to free it. Therefore, it should not be a pointer-to-const.",Make owned serial a pointer-to-non-const,"The file handler owns the serial, so it needs to free it. Therefore, it should not be a pointer-to-const."
1638,Remove useless casts to (void *),,Remove useless casts to (void *),
1639,Explain how to customize path in README,,Explain how to customize path in README,
1640,Continue on icon loading failure,"If loading the icon from xpm fails, launch scrcpy without window icon. https://github.com/Genymobile/scrcpy/issues/539",Continue on icon loading failure,"If loading the icon from xpm fails, launch scrcpy without window icon. link"
1641,Check surface returned for icon,"SDL_CreateRGBSurfaceFrom() may return NULL, causing a segfault. https://github.com/Genymobile/scrcpy/issues/539",Check surface returned for icon,"SDL_CreateRGBSurfaceFrom() may return NULL, causing a segfault. link"
1642,Log characters failed to be injected,Some characters may not be injected (e.g. '\r`). Log them instead of ignoring them silently.,Log characters failed to be injected,Some characters may not be injected (e.g. '\r`). Log them instead of ignoring them silently.
1643,Merge pull request #542 from npes87184/dev,Return success count in injectText,Merge pull request #542 from npes87184/dev,Return success count in injectText
1644,Return success count in injectText,"It will insert as many text as possible now. Fix #509, tested on Windows 10 and Arch Linux. Signed-off-by: Yu-Chen Lin npes87184@gmail.com",Return success count in injectText,"It will insert as many text as possible now. Fix #509, tested on Windows 10 and Arch Linux. Signed-off-by: Yu-Chen Lin npes87184@gmail.com"
1645,Print adb command on error,"When the execution of an adb command fails, print the command. This will help to understand what went wrong. See https://github.com/Genymobile/scrcpy/issues/530.",Print adb command on error,"When the execution of an adb command fails, print the command. This will help to understand what went wrong. See link."
1646,Use size_t for command length,The size of an array should have type size_t.,Use size_t for command length,The size of an array should have type size_t.
1647,Merge pull request #522 from dos1/compositor,Disable X11 compositor bypass,Merge pull request #522 from dos1/compositor,Disable X11 compositor bypass
1648,Disable X11 compositor bypass,"Compositor bypass is meant for fullscreen games consuming lots of GPU resources. For a light app that will usually be windowed, this only causes unnecessary compositor suspends, especially visible (and annoying) with complying window manager like KWin. Signed-off-by: Romain Vimont rom@rom1v.com",Disable X11 compositor bypass,"Compositor bypass is meant for fullscreen games consuming lots of GPU resources. For a light app that will usually be windowed, this only causes unnecessary compositor suspends, especially visible (and annoying) with complying window manager like KWin. Signed-off-by: Romain Vimont rom@rom1v.com"
1649,Fix mouse focus clickthrough,Mouse focus clickthrough didn't work due to compat.h header not being included in scrcpy.c. Signed-off-by: Romain Vimont rom@rom1v.com,Fix mouse focus clickthrough,Mouse focus clickthrough didn't work due to compat.h header not being included in scrcpy.c. Signed-off-by: Romain Vimont rom@rom1v.com
1650,Recover if expand/collapse panels is not available,Some devices don't have the required method. Recover gracefully without crashing the server. Fixes https://github.com/Genymobile/scrcpy/issues/506.,Recover if expand/collapse panels is not available,Some devices don't have the required method. Recover gracefully without crashing the server. Fixes link.
1651,Add method to log error without throwable,"Add Ln.e(message) in addition to Ln.e(message, error).",Add method to log error without throwable,"Add Ln.e(message) in addition to Ln.e(message, error)."
1652,Upgrade gradle,,Upgrade gradle,
1653,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1654,Fix link error on Windows Subsystem for Linux,Build failed on WSL because of lack of reference to WinMain@16 during linking. Fixes https://github.com/Genymobile/scrcpy/issues/316 Signed-off-by: Romain Vimont rom@rom1v.com,Fix link error on Windows Subsystem for Linux,Build failed on WSL because of lack of reference to WinMain@16 during linking. Fixes link Signed-off-by: Romain Vimont rom@rom1v.com
1655,Run server tests on release,,Run server tests on release,
1656,Run tests with ASAN enabled,This may capture more errors (like e2ef39fae5ffb576cdc4d924cf0b67393138168d).,Run tests with ASAN enabled,This may capture more errors (like e2ef39fae5ffb576cdc4d924cf0b67393138168d).
1657,Fix server checkstyle errors,Fix errors reported by: gradle -p server check,Fix server checkstyle errors,Fix errors reported by: gradle -p server check
1658,Fix overflow in test,"The serialized text is not nul-terminated (its size is explicitely provided), but the input text in the event is a nul-terminated string. The test was failing with ASAN enabled.",Fix overflow in test,"The serialized text is not nul-terminated (its size is explicitely provided), but the input text in the event is a nul-terminated string. The test was failing with ASAN enabled."
1659,Do not call codec.stop() on exception,"On exception, the codec is not in a state were .stop() can be called.",Do not call codec.stop() on exception,"On exception, the codec is not in a state were .stop() can be called."
1660,Remove deprecated Arch Linux package,The scrcpy-prebuiltserver has been deprecated in favor of the scrcpy package. https://aur.archlinux.org/cgit/aur.git/commit/?h=scrcpy-prebuiltserver&id=2ef4359b2e45fc278a191fae014d381b486ffcfe Signed-off-by: Romain Vimont rom@rom1v.com,Remove deprecated Arch Linux package,The scrcpy-prebuiltserver has been deprecated in favor of the scrcpy package. link Signed-off-by: Romain Vimont rom@rom1v.com
1661,Update developer documentation for v1.8,,Update developer documentation for v1.8,
1662,Add note about Ctrl+C on Windows while recording,"Ctrl+C kills the app on Windows, so the recorded file is broken.",Add note about Ctrl+C on Windows while recording,"Ctrl+C kills the app on Windows, so the recorded file is broken."
1663,Update links to v1.8 in README and BUILD,,Update links to v1.8 in README and BUILD,
1664,Bump version to 1.8,,Bump version to 1.8,
1665,"Log ""new texture"" at INFO level","The ""initial texture"" is logged at INFO level. For consistency, log ""new texture"" at the same level.","Log ""new texture"" at INFO level","The ""initial texture"" is logged at INFO level. For consistency, log ""new texture"" at the same level."
1666,Remove empty line,,Remove empty line,
1667,Merge branch 'dev',,Merge branch 'dev',
1668,Add more consts,Some decoder and recorder functions must not write to AVCodec and AVPacket.,Add more consts,Some decoder and recorder functions must not write to AVCodec and AVPacket.
1669,Merge pull request #442 from npes87184/master,server/meson.build: support relative path for prebuilt_server,Merge pull request #442 from npes87184/master,server/meson.build: support relative path for prebuilt_server
1670,Explicitly pass control flag to input manager,"Replace the ""global"" control flag in the input_manager by a function parameter to make explicit that the behavior depends whether --no-control has been set.",Explicitly pass control flag to input manager,"Replace the ""global"" control flag in the input_manager by a function parameter to make explicit that the behavior depends whether --no-control has been set."
1671,server/meson.build: support relative path for prebuilt_server,"If we don't do this trick, the prebuilt_server will be ../server/[the_user_defined_path]. In general, we will not give an relative path based on build directory, which leads to wrong prebuilt_server path. The building error: ninja: error: '../scrcpy-server-v1.7.jar', needed by 'server/scrcpy-server.jar', missing and no known rule to make it Signed-off-by: Yu-Chen Lin npes87184@gmail.com",server/meson.build: support relative path for prebuilt_server,"If we don't do this trick, the prebuilt_server will be ../server/[the_user_defined_path]. In general, we will not give an relative path based on build directory, which leads to wrong prebuilt_server path. The building error: ninja: error: '../scrcpy-server-v1.7.jar', needed by 'server/scrcpy-server.jar', missing and no known rule to make it Signed-off-by: Yu-Chen Lin npes87184@gmail.com"
1672,Do not init SDL video subsystem if no display,"The SDL video subsystem is not necessary if we don't display the video. Move the sdl_init_and_configure() function from screen.c to scrcpy.c, because it is not only related to the screen display.",Do not init SDL video subsystem if no display,"The SDL video subsystem is not necessary if we don't display the video. Move the sdl_init_and_configure() function from screen.c to scrcpy.c, because it is not only related to the screen display."
1673,Use explicit output parameter for skipped frame,"The function video_buffer_offer_decoded_frame() returned a bool to indicate whether the previous frame had been consumed. This was confusing, because we could expect the returned bool report whether the action succeeded. Make the semantic explicit by using an output parameter. Also revert the flag (report if the frame has been skipped instead of consumed) to avoid confusion for the first frame (the previous is neither skipped nor consumed because there is no previous frame).",Use explicit output parameter for skipped frame,"The function video_buffer_offer_decoded_frame() returned a bool to indicate whether the previous frame had been consumed. This was confusing, because we could expect the returned bool report whether the action succeeded. Make the semantic explicit by using an output parameter. Also revert the flag (report if the frame has been skipped instead of consumed) to avoid confusion for the first frame (the previous is neither skipped nor consumed because there is no previous frame)."
1674,Make owned serial a pointer-to-non-const,"The server owns the serial, so it needs to free it. Therefore, it should not be a pointer-to-const.",Make owned serial a pointer-to-non-const,"The server owns the serial, so it needs to free it. Therefore, it should not be a pointer-to-const."
1675,Replace SDL types by C99 standard types,Scrcpy is a C11 project. Use the C99 standard types instead of the SDL-specific types: SDL_bool -> bool SintXX   -> intXX_t UintXX   -> uintXX_t,Replace SDL types by C99 standard types,Scrcpy is a C11 project. Use the C99 standard types instead of the SDL-specific types: SDL_bool -> bool SintXX   -> intXX_t UintXX   -> uintXX_t
1676,Add option to mirror in read-only,Add an option to disable device control: -n/--no-control.,Add option to mirror in read-only,Add an option to disable device control: -n/--no-control.
1677,Rename -n/--no-window to -N/--no-display,"The description of scrcpy is ""Display and control your Android device"". We want an option to disable display, another one to disable control. For naming consistency, name it --no-display. Also change the shortname to -N, so that we can use -n for --no-control later.",Rename -n/--no-window to -N/--no-display,"The description of scrcpy is ""Display and control your Android device"". We want an option to disable display, another one to disable control. For naming consistency, name it --no-display. Also change the shortname to -N, so that we can use -n for --no-control later."
1678,Add missing no_window initialization,"Initialize the field no_window in ""struct args""",Add missing no_window initialization,"Initialize the field no_window in ""struct args"""
1679,Avoid unnecessary call if display is disabled,"If --no-window is passed, there is no need to register an event watcher.",Avoid unnecessary call if display is disabled,"If --no-window is passed, there is no need to register an event watcher."
1680,Extract event processing out of event_loop(),"To avoid too many levels of nested blocks, move the event handling logic in a separate function.",Extract event processing out of event_loop(),"To avoid too many levels of nested blocks, move the event handling logic in a separate function."
1681,Update code style,"Limit source code to 80 chars, and declare functions return type and modifiers on a separate line. This allows to avoid very long lines, and all function names are aligned. (We do this on VLC, and I like it.)",Update code style,"Limit source code to 80 chars, and declare functions return type and modifiers on a separate line. This allows to avoid very long lines, and all function names are aligned. (We do this on VLC, and I like it.)"
1682,Replace uint64_t by Uint64 for consistency,The field pts is declared Uint64 in struct frame_meta.,Replace uint64_t by Uint64 for consistency,The field pts is declared Uint64 in struct frame_meta.
1683,Describe the --no-window feature in README,,Describe the --no-window feature in README,
1684,Implement the --no-window flag,"Disable decoder, screen (display), file_handler and controller when --no-window is requested. https://github.com/Genymobile/scrcpy/pull/418",Implement the --no-window flag,"Disable decoder, screen (display), file_handler and controller when --no-window is requested. link"
1685,Add a new option: -n/--no-window,This option will allow scrcpy to record the stream without display. Signed-off-by: Romain Vimont rom@rom1v.com,Add a new option: -n/--no-window,This option will allow scrcpy to record the stream without display. Signed-off-by: Romain Vimont rom@rom1v.com
1686,Add stream layer,"The decoder initially read from the socket, decoded the video and sent the decoded frames to the screen:           +---------+      +----------+  socket ---> | decoder | ---> |  screen  |               +---------+      +----------+ The design was simple, but the decoder had several responsabilities. Then we added the recording feature, so we added a recorder, which reused the packets received from the socket managed by the decoder:                                 +----------+                            ---> |  screen  |           +---------+     /     +----------+  socket ---> | decoder | ----               +---------+     \     +----------+                                ---> | recorder |                                     +----------+ This lack of separation of concerns now have concrete implications: we could not (properly) disable the decoder/display to only record the video. Therefore, split the decoder to extract the stream:                                 +----------+      +----------+                            ---> | decoder  | ---> |  screen  |           +---------+     /     +----------+      +----------+  socket ---> | stream  | ----               +---------+     \     +----------+                                ---> | recorder |                                     +----------+ This will allow to record the stream without decoding the video.",Add stream layer,"The decoder initially read from the socket, decoded the video and sent the decoded frames to the screen:           +---------+      +----------+ socket ---> | decoder | ---> |  screen  |               +---------+      +----------+ The design was simple, but the decoder had several responsabilities. Then we added the recording feature, so we added a recorder, which reused the packets received from the socket managed by the decoder:                                 +----------+                            ---> |  screen  |           +---------+     /     +----------+ socket ---> | decoder | ----               +---------+     \     +----------+                                ---> | recorder |                                     +----------+ This lack of separation of concerns now have concrete implications: we could not (properly) disable the decoder/display to only record the video. Therefore, split the decoder to extract the stream:                                 +----------+      +----------+                            ---> | decoder  | ---> |  screen  |           +---------+     /     +----------+      +----------+ socket ---> | stream  | ----               +---------+     \     +----------+                                ---> | recorder |                                     +----------+ This will allow to record the stream without decoding the video."
1687,Store the recording request in a local bool,This avoids to test explicitly whether options->record_filename is NULL.,Store the recording request in a local bool,This avoids to test explicitly whether options->record_filename is NULL.
1688,Fix cleanup order,"The order of cleanup was not the reverse as the initialization order. As a consequence, recorder_destroy() could theoretically be called even if recorder_init() failed.",Fix cleanup order,"The order of cleanup was not the reverse as the initialization order. As a consequence, recorder_destroy() could theoretically be called even if recorder_init() failed."
1689,Fix recording with old decoding/encoding API,"The deprecated avcodec_decode_video2() should always the whole packet, so there is no need to loop (cf doc/examples/demuxing_decoding.c in FFmpeg). This hack changed the packet size and data pointer. This broke recording which used the same packet.",Fix recording with old decoding/encoding API,"The deprecated avcodec_decode_video2() should always the whole packet, so there is no need to loop (cf doc/examples/demuxing_decoding.c in FFmpeg). This hack changed the packet size and data pointer. This broke recording which used the same packet."
1690,"Rename ""stop"" to ""interrupt""","The purpose of video_buffer_stop() is to interrupt any blocking call, so rename it to video_buffer_interrupt().","Rename ""stop"" to ""interrupt""","The purpose of video_buffer_stop() is to interrupt any blocking call, so rename it to video_buffer_interrupt()."
1691,"Rename ""frames"" to ""video_buffer""",It better describes the purpose of the structure.,"Rename ""frames"" to ""video_buffer""",It better describes the purpose of the structure.
1692,Remove unused mutex field in decoder,,Remove unused mutex field in decoder,
1693,Add shortcut to expand/collapse notification panel,"Use Ctrl+n to expand, Ctrl+Shift+n to collapse. Fixes https://github.com/Genymobile/scrcpy/issues/392",Add shortcut to expand/collapse notification panel,"Use Ctrl+n to expand, Ctrl+Shift+n to collapse. Fixes link"
1694,"Use ""always on top"" only for SDL >= 2.0.5","The flag SDL_WINDOW_ALWAYS_ON_TOP is available since SDL 2.0.5. Do not use it if SDL is older, to fix compilation failure. Fixes https://github.com/Genymobile/scrcpy/issues/432","Use ""always on top"" only for SDL >= 2.0.5","The flag SDL_WINDOW_ALWAYS_ON_TOP is available since SDL 2.0.5. Do not use it if SDL is older, to fix compilation failure. Fixes link"
1695,Move all compat ifdefs definitions to compat.h,This allows to give a proper name to features requirements.,Move all compat ifdefs definitions to compat.h,This allows to give a proper name to features requirements.
1696,Update links to v1.7 in README and BUILD,,Update links to v1.7 in README and BUILD,
1697,Bump version to 1.7,,Bump version to 1.7,
1698,Allocate extradata with av_malloc(),"The extradata buffer is owned by libav, so it must be allocated with av_malloc(), not SDL_malloc(). This fixes a crash on Windows during avformat_free_context().",Allocate extradata with av_malloc(),"The extradata buffer is owned by libav, so it must be allocated with av_malloc(), not SDL_malloc(). This fixes a crash on Windows during avformat_free_context()."
1699,Regroup Windows-ifdefs in command.h,,Regroup Windows-ifdefs in command.h,
1700,Create process with wide chars on Windows,"Windows does not support UTF-8, so pushing a file with non-ASCII characters failed. Convert the UTF-8 command line to a wide characters string and call CreateProcessW(). Fixes https://github.com/Genymobile/scrcpy/issues/422",Create process with wide chars on Windows,"Windows does not support UTF-8, so pushing a file with non-ASCII characters failed. Convert the UTF-8 command line to a wide characters string and call CreateProcessW(). Fixes link"
1701,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1702,Add recording logs,Log when recording is started and stopped.,Add recording logs,Log when recording is started and stopped.
1703,Support recording to MKV,"Implement recording to Matroska files. The format to use is determined by the option -F/--record-format if set, or by the file extension ("".mp4"" or "".mkv"").",Support recording to MKV,"Implement recording to Matroska files. The format to use is determined by the option -F/--record-format if set, or by the file extension ("".mp4"" or "".mkv"")."
1704,Rescale packet timestamp to container time base,"Some containers force their own time base. For example, matroska overwrite time_base to (AVRational) {1, 1000}. Therefore, rescale our packet timestamps to the output stream time base. Suggested-by: Steve Lhomme robux4@ycbcr.xyz",Rescale packet timestamp to container time base,"Some containers force their own time base. For example, matroska overwrite time_base to (AVRational) {1, 1000}. Therefore, rescale our packet timestamps to the output stream time base. Suggested-by: Steve Lhomme robux4@ycbcr.xyz"
1705,Write header file with correct extradata,"When recording, the header must be written with extradata set to the content of the very first packet. Suggested-by: Steve Lhomme robux4@ycbcr.xyz Fixes https://github.com/Genymobile/scrcpy/issues/351 Fixes https://github.com/Genymobile/scrcpy/issues/416",Write header file with correct extradata,"When recording, the header must be written with extradata set to the content of the very first packet. Suggested-by: Steve Lhomme robux4@ycbcr.xyz Fixes link Fixes link"
1706,Forward FFmpeg logs,FFmpeg logs can be useful to understand the cause of issues.,Forward FFmpeg logs,FFmpeg logs can be useful to understand the cause of issues.
1707,Add log verbose macro,This was the only log priority missing.,Add log verbose macro,This was the only log priority missing.
1708,Fix memory leak on close,The buffer associated to the AVIOContext must be freed.,Fix memory leak on close,The buffer associated to the AVIOContext must be freed.
1709,Merge pull request #412 from npes87184/dev,app: add always_on_top,Merge pull request #412 from npes87184/dev,app: add always_on_top
1710,app: add always_on_top,It is very convenient when I play mobile game and watch video at the same time. Tested on Linux mint Cinnamon as well as Windows 10. Signed-off-by: Yu-Chen Lin npes87184@gmail.com,app: add always_on_top,It is very convenient when I play mobile game and watch video at the same time. Tested on Linux mint Cinnamon as well as Windows 10. Signed-off-by: Yu-Chen Lin npes87184@gmail.com
1711,Add release script,"Add a script to generate the whole release properly. It first builds locally in release mode, then execute tests. Then it builds archives for Windows. Finally, it puts all release files (Windows archives, prebuilt server and checksums) in a separate release directory.",Add release script,"Add a script to generate the whole release properly. It first builds locally in release mode, then execute tests. Then it builds archives for Windows. Finally, it puts all release files (Windows archives, prebuilt server and checksums) in a separate release directory."
1712,Merge pull request #411 from npes87184/master,tests: fix test_control_event_serialize,Merge pull request #411 from npes87184/master,tests: fix test_control_event_serialize
1713,tests: fix test_control_event_serialize,"commit fefb9816a changed the protocol, fix the related testing case. Signed-off-by: Yu-Chen Lin npes87184@gmail.com",tests: fix test_control_event_serialize,"commit fefb9816a changed the protocol, fix the related testing case. Signed-off-by: Yu-Chen Lin npes87184@gmail.com"
1714,Fix expected mouse event sizes,"Commit fefb9816a99e6f8fa59befcfb70ba87112f90a8d modified mouse events serialization. The server-side parsing was updated to correctly read the position, but the expected size of these events was not updated. As a result, the server might try to parse incomplete events, leading to BufferUnderflowException. Fixes https://github.com/Genymobile/scrcpy/issues/350#issuecomment-456298816.",Fix expected mouse event sizes,"Commit fefb9816a99e6f8fa59befcfb70ba87112f90a8d modified mouse events serialization. The server-side parsing was updated to correctly read the position, but the expected size of these events was not updated. As a result, the server might try to parse incomplete events, leading to BufferUnderflowException. Fixes link."
1715,Fix incorrect comment,Comment had not been updated along with the code.,Fix incorrect comment,Comment had not been updated along with the code.
1716,Update links to v1.6 in README and BUILD,,Update links to v1.6 in README and BUILD,
1717,Bump version to 1.6,,Bump version to 1.6,
1718,Merge branch 'dev' into master,,Merge branch 'dev' into master,
1719,Update FFmpeg (4.1) for Windows,Include the last version of FFmpeg in Windows releases.,Update FFmpeg (4.1) for Windows,Include the last version of FFmpeg in Windows releases.
1720,Do not disable screensaver,Keep screensaver enabled while scrcpy is running. Fixes https://github.com/Genymobile/scrcpy/issues/380.,Do not disable screensaver,Keep screensaver enabled while scrcpy is running. Fixes link.
1721,Merge pull request #401 from npes87184/dev,input_manager: don't ignore double click event when clicking inside device,Merge pull request #401 from npes87184/dev,input_manager: don't ignore double click event when clicking inside device
1722,input_manager: don't ignore double click event when clicking inside device,Signed-off-by: Yu-Chen Lin npes87184@gmail.com,input_manager: don't ignore double click event when clicking inside device,Signed-off-by: Yu-Chen Lin npes87184@gmail.com
1723,Merge pull request #396 from npes87184/master,prepare-dep: use variable for better readability,Merge pull request #396 from npes87184/master,prepare-dep: use variable for better readability
1724,"Mirror ""secure"" content","Some applications, like Silence, prevent the content of a window from being viewed on non-secure displays: https://developer.android.com/reference/android/view/WindowManager.LayoutParams.html#FLAG_SECURE We can mirror it by just creating a ""secure"" display: https://developer.android.com/reference/android/view/Display#FLAG_SECURE","Mirror ""secure"" content","Some applications, like Silence, prevent the content of a window from being viewed on non-secure displays: link We can mirror it by just creating a ""secure"" display: link"
1725,prepare-dep: use variable for better readability,"The arguments are saved to variable when script started. Instead of using $1, $2 and $3, we can use these variables. Signed-off-by: yuchenlin npes87184@gmail.com",prepare-dep: use variable for better readability,"The arguments are saved to variable when script started. Instead of using $1, $2 and $3, we can use these variables. Signed-off-by: yuchenlin npes87184@gmail.com"
1726,Make the server unlink itself,"To clean up the device, the client executed ""adb shell rm"" once the server was guaranteed to be started (after the connection succeeded). This implied to track whether the installation state, and failed if an additional tunnel was used in ""forward"" mode: https://github.com/Genymobile/scrcpy/issues/386#issuecomment-453936034 Instead, make the server unlink itself on start.",Make the server unlink itself,"To clean up the device, the client executed ""adb shell rm"" once the server was guaranteed to be started (after the connection succeeded). This implied to track whether the installation state, and failed if an additional tunnel was used in ""forward"" mode: link Instead, make the server unlink itself on start."
1727,Handle mouse events outside device screen,"Mouse events position were unsigned (so negative values could not be handled properly). To avoid issues with negative values, mouse events outside the device screen were ignored (commit a7fe9ad779057f7a2698fc1769dce3c3786993ee). But as a consequence, drag&drop were ""broken"" if the ""drop"" occurred outside the device screen. Instead, use signed 32-bits to store the position, and forward events outside the device screen. Fixes https://github.com/Genymobile/scrcpy/issues/357.",Handle mouse events outside device screen,"Mouse events position were unsigned (so negative values could not be handled properly). To avoid issues with negative values, mouse events outside the device screen were ignored (commit a7fe9ad779057f7a2698fc1769dce3c3786993ee). But as a consequence, drag&drop were ""broken"" if the ""drop"" occurred outside the device screen. Instead, use signed 32-bits to store the position, and forward events outside the device screen. Fixes link."
1728,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1729,Add a note to allow simulating input in README,,Add a note to allow simulating input in README,
1730,Add ninja-build to the packages list to install,"The package ninja-build should be installed automatically as a meson dependency, but some users need to install a newer meson from pip3, so ninja must be installed explicitly.",Add ninja-build to the packages list to install,"The package ninja-build should be installed automatically as a meson dependency, but some users need to install a newer meson from pip3, so ninja must be installed explicitly."
1731,Ignore mouse events outside device screen,"Never create a ""struct point"" with a position possibly outside the device screen (i.e. in the black borders area), and do not transmit such events. This fixes an assertion failure on mouse wheel events outside the device screen area.",Ignore mouse events outside device screen,"Never create a ""struct point"" with a position possibly outside the device screen (i.e. in the black borders area), and do not transmit such events. This fixes an assertion failure on mouse wheel events outside the device screen area."
1732,Always use non-empty arguments,"The client passes parameters to the server via ""adb shell"" arguments. Use ""-"" instead of """" when no crop is specified to avoid empty arguments, which are not handled the same way on all devices. Fixed https://github.com/Genymobile/scrcpy/issues/337.",Always use non-empty arguments,"The client passes parameters to the server via ""adb shell"" arguments. Use ""-"" instead of """" when no crop is specified to avoid empty arguments, which are not handled the same way on all devices. Fixed link."
1733,Always expect 5 parameters for the server,"The client always sends all the arguments, so there is no need to check.",Always expect 5 parameters for the server,"The client always sends all the arguments, so there is no need to check."
1734,Point out that ninja must not be run as root,See https://github.com/Genymobile/scrcpy/issues/335.,Point out that ninja must not be run as root,See link.
1735,Move drag&drop features in README,"Present how to install an APK and how to push a file in the ""features"" section (instead of ""shortcuts"").",Move drag&drop features in README,"Present how to install an APK and how to push a file in the ""features"" section (instead of ""shortcuts"")."
1736,Fix read_packet() return value on error or EOF,Fix warning on error or EOF:  Invalid return value 0 for stream protocol  See http://git.videolan.org/?p=ffmpeg.git;a=commitdiff;h=a606f27f4c610708fa96e35eed7b7537d3d8f712. Fixes https://github.com/Genymobile/scrcpy/issues/333.,Fix read_packet() return value on error or EOF,Fix warning on error or EOF: Invalid return value 0 for stream protocol See link. Fixes link.
1737,Configure version at meson project level,"Make meson aware of the project version, so that it does not print: Project version: undefined",Configure version at meson project level,"Make meson aware of the project version, so that it does not print: Project version: undefined"
1738,Update links to v1.5-fixversion,"I forgot to bump version before the release, so I had to make a new one which fixes the version string (for scrcpy --help).",Update links to v1.5-fixversion,"I forgot to bump version before the release, so I had to make a new one which fixes the version string (for scrcpy --help)."
1739,Bump version to 1.5,Signed-off-by: Romain Vimont rom@rom1v.com,Bump version to 1.5,Signed-off-by: Romain Vimont rom@rom1v.com
1740,Update links to v1.5 in README and BUILD,,Update links to v1.5 in README and BUILD,
1741,Improve features presentation in README,,Improve features presentation in README,
1742,Merge branch 'record' into dev (#292),Record screen to file,Merge branch 'record' into dev (#292),Record screen to file
1743,Do not queue invalid PTS,"Configuration packets produced by MediaCodec have no valid PTS, and do not produce frame. Do not queue their (invalid) PTS not to break the matching between frames and their PTS.",Do not queue invalid PTS,"Configuration packets produced by MediaCodec have no valid PTS, and do not produce frame. Do not queue their (invalid) PTS not to break the matching between frames and their PTS."
1744,Store queue of PTS for pending frames,"Several frames may be read by read_packet() before they are consumed (returned by av_read_frame()), so we need to store the PTS of frames in order, so that the right PTS is assigned to the right frame.",Store queue of PTS for pending frames,"Several frames may be read by read_packet() before they are consumed (returned by av_read_frame()), so we need to store the PTS of frames in order, so that the right PTS is assigned to the right frame."
1745,Send frame meta only if recording is enabled,"The client needs the PTS for each frame only if recording is enabled. Otherwise, the PTS are not necessary, and the protocol is more straighforward.",Send frame meta only if recording is enabled,"The client needs the PTS for each frame only if recording is enabled. Otherwise, the PTS are not necessary, and the protocol is more straighforward."
1746,Rename --output-file to --record,To record the screen to a local file: scrcpy --record file.mp4,Rename --output-file to --record,To record the screen to a local file: scrcpy --record file.mp4
1747,Wrap receiver state into separate struct,"For readability, wrap the state of the receiver in a separate struct receiver_state.",Wrap receiver state into separate struct,"For readability, wrap the state of the receiver in a separate struct receiver_state."
1748,Avoid partial header reads,"Use net_recv_all() to avoid partial reads for the ""meta"" header (this would break the whole stream).",Avoid partial header reads,"Use net_recv_all() to avoid partial reads for the ""meta"" header (this would break the whole stream)."
1749,Move buffer reader functions to buffer_util.h,,Move buffer reader functions to buffer_util.h,
1750,Support AVStream.codec for old FFmpeg versions,"AVStream.codec has been deprecated in favor of AVStream.codecpar. Due to the FFmpeg/Libav split, this happened in two separate versions:  - 57.33.100 for FFmpeg  - 57.5.0 for Libav",Support AVStream.codec for old FFmpeg versions,"AVStream.codec has been deprecated in favor of AVStream.codecpar. Due to the FFmpeg/Libav split, this happened in two separate versions:  - 57.33.100 for FFmpeg  - 57.5.0 for Libav"
1751,recorder: use av_oformat_next to support older FFmpeg,Signed-off-by: yuchenlin npes87184@gmail.com,recorder: use av_oformat_next to support older FFmpeg,Signed-off-by: yuchenlin npes87184@gmail.com
1752,Reenable custom SDL signal handlers,"This partially reverts commit f00c6c5b1321860eb6d590928448778ec8f43278. On Ctrl+C, we need to execute cleanup code. For instance, if recording is enabled, we need to write MP4 file trailer on exit. Custom SDL signal handlers were disabled because it leaded to process hanging on Ctrl+C during network calls on initialization, but now it seems to work correctly, the network calls return immediately on signal.",Reenable custom SDL signal handlers,"This partially reverts commit f00c6c5b1321860eb6d590928448778ec8f43278. On Ctrl+C, we need to execute cleanup code. For instance, if recording is enabled, we need to write MP4 file trailer on exit. Custom SDL signal handlers were disabled because it leaded to process hanging on Ctrl+C during network calls on initialization, but now it seems to work correctly, the network calls return immediately on signal."
1753,Do not transmit MediaCodec flags,"Since PTS handling has been fixed, the recorder do not associate a PTS to a wrong frame anymore, so PTS of ""configuration packets"" (which never produce a frame), are never read by the recorder. Therefore, there is no need to ignore them explicitly, so we can remove the MediaCodec flags completely.",Do not transmit MediaCodec flags,"Since PTS handling has been fixed, the recorder do not associate a PTS to a wrong frame anymore, so PTS of ""configuration packets"" (which never produce a frame), are never read by the recorder. Therefore, there is no need to ignore them explicitly, so we can remove the MediaCodec flags completely."
1754,Assign PTS to the right frame,"The PTS was read from the socket and set as the current one even before the frame was consumed, so it could be assigned to the previous frame ""in advance"". Store the PTS for the current frame and the last PTS read from the packet header of the next frame in separate fields. As a side-effect, this fixes the warning on quit:  Application provided invalid, non monotonically increasing dts to muxer in stream 0: 17164020 >= 17164020",Assign PTS to the right frame,"The PTS was read from the socket and set as the current one even before the frame was consumed, so it could be assigned to the previous frame ""in advance"". Store the PTS for the current frame and the last PTS read from the packet header of the next frame in separate fields. As a side-effect, this fixes the warning on quit: Application provided invalid, non monotonically increasing dts to muxer in stream 0: 17164020 >= 17164020"
1755,Decode and push frame before recording,"Handle display before recording, to reduce latency.",Decode and push frame before recording,"Handle display before recording, to reduce latency."
1756,Only set valid PTS/DTS,"When the PTS is valid, set both PTS and DTS to avoid FFmpeg warnings. Since configuration packets have no PTS, do not record these packets.",Only set valid PTS/DTS,"When the PTS is valid, set both PTS and DTS to avoid FFmpeg warnings. Since configuration packets have no PTS, do not record these packets."
1757,Add recorder,"Implement recording in a separate ""class"".",Add recorder,"Implement recording in a separate ""class""."
1758,"Enable video output file, with pts set by server",,"Enable video output file, with pts set by server",
1759,Fix SDL 2.0.9 for Windows,Add missing version upgrade in cross_winXX.txt files.,Fix SDL 2.0.9 for Windows,Add missing version upgrade in cross_winXX.txt files.
1760,Update SDL (2.0.9) for Windows,Include the last version of SDL in Windows releases.,Update SDL (2.0.9) for Windows,Include the last version of SDL in Windows releases.
1761,Extract bit operations to buffer_util.h,Move util functions to a reusable separate header.,Extract bit operations to buffer_util.h,Move util functions to a reusable separate header.
1762,Explain how to install up-to-date meson,"On Ubuntu 16.04, meson is 0.29, while scrcpy requires >= 0.37. Explain how to install a newer version from pip3.",Explain how to install up-to-date meson,"On Ubuntu 16.04, meson is 0.29, while scrcpy requires >= 0.37. Explain how to install a newer version from pip3."
1763,Add feature test macro to declare kill(),Avoid the following warning on some systems:  warning: implicit declaration of function 'kill' [-Wimplicit-function-declaration],Add feature test macro to declare kill(),Avoid the following warning on some systems: warning: implicit declaration of function 'kill' [-Wimplicit-function-declaration]
1764,Fix memory leak on error,"On decode error, unref the packet.",Fix memory leak on error,"On decode error, unref the packet."
1765,Replace Ctrl by Meta for volume shortcuts on MacOS,Ctrl+UP and Ctrl+DOWN are already used by the window manager on MacOS. Use Cmd key instead (like on VLC).,Replace Ctrl by Meta for volume shortcuts on MacOS,Ctrl+UP and Ctrl+DOWN are already used by the window manager on MacOS. Use Cmd key instead (like on VLC).
1766,Refactor to support Meta in shortcuts,"Move the Ctrl and Meta key down checks to each shortcut individually, so that we can add a shortcut involving Meta.",Refactor to support Meta in shortcuts,"Move the Ctrl and Meta key down checks to each shortcut individually, so that we can add a shortcut involving Meta."
1767,Merge pull request #310 from npes87184/master,fix text memory leak,Merge pull request #310 from npes87184/master,fix text memory leak
1768,input_manager: fix potential memory leak on text,Fix potential memory leak when controller_push_event failed. Signed-off-by: yuchenlin npes87184@gmail.com,input_manager: fix potential memory leak on text,Fix potential memory leak when controller_push_event failed. Signed-off-by: yuchenlin npes87184@gmail.com
1769,Capture Alt and Meta keys,"Alt and Meta keys should not be forwarded to the device. For now, they are not used for shortcuts, but they could be.",Capture Alt and Meta keys,"Alt and Meta keys should not be forwarded to the device. For now, they are not used for shortcuts, but they could be."
1770,Factorize Windows command building,Extract command line building to a separate method.,Factorize Windows command building,Extract command line building to a separate method.
1771,Work around Os.write() not updating position,ByteBuffer position is not updated as expected by Os.write() on old Android versions. Count the remaining bytes manually. Fixes https://github.com/Genymobile/scrcpy/issues/291.,Work around Os.write() not updating position,ByteBuffer position is not updated as expected by Os.write() on old Android versions. Count the remaining bytes manually. Fixes link.
1772,Support paths containing spaces on Windows,"Quote the arguments of ""adb push"" to support paths which contain spaces on Windows. Fixes https://github.com/Genymobile/scrcpy/issues/288.",Support paths containing spaces on Windows,"Quote the arguments of ""adb push"" to support paths which contain spaces on Windows. Fixes link."
1773,Declare fun(void) functions with no parameters,This is not C++.,Declare fun(void) functions with no parameters,This is not C++.
1774,Update links to v1.4 in README and BUILD,,Update links to v1.4 in README and BUILD,
1775,Update platform-tools (28.0.1) for Windows,Include the latest version of adb in Windows releases.,Update platform-tools (28.0.1) for Windows,Include the latest version of adb in Windows releases.
1776,Bump version to 1.4,,Bump version to 1.4,
1777,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1778,Handle alpha and space chars as raw events,"To handle special chars, text is handled as text input instead of key events. However, this breaks the separation of DOWN and UP key events. As a compromise, send letters and space as key events, to preserve original DOWN/UP events, but send other text input events as text, to be able to send ""special"" characters. Fixes https://github.com/Genymobile/scrcpy/issues/87. Suggested-by: pete1414 Suggested-by: King-Slide kingslide@gmail.com",Handle alpha and space chars as raw events,"To handle special chars, text is handled as text input instead of key events. However, this breaks the separation of DOWN and UP key events. As a compromise, send letters and space as key events, to preserve original DOWN/UP events, but send other text input events as text, to be able to send ""special"" characters. Fixes link. Suggested-by: pete1414 Suggested-by: King-Slide kingslide@gmail.com"
1779,Add link to Gentoo Ebuild in README,,Add link to Gentoo Ebuild in README,
1780,Merge pull request #261 from npes87184/dev,prevent closing console right after process error in windows,Merge pull request #261 from npes87184/dev,prevent closing console right after process error in windows
1781,prevent closing console right after process error in windows,Signed-off-by: yuchenlin npes87184@gmail.com,prevent closing console right after process error in windows,Signed-off-by: yuchenlin npes87184@gmail.com
1782,Fix header guard name,,Fix header guard name,
1783,Merge branch 'npes87184:dev' into dev (#254),Return specific error for missing adb binary on Windows,Merge branch 'npes87184:dev' into dev (#254),Return specific error for missing adb binary on Windows
1784,Use specific error for missing binary on Windows,Signed-off-by: yuchenlin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com,Use specific error for missing binary on Windows,Signed-off-by: yuchenlin npes87184@gmail.com Signed-off-by: Romain Vimont rom@rom1v.com
1785,Avoid additional buffer copy in userspace,"Directly send the data from MediaCodec buffers to the LocalSocket, without an intermediate copy in userspace.",Avoid additional buffer copy in userspace,"Directly send the data from MediaCodec buffers to the LocalSocket, without an intermediate copy in userspace."
1786,Merge branch 'philippsandhaus:master' into dev (#252),Added new command line parameter to start in fullscreen,Merge branch 'philippsandhaus:master' into dev (#252),Added new command line parameter to start in fullscreen
1787,Present fullscreen option in README,,Present fullscreen option in README,
1788,Add option to start in fullscreen,Signed-off-by: Romain Vimont rom@rom1v.com,Add option to start in fullscreen,Signed-off-by: Romain Vimont rom@rom1v.com
1789,Merge branch 'npes87184:dev' into dev (#236),check adb runnable before starting scrcpy,Merge branch 'npes87184:dev' into dev (#236),check adb runnable before starting scrcpy
1790,Do not handle system-specific values in command.c,"The common command.c handled process errors from system-specific int values (errno). Rather, expose a new enum process_result to handle error cause in a generic way.",Do not handle system-specific values in command.c,"The common command.c handled process errors from system-specific int values (errno). Rather, expose a new enum process_result to handle error cause in a generic way."
1791,Notify adb missing,"There are many user who encounters missing adb. To stop things happens again, we check it and show sexy response to user. Signed-off-by: yuchenlin npes87184@gmail.com",Notify adb missing,"There are many user who encounters missing adb. To stop things happens again, we check it and show sexy response to user. Signed-off-by: yuchenlin npes87184@gmail.com"
1792,Add link to FLAG_SECURE in FAQ,,Add link to FLAG_SECURE in FAQ,
1793,Explain how to install adb on Mac OS,The package scrcpy from Homebrew does not install adb.,Explain how to install adb on Mac OS,The package scrcpy from Homebrew does not install adb.
1794,Separate build instructions from README,"README included build instructions, which made it complicated to follow. Move the build instructions to a separate file (BUILD.md).",Separate build instructions from README,"README included build instructions, which made it complicated to follow. Move the build instructions to a separate file (BUILD.md)."
1795,Update FFmpeg (4.0.2) for Windows,Include the last version of FFmpeg in Windows releases.,Update FFmpeg (4.0.2) for Windows,Include the last version of FFmpeg in Windows releases.
1796,Update platform-tools (28.0.0) for Windows,Include the last version of adb in Windows releases. Fixes https://github.com/Genymobile/scrcpy/issues/224.,Update platform-tools (28.0.0) for Windows,Include the last version of adb in Windows releases. Fixes link.
1797,Add missing include for lock_util.h,lock_util.c did not include lock_util.h. This was catched by the gcc option -Wmissing-prototypes.,Add missing include for lock_util.h,lock_util.c did not include lock_util.h. This was catched by the gcc option -Wmissing-prototypes.
1798,Separate multi-words filenames by '_',Rename foobar.ext to foo_bar.ext. https://github.com/Genymobile/scrcpy/pull/226#discussion_r209454865,Separate multi-words filenames by '_',Rename foobar.ext to foo_bar.ext. link
1799,"Document ""push file"" feature",Document how to push a file to /sdcard/ in the shortcuts list.,"Document ""push file"" feature",Document how to push a file to /sdcard/ in the shortcuts list.
1800,Make request_queue functions static,These functions are local to file_handler.c.,Make request_queue functions static,These functions are local to file_handler.c.
1801,Simplify SDL_assert() calls,"SDL_assert() already prevents ""unused variable"" warnings.",Simplify SDL_assert() calls,"SDL_assert() already prevents ""unused variable"" warnings."
1802,Add missing include config.h,"When config.h is not included, BUILD_DEBUG is not set.",Add missing include config.h,"When config.h is not included, BUILD_DEBUG is not set."
1803,Merge branch 'npes87184:push_file_to_sdcard' into dev (#226),support drag & drop file to device /sdcard,Merge branch 'npes87184:push_file_to_sdcard' into dev (#226),support drag & drop file to device /sdcard
1804,Support drag&drop a file to transfer it to device,Signed-off-by: npes87184 npes87184@gmail.com,Support drag&drop a file to transfer it to device,Signed-off-by: npes87184 npes87184@gmail.com
1805,installer -> file_handler,Signed-off-by: npes87184 npes87184@gmail.com,installer -> file_handler,Signed-off-by: npes87184 npes87184@gmail.com
1806,Reset current installer process,"The current_process field was never reset after an installation is complete. As a consequence, installer_stop() attempted to terminate it, leading to a warning, at best.",Reset current installer process,"The current_process field was never reset after an installation is complete. As a consequence, installer_stop() attempted to terminate it, leading to a warning, at best."
1807,Return non-zero value on connection loss,"Make scrscpy to return 0 exit code only in case when the user closes its app, otherwise, i.e. in case of connection loss, return 1.",Return non-zero value on connection loss,"Make scrscpy to return 0 exit code only in case when the user closes its app, otherwise, i.e. in case of connection loss, return 1."
1808,Remove AINPUT_SOURCE_ANY value,"In the Android input header file, an enum has a value taking more than 31 bits, leading to the following warning: ISO C restricts enumerator values to range of int  Since we don't use it, remove it.",Remove AINPUT_SOURCE_ANY value,"In the Android input header file, an enum has a value taking more than 31 bits, leading to the following warning: ISO C restricts enumerator values to range of int Since we don't use it, remove it."
1809,Replace Uint32 by int to fix warnings in tinyxpm,,Replace Uint32 by int to fix warnings in tinyxpm,
1810,Explicitly use ISO C11,ISO C99 doesn't support unnamed structs/unions.,Explicitly use ISO C11,ISO C99 doesn't support unnamed structs/unions.
1811,Destroy mutex if strdup failed,Signed-off-by: npes87184 npes87184@gmail.com,Destroy mutex if strdup failed,Signed-off-by: npes87184 npes87184@gmail.com
1812,Merge pull request #225 from npes87184/master,remove redundant semicolon,Merge pull request #225 from npes87184/master,remove redundant semicolon
1813,remove redundant semicolon,Signed-off-by: npes87184 npes87184@gmail.com,remove redundant semicolon,Signed-off-by: npes87184 npes87184@gmail.com
1814,Update links to v1.3 in README,,Update links to v1.3 in README,
1815,Bump version to 1.3,,Bump version to 1.3,
1816,Add crop feature,Add an option to crop the screen on the server. This allows to mirror only part of the device screen.,Add crop feature,Add an option to crop the screen on the server. This allows to mirror only part of the device screen.
1817,Move annotation comment,This confused the Android Studio code formatter.,Move annotation comment,This confused the Android Studio code formatter.
1818,Extract video size computation,"One method, one thing.",Extract video size computation,"One method, one thing."
1819,"Increase ""adb forward"" connection attempts",5 seconds might not be sufficient: https://github.com/Genymobile/scrcpy/issues/213 Increase to 10 seconds (it does not harm).,"Increase ""adb forward"" connection attempts",5 seconds might not be sufficient: link Increase to 10 seconds (it does not harm).
1820,Do not call deprecated av_register_all(),av_register_all() is deprecated in FFmpeg since this commit: http://git.videolan.org/?p=ffmpeg.git;a=commitdiff;h=0694d8702421e7aff1340038559c438b61bb30dd It is now useless to call it: https://ffmpeg.org/pipermail/ffmpeg-devel/2018-February/225051.html Fixes https://github.com/Genymobile/scrcpy/issues/203.,Do not call deprecated av_register_all(),av_register_all() is deprecated in FFmpeg since this commit: link It is now useless to call it: link Fixes link.
1821,Simplify README for Windows users,So that users stop downloading platform-tools unnecessarily.,Simplify README for Windows users,So that users stop downloading platform-tools unnecessarily.
1822,Forward repeated volume events,Send repeated events when holding volume up/down shortcuts.,Forward repeated volume events,Send repeated events when holding volume up/down shortcuts.
1823,Send separate DOWN/UP key events,"Shortcuts generated instant DOWN/UP key events. Instead, generate DOWN event on Ctrl+key down and UP event on Ctrl+key up. Fixes https://github.com/Genymobile/scrcpy/issues/166.",Send separate DOWN/UP key events,"Shortcuts generated instant DOWN/UP key events. Instead, generate DOWN event on Ctrl+key down and UP event on Ctrl+key up. Fixes link."
1824,Improve English comment,"Replace ""implying"" by ""involving"" (both ""impliquant"" in French).",Improve English comment,"Replace ""implying"" by ""involving"" (both ""impliquant"" in French)."
1825,Prevent killing unexpected process,"A missing initialization (fixed by the previous commit) leaded to kill unexpected process. In order to prevent consequences of similar errors in the future, never call kill() with a non-positive PID. See https://github.com/Genymobile/scrcpy/issues/182.",Prevent killing unexpected process,"A missing initialization (fixed by the previous commit) leaded to kill unexpected process. In order to prevent consequences of similar errors in the future, never call kill() with a non-positive PID. See link."
1826,Fix missing installer initialization,"The current_process field of struct installer was not initialized. Since the installer instance is static, its default value was 0. The call to installer_stop() then called kill(0, SIGTERM) (on Linux), which sent SIGTERM to every process in the process group. In particular, the scrcpy process was killed. As a consequence, the last cleanup steps, like disabling ""show touches"", were not executed. Fixes https://github.com/Genymobile/scrcpy/issues/183.",Fix missing installer initialization,"The current_process field of struct installer was not initialized. Since the installer instance is static, its default value was 0. The call to installer_stop() then called kill(0, SIGTERM) (on Linux), which sent SIGTERM to every process in the process group. In particular, the scrcpy process was killed. As a consequence, the last cleanup steps, like disabling ""show touches"", were not executed. Fixes link."
1827,Merge pull request #169 from zopelee/master,Fix meson error: for loop initial declarations are only allowed in ,Merge pull request #169 from zopelee/master,Fix meson error: for loop initial declarations are only allowed in 
1828,Fix meson error: for loop initial declarations are only allowed in C99 mode.,,Fix meson error: for loop initial declarations are only allowed in C99 mode.,
1829,Use a meson option to crossbuild for Windows,"Meson decided to crossbuild for Windows as soon as meson.is_cross_build() returned true. This made non-Windows crossbuilds fail. Instead, add an explicit option ""crossbuild_windows"". Fixes https://github.com/Genymobile/scrcpy/issues/165.",Use a meson option to crossbuild for Windows,"Meson decided to crossbuild for Windows as soon as meson.is_cross_build() returned true. This made non-Windows crossbuilds fail. Instead, add an explicit option ""crossbuild_windows"". Fixes link."
1830,Fix clean recipe in cross Makefile,"Make the ""clean"" recipe also remove the noconsole build directories.",Fix clean recipe in cross Makefile,"Make the ""clean"" recipe also remove the noconsole build directories."
1831,Upgrade gradle,,Upgrade gradle,
1832,Update links to v1.2 in README,,Update links to v1.2 in README,
1833,Bump version to 1.2,,Bump version to 1.2,
1834,Rename SHA256SUM to SHA256SUMS,It contains the checksums for several files.,Rename SHA256SUM to SHA256SUMS,It contains the checksums for several files.
1835,"Make CreateProcess() flags depend on ""noconsole""","On Windows, display the output of external commands (adb) when a console is available.","Make CreateProcess() flags depend on ""noconsole""","On Windows, display the output of external commands (adb) when a console is available."
1836,Update README and FAQ for the new Windows releases,"Document how to generate a Windows release from Linux. It solves the ""no output"" issue on Windows, so update the FAQ.",Update README and FAQ for the new Windows releases,"Document how to generate a Windows release from Linux. It solves the ""no output"" issue on Windows, so update the FAQ."
1837,"Also build ""noconsole"" binary for Windows","On Windows, an application is either console or gui, it cannot be both. Scrcpy should be both: it outputs important information to console, but we still want to be able to ignore the console and launch it without a visible cmd.exe window. Therefore, build two binaries:  - scrcpy.exe  - scrcpy-noconsole.exe","Also build ""noconsole"" binary for Windows","On Windows, an application is either console or gui, it cannot be both. Scrcpy should be both: it outputs important information to console, but we still want to be able to ignore the console and launch it without a visible cmd.exe window. Therefore, build two binaries:  - scrcpy.exe  - scrcpy-noconsole.exe"
1838,Add cross-compilation scripts for Windows,"Build the Windows binary from mingw on Linux, using the official prebuilt binaries for ffmpeg, SDL2 and adb. MSYS2 and all its packaged dll are not necessary anymore.",Add cross-compilation scripts for Windows,"Build the Windows binary from mingw on Linux, using the official prebuilt binaries for ffmpeg, SDL2 and adb. MSYS2 and all its packaged dll are not necessary anymore."
1839,Indicate that libs are included for Windows,,Indicate that libs are included for Windows,
1840,Indicate that scrcpy also works over TCP/IP,,Indicate that scrcpy also works over TCP/IP,
1841,Document APK drag & drop,Add the drag & drop shortcut for installing an APK file to the README and the help.,Document APK drag & drop,Add the drag & drop shortcut for installing an APK file to the README and the help.
1842,Quote apk path on Windows,"Windows will parse the string, so the local name must be quoted.",Quote apk path on Windows,"Windows will parse the string, so the local name must be quoted."
1843,Drag and drop to install apk files from computer,https://github.com/Genymobile/scrcpy/pull/133,Drag and drop to install apk files from computer,link
1844,Fix net_send_all() warning,"If len is not positive, w could be returned uninitialized.",Fix net_send_all() warning,"If len is not positive, w could be returned uninitialized."
1845,Fix proc_show_touches warning,"In practice, proc_show_touches may not be used uninitialized, since it checks the flag options->show_touches, but the compiler can't know that, so initialize it to avoid the warning.",Fix proc_show_touches warning,"In practice, proc_show_touches may not be used uninitialized, since it checks the flag options->show_touches, but the compiler can't know that, so initialize it to avoid the warning."
1846,Release controller lock while processing events,"Once the controller took a control event, release the mutex before processing it, so that the main thread is not blocked to push a new event.",Release controller lock while processing events,"Once the controller took a control event, release the mutex before processing it, so that the main thread is not blocked to push a new event."
1847,Fix leak on server start error,"Fail on SDL_strdup() failure, and free the duplicated serial on further error.",Fix leak on server start error,"Fail on SDL_strdup() failure, and free the duplicated serial on further error."
1848,Add missing includes,Include string.h and stdio.h explicitly.,Add missing includes,Include string.h and stdio.h explicitly.
1849,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1850,Map numpad ENTER key,Forward numpad ENTER key to the device. Fixes https://github.com/Genymobile/scrcpy/issues/117.,Map numpad ENTER key,Forward numpad ENTER key to the device. Fixes link.
1851,Add FAQ section about KWin crash,Link to the workaround to keep the compositor enabled while scrcpy is running.,Add FAQ section about KWin crash,Link to the workaround to keep the compositor enabled while scrcpy is running.
1852,"Avoid pointer arithmetic on ""void *""",Fix the following warning (with -Wpedantic enabled): pointer of type void * used in arithmetic [-Wpointer-arith],"Avoid pointer arithmetic on ""void """,Fix the following warning (with -Wpedantic enabled): pointer of type void  used in arithmetic [-Wpointer-arith]
1853,Use const pointers when possible,"Sending data only require to read the input buffer, so declare it const.",Use const pointers when possible,"Sending data only require to read the input buffer, so declare it const."
1854,Change volume shortcuts,"I could not make Ctrl+'+' and Ctrl+'-' work for every keyboard on every platform. Instead, use Ctrl+UP and Ctrl+DOWN (like in VLC) to change the volume. Fixes https://github.com/Genymobile/scrcpy/issues/103.",Change volume shortcuts,"I could not make Ctrl+'+' and Ctrl+'-' work for every keyboard on every platform. Instead, use Ctrl+UP and Ctrl+DOWN (like in VLC) to change the volume. Fixes link."
1855,Document 32 bits packages Windows in README,"To build for Windows 32 bits, use the i686 packages instead.",Document 32 bits packages Windows in README,"To build for Windows 32 bits, use the i686 packages instead."
1856,Make checkstyle happy,Reorder the imports to remove checkstyle warnings.,Make checkstyle happy,Reorder the imports to remove checkstyle warnings.
1857,Install on macOS via Homebrew in README,The application is now packaged for Homebrew: https://github.com/Homebrew/homebrew-core/pull/25173 Give instructions to install it from Homebrew for macOS (it's much easier). Thanks to @stek29 for the formula ;-),Install on macOS via Homebrew in README,The application is now packaged for Homebrew: link Give instructions to install it from Homebrew for macOS (it's much easier). Thanks to @stek29 for the formula ;-)
1858,Document how to make a portable build on Windows,"On MSYS2, ./gradlew does not work as expected, so use its absolute path.",Document how to make a portable build on Windows,"On MSYS2, ./gradlew does not work as expected, so use its absolute path."
1859,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1860,Factorize texture creation,"SDL_CreateTexture() is called both during initialization and on frame size change. To avoid inconsistent changes to arguments value, factorize them to a single function create_texture().",Factorize texture creation,"SDL_CreateTexture() is called both during initialization and on frame size change. To avoid inconsistent changes to arguments value, factorize them to a single function create_texture()."
1861,Forward double-click events,"Double-clicks were not sent to the device anymore since the ""double-click on black borders"" feature. When a double click occurs inside the device screen, send the event to the device normally. Fixes https://github.com/Genymobile/scrcpy/issues/97.",Forward double-click events,"Double-clicks were not sent to the device anymore since the ""double-click on black borders"" feature. When a double click occurs inside the device screen, send the event to the device normally. Fixes link."
1862,Improve startup time when show_touches is enabled,"Enabling ""show touches"" involves the execution of an adb command, which takes some time. In order to parallelize, execute the command as soon as possible, but reap the process only once everything is initialized.",Improve startup time when show_touches is enabled,"Enabling ""show touches"" involves the execution of an adb command, which takes some time. In order to parallelize, execute the command as soon as possible, but reap the process only once everything is initialized."
1863,"Disable ""show touches"" once window is closed","If --show-touches is set, then the option must be disabled on quit. Since it executes an adb command, it takes some time, so close the window beforehand so that the close window button does not seem unresponsive.","Disable ""show touches"" once window is closed","If --show-touches is set, then the option must be disabled on quit. Since it executes an adb command, it takes some time, so close the window beforehand so that the close window button does not seem unresponsive."
1864,"Add an option to enable ""show touches""",Add -t/--show-touches option to show physical touches while scrcpy is running. See https://github.com/Genymobile/scrcpy/issues/96.,"Add an option to enable ""show touches""",Add -t/--show-touches option to show physical touches while scrcpy is running. See link.
1865,Group scrcpy options into a struct,"The scrcpy() function accepts as many parameters as there are options. To simplify, group all options in a separate struct.",Group scrcpy options into a struct,"The scrcpy() function accepts as many parameters as there are options. To simplify, group all options in a separate struct."
1866,Merge branch 'master' into dev,,Merge branch 'master' into dev,
1867,Merge branch 'stek29/macos' (#56),macOS specific README changes,Merge branch 'stek29/macos' (#56),macOS specific README changes
1868,Add instructions to install Java 8 on macOS,"And remove gcc from the packages list, clang is available by default.",Add instructions to install Java 8 on macOS,"And remove gcc from the packages list, clang is available by default."
1869,Merge pull request #94 from pierlon/pierlon-patch-1,Add instructions to run via Docker,Merge pull request #94 from pierlon/pierlon-patch-1,Add instructions to run via Docker
1870,Merge pull request #95 from Sea-n/patch-1,Update README.md,Merge pull request #95 from Sea-n/patch-1,Update README.md
1871,Update README.md,Fix Typo,Update README.md,Fix Typo
1872,Add instructions to run via Docker,,Add instructions to run via Docker,
1873,Merge pull request #93 from CampbellOwen/patch-1,Add links to FFmpeg and LibSDL2 dependencies,Merge pull request #93 from CampbellOwen/patch-1,Add links to FFmpeg and LibSDL2 dependencies
1874,Change links to wikipedia,,Change links to wikipedia,
1875,Add links to FFmpeg and LibSDL2 dependencies,,Add links to FFmpeg and LibSDL2 dependencies,
1876,Process the last video frame,"On H.264 stream EOF, the eof_reached flag is set, but av_read_frame() still provides a frame, so check the flag only afterwards. As a side-effect, it also fixes a memory leak (the very last packet was not unref).",Process the last video frame,"On H.264 stream EOF, the eof_reached flag is set, but av_read_frame() still provides a frame, so check the flag only afterwards. As a side-effect, it also fixes a memory leak (the very last packet was not unref)."
1877,Unref last packet on exit,,Unref last packet on exit,
1878,Clarify adb requirements,"Since scrcpy also supports adb forward, remove the part about adb reverse. Make explicit that adb is included in the prebuilt application for Windows (many users manually download the platform-tools for no reason).",Clarify adb requirements,"Since scrcpy also supports adb forward, remove the part about adb reverse. Make explicit that adb is included in the prebuilt application for Windows (many users manually download the platform-tools for no reason)."
1879,Merge branch 'arich/addShake' into dev (#85),"Add support for CTRL+S to send hardware ""shake"" to device",Merge branch 'arich/addShake' into dev (#85),"Add support for CTRL+S to send hardware ""shake"" to device"
1880,Swap MENU and APP_SWITCH shortcuts,"Ctrl+s was mapped to MENU, while Ctrl+m was mapped to APP_SWITCH. To avoid confusion, swap the shortcuts:  - Ctrl+m like _M_enu  - Ctrl+s like _S_witch",Swap MENU and APP_SWITCH shortcuts,"Ctrl+s was mapped to MENU, while Ctrl+m was mapped to APP_SWITCH. To avoid confusion, swap the shortcuts:  - Ctrl+m like _M_enu  - Ctrl+s like _S_witch"
1881,"Rename ""shake"" to ""menu""","The action sends AKEYCODE_MENU, so just name it ""menu"". See https://github.com/Genymobile/scrcpy/pull/85.","Rename ""shake"" to ""menu""","The action sends AKEYCODE_MENU, so just name it ""menu"". See link."
1882,Describe workaround to get output on Windows,"Since nothing is printed to the console, we need a way to get the output in case of errors. Describe how in the README.",Describe workaround to get output on Windows,"Since nothing is printed to the console, we need a way to get the output in case of errors. Describe how in the README."
1883,"Add support for CTRL+S to send hardware ""shake"" to device w/readme",,"Add support for CTRL+S to send hardware ""shake"" to device w/readme",
1884,Disable custom SDL signal handlers,"Request SDL not to replace the SIGINT and SIGTERM handlers, so that the process is immediately terminated on Ctrl+C. This avoids process hanging on Ctrl+C during network calls on initialization. Some of them accepted a timeout, but it was not used since commit 9b056f5091ad0bc35cd0188cfcb887eb30269fef anymore.",Disable custom SDL signal handlers,"Request SDL not to replace the SIGINT and SIGTERM handlers, so that the process is immediately terminated on Ctrl+C. This avoids process hanging on Ctrl+C during network calls on initialization. Some of them accepted a timeout, but it was not used since commit 9b056f5091ad0bc35cd0188cfcb887eb30269fef anymore."
1885,Remove useless blocks in switch/case,Remove unnecessary additional blocks.,Remove useless blocks in switch/case,Remove unnecessary additional blocks.
1886,Include source root directory,"All headers and sources are in src/. To avoid using relative includes from subdirectories (""../../""), include the source root directory.",Include source root directory,"All headers and sources are in src/. To avoid using relative includes from subdirectories (""../../""), include the source root directory."
1887,Document the step to clone the project,"This is not obvious to everyone, especially non-developers.",Document the step to clone the project,"This is not obvious to everyone, especially non-developers."
1888,Increase the number of connection attempts,"In ""adb forward"" mode, it may take a while before the server socket is listening, so increase the number of connection attempts. See https://github.com/Genymobile/scrcpy/issues/5#issuecomment-373718551.",Increase the number of connection attempts,"In ""adb forward"" mode, it may take a while before the server socket is listening, so increase the number of connection attempts. See link."
1889,Fix win32 build,"The types size_t and ssize_t are defined on Windows (in MSYS2), so there is no need to typedef SIZE_T and SSIZE_T. Exit code is ""unsigned long"" both on Windows 32 and 64 bits. See https://github.com/Genymobile/scrcpy/issues/46#issuecomment-373603596.",Fix win32 build,"The types size_t and ssize_t are defined on Windows (in MSYS2), so there is no need to typedef SIZE_T and SSIZE_T. Exit code is ""unsigned long"" both on Windows 32 and 64 bits. See link."
1890,Remove useless cast,"For consistency with mouse button events handling, directly assign from Sint32 to Uint16.",Remove useless cast,"For consistency with mouse button events handling, directly assign from Sint32 to Uint16."
1891,Fix warning message,"Mouse ""wheel button"" is meaningless :)",Fix warning message,"Mouse ""wheel button"" is meaningless :)"
1892,Fix switch/case code style,"For readability and consistency, indent case statatements, and remove unnecessary additional blocks.",Fix switch/case code style,"For readability and consistency, indent case statatements, and remove unnecessary additional blocks."
1893,Add FAQ section about mouse clicks,"On some devices, mouse clicks do not work by default. Enabling an option is required.",Add FAQ section about mouse clicks,"On some devices, mouse clicks do not work by default. Enabling an option is required."
1894,Add link to the article for v1.1 in README,,Add link to the article for v1.1 in README,
1895,Update FAQ after v1.1 release,Two issues described in the FAQ have been fixed by V1.1. Remove them from the FAQ.,Update FAQ after v1.1 release,Two issues described in the FAQ have been fixed by V1.1. Remove them from the FAQ.
1896,Update links to v1.1 in README,,Update links to v1.1 in README,
1897,Bump version to 1.1,,Bump version to 1.1,
1898,Merge branch 'dev' into release,,Merge branch 'dev' into release,
1899,Remove useless argument,"Do not pass any data to the event watcher, it is unused.",Remove useless argument,"Do not pass any data to the event watcher, it is unused."
1900,Immediately close the server socket on the device,"In ""adb forward"" mode, close the server socket as soon as the client is connected. Even if unlikely to be useful, it allows to run several instances of scrcpy also in ""adb forward"" mode.",Immediately close the server socket on the device,"In ""adb forward"" mode, close the server socket as soon as the client is connected. Even if unlikely to be useful, it allows to run several instances of scrcpy also in ""adb forward"" mode."
1901,Workaround continuous resizing on Windows/MacOS,"On Windows and MacOS, resizing blocks the event loop, so resizing events are not triggered:  - https://bugzilla.libsdl.org/show_bug.cgi?id=2077  - https://stackoverflow.com/a/40693139/1987178 As a workaround, register an event watcher to render the screen from another thread. Since the whole event loop is blocked during resizing, the screen content is not refreshed (on Windows and MacOS) until resizing ends.",Workaround continuous resizing on Windows/MacOS,"On Windows and MacOS, resizing blocks the event loop, so resizing events are not triggered:  - link  - link As a workaround, register an event watcher to render the screen from another thread. Since the whole event loop is blocked during resizing, the screen content is not refreshed (on Windows and MacOS) until resizing ends."
1902,Disable stdout/stderr buffering on Windows,"In MSYS2 on Windows, the output is buffered by default. Disable buffering to print output immediately. Note that in cmd.exe, it still prints nothing.",Disable stdout/stderr buffering on Windows,"In MSYS2 on Windows, the output is buffered by default. Disable buffering to print output immediately. Note that in cmd.exe, it still prints nothing."
1903,Remove black borders on double-click,Resize the window to fit the device screen on click on black borders (same as Ctrl+x). Suggested-by: Guillaume Roche groche@genymobile.com,Remove black borders on double-click,Resize the window to fit the device screen on click on black borders (same as Ctrl+x). Suggested-by: Guillaume Roche groche@genymobile.com
1904,Add links to AUR packages in README,,Add links to AUR packages in README,
1905,Make it work over tcpip,"""adb reverse"" currently does not work over tcpip (i.e. on a device connected by ""adb connect""): https://issuetracker.google.com/issues/37066218 To work around the problem, if the call to ""adb reverse"" fails, then fallback to ""adb forward"", and reverse the client/server roles. Keep the ""adb reverse"" mode as the default because it does not involve connection retries: when using ""adb forward"", the client must try to connect successively until the server listens. Due to the tunnel, every connect() will succeed, so the client must attempt to read() to detect a connection failure. For this purpose, when using the ""adb forward"" mode, the server initially writes a dummy byte, read by the client. Fixes https://github.com/Genymobile/scrcpy/issues/5.",Make it work over tcpip,"""adb reverse"" currently does not work over tcpip (i.e. on a device connected by ""adb connect""): link To work around the problem, if the call to ""adb reverse"" fails, then fallback to ""adb forward"", and reverse the client/server roles. Keep the ""adb reverse"" mode as the default because it does not involve connection retries: when using ""adb forward"", the client must try to connect successively until the server listens. Due to the tunnel, every connect() will succeed, so the client must attempt to read() to detect a connection failure. For this purpose, when using the ""adb forward"" mode, the server initially writes a dummy byte, read by the client. Fixes link."
1906,Store serial in server instance,"The serial is needed for many server actions, but this is an implementation detail, so the caller should not have to provide it on every call. Instead, store the serial in the server instance on server_start(). This paves the way to implement the ""adb forward"" fallback properly.",Store serial in server instance,"The serial is needed for many server actions, but this is an implementation detail, so the caller should not have to provide it on every call. Instead, store the serial in the server instance on server_start(). This paves the way to implement the ""adb forward"" fallback properly."
1907,Always use the best render scale quality available,Because why not. See https://wiki.libsdl.org/SDL_HINT_RENDER_SCALE_QUALITY.,Always use the best render scale quality available,Because why not. See link.
1908,Reverse horizontal scrolling behavior,The SDL mouse wheel event seems inconsistent between horizontal and vertical scrolling.  Movements to the left generate negative x values and to the right generate positive x values. Movements down (scroll backward) generate negative y values and up (scroll forward) generate positive y values.  https://wiki.libsdl.org/SDL_MouseWheelEvent#Remarks Reverse the horizontal. Fixes https://github.com/Genymobile/scrcpy/issues/49.,Reverse horizontal scrolling behavior,The SDL mouse wheel event seems inconsistent between horizontal and vertical scrolling. Movements to the left generate negative x values and to the right generate positive x values. Movements down (scroll backward) generate negative y values and up (scroll forward) generate positive y values. link Reverse the horizontal. Fixes link.
1909,Merge branch 'fedora_install' (pull request #29),Document how to install on Fedora,Merge branch 'fedora_install' (pull request #29),Document how to install on Fedora
1910,Use one subsection by distribution in README,"Now that instructions are given for both Debian/Ubuntu and Fedora, use subsections.",Use one subsection by distribution in README,"Now that instructions are given for both Debian/Ubuntu and Fedora, use subsections."
1911,Document how to install on Fedora,,Document how to install on Fedora,
1912,Improve dependencies in README,"Document server and client dependencies separately, to avoid unneeded packages installation when building using the prebuilt server. Also remove ""zip"", since it's only used for building a portable version (which is not documented in README).",Improve dependencies in README,"Document server and client dependencies separately, to avoid unneeded packages installation when building using the prebuilt server. Also remove ""zip"", since it's only used for building a portable version (which is not documented in README)."
1913,Fix mouse clicks on LG devices,Use default values (0) for some fields of PointerCoords so that mouse clicks work correctly on LG devices. Fixes https://github.com/Genymobile/scrcpy/issues/18.,Fix mouse clicks on LG devices,Use default values (0) for some fields of PointerCoords so that mouse clicks work correctly on LG devices. Fixes link.
1914,Support screens with dimensions not divisible by 8,"The codec only supports dimensions which are multiple of 8. Thus, when --max-size is specified, the value is always rounded down to the nearest multiple of 8. However, it was wrongly assumed that the physical size is always a multiple of 8. To support such devices, also round down the physical screen dimensions. Fixes https://github.com/Genymobile/scrcpy/issues/39.",Support screens with dimensions not divisible by 8,"The codec only supports dimensions which are multiple of 8. Thus, when --max-size is specified, the value is always rounded down to the nearest multiple of 8. However, it was wrongly assumed that the physical size is always a multiple of 8. To support such devices, also round down the physical screen dimensions. Fixes link."
1915,Add a FAQ for common issues,,Add a FAQ for common issues,
1916,Merge branch 'sdushantha' (pull request #28),Improve README syntax highlighting.,Merge branch 'sdushantha' (pull request #28),Improve README syntax highlighting.
1917,Add empty lines around code blocks,And fix spaces (do not randomly use non-breaking spaces for indentation).,Add empty lines around code blocks,And fix spaces (do not randomly use non-breaking spaces for indentation).
1918,"removed ""$"" and changed Mac OS ---> MacOS",,"removed ""$"" and changed Mac OS ---> MacOS",
1919,"added ""$"" in front of terminal commands",,"added ""$"" in front of terminal commands",
1920,Map middle-click to HOME,Middle-click is useless in practice. Use it for HOME.,Map middle-click to HOME,Middle-click is useless in practice. Use it for HOME.
1921,Map right-click to BACK if screen is on,"Right-click was used to turn the screen on. It did nothing when the screen was already on. Instead, in that case, press BACK (like Vysor). Suggested by: https://www.reddit.com/r/Android/comments/834zmr/introducing_scrcpy_an_app_to_display_and_control/dvfueft/",Map right-click to BACK if screen is on,"Right-click was used to turn the screen on. It did nothing when the screen was already on. Instead, in that case, press BACK (like Vysor). Suggested by: link/"
1922,Fix text input event segfault,"The text input control_event was initially designed for mapping SDL_TextInputEvent, limited to 32 characters. For simplicity, the copy/paste feature was implemented using the same control_event: it just sends the text to paste. However, the pasted text might have a length breaking some assumptions:  - on the client, the event max-size was smaller than the text    max-length,  - on the server, the raw buffer storing the events was smaller than the    max event size. Fix these inconsistencies, and encode the length on 2 bytes, to accept more than 256 characters. Fixes https://github.com/Genymobile/scrcpy/issues/10.",Fix text input event segfault,"The text input control_event was initially designed for mapping SDL_TextInputEvent, limited to 32 characters. For simplicity, the copy/paste feature was implemented using the same control_event: it just sends the text to paste. However, the pasted text might have a length breaking some assumptions:  - on the client, the event max-size was smaller than the text    max-length,  - on the server, the raw buffer storing the events was smaller than the    max event size. Fix these inconsistencies, and encode the length on 2 bytes, to accept more than 256 characters. Fixes link."
1923,Unref the packet on error,Do not leak the packet data on error.,Unref the packet on error,Do not leak the packet data on error.
1924,Do not leak the packet data,Oops! The content of the packets were never freed.,Do not leak the packet data,Oops! The content of the packets were never freed.
1925,Document ./run script usage,Indicate how to run the app from the build directory in README. It's convenient during development.,Document ./run script usage,Indicate how to run the app from the build directory in README. It's convenient during development.
1926,Add link to blog article in README,,Add link to blog article in README,
1927,Update release checksums in README,,Update release checksums in README,
1928,Add developer documentation,And update README.,Add developer documentation,And update README.
1929,Upgrade version to 1.0,,Upgrade version to 1.0,
1930,Implement clipboard paste,"Paste computer clipboard to the device on Ctrl+v. The other direction (pasting the device clipboard to the computer) is not implemented. It would require a communication channel from the device to the computer, other than the socket used by the video stream.",Implement clipboard paste,"Paste computer clipboard to the device on Ctrl+v. The other direction (pasting the device clipboard to the computer) is not implemented. It would require a communication channel from the device to the computer, other than the socket used by the video stream."
1931,Initialize struct field by field,"Initializing with braces initializes the other fields to 0, which is not necessary.",Initialize struct field by field,"Initializing with braces initializes the other fields to 0, which is not necessary."
1932,Expose High DPI support configuration flag,"The High DPI support is enabled by default, so that the renderer use the full definition of High DPI screens. However, there are still mouse coordinates problems on some MacOS having High DPI support (but not all), so expose a way to disable it.",Expose High DPI support configuration flag,"The High DPI support is enabled by default, so that the renderer use the full definition of High DPI screens. However, there are still mouse coordinates problems on some MacOS having High DPI support (but not all), so expose a way to disable it."
1933,Do not fail on EAGAIN,"A call to avcodec_receive_frame() may return AVERROR(EAGAIN) if more input is required. This is not an error, do not fail.",Do not fail on EAGAIN,"A call to avcodec_receive_frame() may return AVERROR(EAGAIN) if more input is required. This is not an error, do not fail."
1934,Provide a better URL to document key decomposition,Directly link to the relevant subsection.,Provide a better URL to document key decomposition,Directly link to the relevant subsection.
1935,Avoid useless variables initialization,Initialize variables only when necessary.,Avoid useless variables initialization,Initialize variables only when necessary.
1936,Move the new avcodec implementation before the old,The API to decode the video frames is different depending on the libavcodec version. Move the new API usage to the #if-block.,Move the new avcodec implementation before the old,The API to decode the video frames is different depending on the libavcodec version. Move the new API usage to the #if-block.
1937,Do not use return code for thread run function,"The decoder sometimes returned a non-zero value on error, but not on every path. Since we never use the value, always return 0 at the end (like in the controller).",Do not use return code for thread run function,"The decoder sometimes returned a non-zero value on error, but not on every path. Since we never use the value, always return 0 at the end (like in the controller)."
1938,"Revert ""Enable high dpi support""",Just enabling this flag breaks mouse location values. This reverts commit 38b56f552e0667db60c7022d4a2713da8fb4e338.,"Revert ""Enable high dpi support""",Just enabling this flag breaks mouse location values. This reverts commit 38b56f552e0667db60c7022d4a2713da8fb4e338.
1939,Shutdown sockets before closing,The server socket does not release the port it was listening for if we just close it: we must also shutdown it.,Shutdown sockets before closing,The server socket does not release the port it was listening for if we just close it: we must also shutdown it.
1940,Fix scroll wheel mouse position,"SDL_MouseWheelEvent does not provide the mouse location, so we used SDL_GetMouseState() to retrieve it. Unfortunately, SDL_GetMouseState() returns a position expressed in the window coordinate system while the position filled in SDL events are expressed in the renderer coordinate system. As a consequence, the scroll was not applied at the right position on the device. Therefore, convert the coordinate system. See https://stackoverflow.com/questions/49111054/how-to-get-mouse-position-on-mouse-wheel-event.",Fix scroll wheel mouse position,"SDL_MouseWheelEvent does not provide the mouse location, so we used SDL_GetMouseState() to retrieve it. Unfortunately, SDL_GetMouseState() returns a position expressed in the window coordinate system while the position filled in SDL events are expressed in the renderer coordinate system. As a consequence, the scroll was not applied at the right position on the device. Therefore, convert the coordinate system. See link."
1941,Fix comment typo,"Replace ""at network level"" by ""at the network level"".",Fix comment typo,"Replace ""at network level"" by ""at the network level""."
1942,Double the default bitrate,"Set the default video bitrate to 8Mbps. This greatly increase quality on fast motion, without negative side effects.",Double the default bitrate,"Set the default video bitrate to 8Mbps. This greatly increase quality on fast motion, without negative side effects."
1943,Rename rotation detection method name,The old name checkRotationChanged() did not suggest that the flag was reset.,Rename rotation detection method name,The old name checkRotationChanged() did not suggest that the flag was reset.
1944,Enable high dpi support,"Use high DPI if available. Note that on Mac OS X, setting this flag is not sufficient:  On Apple's OS X you must set the NSHighResolutionCapable Info.plist property to YES, otherwise you will not receive a High DPI OpenGL display.  https://wiki.libsdl.org/SDL_CreateWindow#flags",Enable high dpi support,"Use high DPI if available. Note that on Mac OS X, setting this flag is not sufficient: On Apple's OS X you must set the NSHighResolutionCapable Info.plist property to YES, otherwise you will not receive a High DPI OpenGL display. link"
1945,Update README,"Explain how to build, install and run the application.",Update README,"Explain how to build, install and run the application."
1946,Add Apache 2 LICENSE file,,Add Apache 2 LICENSE file,
1947,Terminate the server on stop,"On user request to quit, two kinds of blocking calls must be interrupted on the server:  1. the reads from and writes to the socket;  2. the call to MediaCodec.dequeueOutputBuffer(). The former case was handled by calling shutdown() on the socket from the client, but the latter was not managed. There is no easy way to wake this call properly, so just terminate the process from the client (i.e. send SIGTERM on Linux) instead.",Terminate the server on stop,"On user request to quit, two kinds of blocking calls must be interrupted on the server:  1. the reads from and writes to the socket;  2. the call to MediaCodec.dequeueOutputBuffer(). The former case was handled by calling shutdown() on the socket from the client, but the latter was not managed. There is no easy way to wake this call properly, so just terminate the process from the client (i.e. send SIGTERM on Linux) instead."
1948,Initialize eof flag from BufferInfo,"Stop encoding if the codec signaled the end of stream. The eof flag was read, but never written.",Initialize eof flag from BufferInfo,"Stop encoding if the codec signaled the end of stream. The eof flag was read, but never written."
1949,Clean up the server from temporary folder,"The server is copied to /data/local/tmp/scrcpy-server.jar and executed on the device. As soon as we are connected, we can unlink (rm) it from /data/local/tmp, to keep the device clean.",Clean up the server from temporary folder,"The server is copied to /data/local/tmp/scrcpy-server.jar and executed on the device. As soon as we are connected, we can unlink (rm) it from /data/local/tmp, to keep the device clean."
1950,Clean up useless const-casts,"The function adb_execute() now expects a ""const char const "" parameter for the adb command, so there is no need to cast.",Clean up useless const-casts,"The function adb_execute() now expects a ""const char const "" parameter for the adb command, so there is no need to cast."
1951,Rename ScrCpyServer to Server,"The Server class is in package scrcpy, there is no need to repeat the name in the classname.",Rename ScrCpyServer to Server,"The Server class is in package scrcpy, there is no need to repeat the name in the classname."
1952,Add missing .PHONY in portable Makefile,"The recipe ""build-portable"" is also the name of the generated directory. Add this name to the .PHONY list.",Add missing .PHONY in portable Makefile,"The recipe ""build-portable"" is also the name of the generated directory. Add this name to the .PHONY list."
1953,Rename SCRCPY_SERVER_JAR to SCRCPY_SERVER_PATH,"The server is currently a JAR, but it may ba an APK or a DEX, so the variable name should not contain the type. Rename the environment variable, the Meson options and the C definitions.",Rename SCRCPY_SERVER_JAR to SCRCPY_SERVER_PATH,"The server is currently a JAR, but it may ba an APK or a DEX, so the variable name should not contain the type. Rename the environment variable, the Meson options and the C definitions."
1954,Reuse server address,"Set SO_REUSEADDR flag to server socket, so that bind() does not fail if we restart scrcpy immediately after we closed the previous one.",Reuse server address,"Set SO_REUSEADDR flag to server socket, so that bind() does not fail if we restart scrcpy immediately after we closed the previous one."
1955,Log socket errors,"Do not silently ignore close() and shutdown() errors, and use perror() to get the errno.",Log socket errors,"Do not silently ignore close() and shutdown() errors, and use perror() to get the errno."
1956,Terminate event controller thread on EOF,"No exception was thrown on EOF, so the event controller did not terminate. This leaded to a further InvocationTargetException. Instead, terminate the event controller on EOF, so that the process terminates properly.",Terminate event controller thread on EOF,"No exception was thrown on EOF, so the event controller did not terminate. This leaded to a further InvocationTargetException. Instead, terminate the event controller on EOF, so that the process terminates properly."
1957,Terminate the device process gracefully,"Call shutdown() on the device socket to make the device process finish its execution quickly and gracefully, without killing it.",Terminate the device process gracefully,"Call shutdown() on the device socket to make the device process finish its execution quickly and gracefully, without killing it."
1958,Send and recv all data when necessary,"Expose net_recv_all() and net_send_all(), equivalent of net_recv() and net_send(), but that waits/retries until the requested length has been transferred. Use these new functions where it was (wrongly) assumed that the requested length had been transferred.",Send and recv all data when necessary,"Expose net_recv_all() and net_send_all(), equivalent of net_recv() and net_send(), but that waits/retries until the requested length has been transferred. Use these new functions where it was (wrongly) assumed that the requested length had been transferred."
1959,Avoid division by 0,"If the frame_size width or height is 0, just return the current size to avoid calculations involving divison by 0.",Avoid division by 0,"If the frame_size width or height is 0, just return the current size to avoid calculations involving divison by 0."
1960,Cleanup old code comment,,Cleanup old code comment,
1961,Detect failure of device information read,"If the received data is smaller than the device information size, then something is wrong.",Detect failure of device information read,"If the received data is smaller than the device information size, then something is wrong."
1962,Replace SDL_net by custom implementation,"SDL_net is not very suitable for scrcpy. For example, SDLNet_TCP_Accept() is non-blocking, so we have to wrap it by calling many SDL_Net-specific functions to make it blocking. But above all, SDLNet_TCP_Open() is a server socket only when no IP is provided; otherwise, it's a client socket. Therefore, it is not possible to create a server socket bound to localhost, so it accepts connections from anywhere. This is a problem for scrcpy, because on start, the application listens for nearly 1 second until it accepts the first connection, supposedly from the device. If someone on the local network manages to connect to the server socket first, then they can stream arbitrary H.264 video. This may be troublesome, for example during a public presentation ;-) Provide our own simplified API (net.h) instead, implemented for the different platforms.",Replace SDL_net by custom implementation,"SDL_net is not very suitable for scrcpy. For example, SDLNet_TCP_Accept() is non-blocking, so we have to wrap it by calling many SDL_Net-specific functions to make it blocking. But above all, SDLNet_TCP_Open() is a server socket only when no IP is provided; otherwise, it's a client socket. Therefore, it is not possible to create a server socket bound to localhost, so it accepts connections from anywhere. This is a problem for scrcpy, because on start, the application listens for nearly 1 second until it accepts the first connection, supposedly from the device. If someone on the local network manages to connect to the server socket first, then they can stream arbitrary H.264 video. This may be troublesome, for example during a public presentation ;-) Provide our own simplified API (net.h) instead, implemented for the different platforms."
1963,Improve decoder stopped event,"The syntax was correct, but less readable, and it unnecessarily zeroed the fields other than ""type"". Create the event properly, from a separate method.",Improve decoder stopped event,"The syntax was correct, but less readable, and it unnecessarily zeroed the fields other than ""type"". Create the event properly, from a separate method."
1964,Prevent new window opening with CreateProcess(),"Executing commands (like ""adb push"") created a new terminal window on Windows. Avoid it.",Prevent new window opening with CreateProcess(),"Executing commands (like ""adb push"") created a new terminal window on Windows. Avoid it."
1965,Reword Ctrl+x description,"Pressing Ctrl+x resizes the window to remove black borders, ""optimal"" is not well-defined.",Reword Ctrl+x description,"Pressing Ctrl+x resizes the window to remove black borders, ""optimal"" is not well-defined."
1966,Remove useless screen render on initialization,"screen_render() should not be called on initialization:  1. it is useless, since the window is hidden until the first frame;  2. it writes an empty texture (probably green) to the renderer.",Remove useless screen render on initialization,"screen_render() should not be called on initialization:  1. it is useless, since the window is hidden until the first frame;  2. it writes an empty texture (probably green) to the renderer."
1967,Add Ctrl+i shortcut to enable/disable FPS counter,"Disable FPS counter on start, and use Ctrl+i to enable/disable it.",Add Ctrl+i shortcut to enable/disable FPS counter,"Disable FPS counter on start, and use Ctrl+i to enable/disable it."
1968,Refactor screencontrol to inputmanager,"The ""screen control"" handled user input, which happened to be only used to control the screen. The controller and screen were passed to every function. Instead, group them in a struct input_manager. The purpose is to add a new shortcut to enable/disable FPS counter. This feature is not related to ""screen control"", and will require access to the ""frames"" instance.",Refactor screencontrol to inputmanager,"The ""screen control"" handled user input, which happened to be only used to control the screen. The controller and screen were passed to every function. Instead, group them in a struct input_manager. The purpose is to add a new shortcut to enable/disable FPS counter. This feature is not related to ""screen control"", and will require access to the ""frames"" instance."
1969,Add description for meson options,The descriptions are displayed in the result of: mesonconf builddir,Add description for meson options,The descriptions are displayed in the result of: mesonconf builddir
1970,Expose skip_frames as a build option,It can be initially configured by: meson builddir -Dskip_frames=false  Or on an existing builddir by: mesonconf builddir -Dskip_frames=false,Expose skip_frames as a build option,It can be initially configured by: meson builddir -Dskip_frames=false Or on an existing builddir by: mesonconf builddir -Dskip_frames=false
1971,Add FPS counter,"Remove frame counter from scrcpy.c and add a new FPS counter, logging as INFO the measured frame rate every second (on new frame).",Add FPS counter,"Remove frame counter from scrcpy.c and add a new FPS counter, logging as INFO the measured frame rate every second (on new frame)."
1972,Do not print usage on command error,"On error, a message is printed. If we print usage afterwards, it's easy to miss it.",Do not print usage on command error,"On error, a message is printed. If we print usage afterwards, it's easy to miss it."
1973,Expose device serial as an optional argument,"The device serial was provided as a positional argument: scrcpy 0123456789abcdef  Instead, expose it as an optional argument, -s or --serial: scrcpy -s 0123456789abcdef  This avoids inconsistency between platforms when the positional argument is passed before the options (which is undefined).",Expose device serial as an optional argument,"The device serial was provided as a positional argument: scrcpy 0123456789abcdef Instead, expose it as an optional argument, -s or --serial: scrcpy -s 0123456789abcdef This avoids inconsistency between platforms when the positional argument is passed before the options (which is undefined)."
1974,Extract argument parsing to specific functions,"To avoid a big switch/case, implement the argument parsing logic in separate static functions.",Extract argument parsing to specific functions,"To avoid a big switch/case, implement the argument parsing logic in separate static functions."
1975,Use SDL_bool return to indicate success,"For clarity and consistency across the application, return SDL_TRUE (instead of 0) on success and SDL_FALSE on failure (instead of non-zero).",Use SDL_bool return to indicate success,"For clarity and consistency across the application, return SDL_TRUE (instead of 0) on success and SDL_FALSE on failure (instead of non-zero)."
1976,Sort parameters by letter,"For readability, sort the command-line arguments parsing by letter.",Sort parameters by letter,"For readability, sort the command-line arguments parsing by letter."
1977,Add run script,"Add a script to simplify the execution of scrcpy generated in a specific build directory. To run scrcpy generated in builddir, with a video size of 1024: ./run builddir -m 1024",Add run script,"Add a script to simplify the execution of scrcpy generated in a specific build directory. To run scrcpy generated in builddir, with a video size of 1024: ./run builddir -m 1024"
1978,Accept prebuilt server,"Expose a 'prebuilt_server' option to pass the path of the prebuilt binary, so that the build does not require Android SDK. Usage: meson builddir -Dprebuilt_server=/tmp/my_prebuilt_server.jar",Accept prebuilt server,"Expose a 'prebuilt_server' option to pass the path of the prebuilt binary, so that the build does not require Android SDK. Usage: meson builddir -Dprebuilt_server=/tmp/my_prebuilt_server.jar"
1979,Require Meson 0.37,"Older versions of Meson are too limited, and it's simple to install a newer version (""pip3 install meson"").",Require Meson 0.37,"Older versions of Meson are too limited, and it's simple to install a newer version (""pip3 install meson"")."
1980,Always invoke gradle except as root,"The custom target used to invoke Gradle from Meson should always be built, otherwise, the server would not be rebuilt on source changes. However, when enabling ""build_always"", gradle is invoked as root on ""sudo ninja install"" after ""ninja"", so it downloads the whole Gradle world into /root/.gradle. To avoid the problem, just do not call gradle if the effective user id is 0.",Always invoke gradle except as root,"The custom target used to invoke Gradle from Meson should always be built, otherwise, the server would not be rebuilt on source changes. However, when enabling ""build_always"", gradle is invoked as root on ""sudo ninja install"" after ""ninja"", so it downloads the whole Gradle world into /root/.gradle. To avoid the problem, just do not call gradle if the effective user id is 0."
1981,Replace meson subprojects by subdir,"Since Meson 0.44, subproject_dir may not be '.' anymore. This implies we must move app/ and server/ to a subprojects/ directory, which requires to also change some gradle files. Instead, just use subdir(), with options to disable building of the app or the server.",Replace meson subprojects by subdir,"Since Meson 0.44, subproject_dir may not be '.' anymore. This implies we must move app/ and server/ to a subprojects/ directory, which requires to also change some gradle files. Instead, just use subdir(), with options to disable building of the app or the server."
1982,Refactor build system,"The client was built with Meson, the server with Gradle, and were run by a Makefile. Add a Meson script for the server (which delegates to Gradle), and a parent script to build and install both the client and the server to the system, typically with: meson --buildtype release build cd build ninja sudo ninja install  In addition, use a separate Makefile to build a ""portable"" version of the application (where the client expects the server to be in the current directory). Typically: make release-portable cd dist/scrcpy ./scrcpy  This is especially useful for Windows builds, which are not ""installed"".",Refactor build system,"The client was built with Meson, the server with Gradle, and were run by a Makefile. Add a Meson script for the server (which delegates to Gradle), and a parent script to build and install both the client and the server to the system, typically with: meson --buildtype release build cd build ninja sudo ninja install In addition, use a separate Makefile to build a ""portable"" version of the application (where the client expects the server to be in the current directory). Typically: make release-portable cd dist/scrcpy ./scrcpy This is especially useful for Windows builds, which are not ""installed""."
1983,Provide config.h.in for old meson versions,"The current meson version is able to generate a config.h from a configuration data object without any template. However, older versions of meson require a template, so provide it for compatibility.",Provide config.h.in for old meson versions,"The current meson version is able to generate a config.h from a configuration data object without any template. However, older versions of meson require a template, so provide it for compatibility."
1984,Define macros wrappers for logs,"Use macros to wrap SDL_Log* functions with the ""application"" category.",Define macros wrappers for logs,"Use macros to wrap SDL_Log* functions with the ""application"" category."
1985,Do not use too recent set_quoted(),Old versions of meson do not support set_quoted(). Replace the call by the old-fashioned manual quotation.,Do not use too recent set_quoted(),Old versions of meson do not support set_quoted(). Replace the call by the old-fashioned manual quotation.
1986,Enable debug logs only for debug builds on server,"Print the logs only if their level is not under the threshold, which is defined to INFO in release mode and DEBUG in debug mode.",Enable debug logs only for debug builds on server,"Print the logs only if their level is not under the threshold, which is defined to INFO in release mode and DEBUG in debug mode."
1987,"Fix ""terminate process"" on Windows",CloseHandle() does not terminate the process. TerminateProcess() does.,"Fix ""terminate process"" on Windows",CloseHandle() does not terminate the process. TerminateProcess() does.
1988,Log with category APPLICATION,"All our logs should use APPLICATION category. The logs for other categories are not printed by default under the ""critical"" level.",Log with category APPLICATION,"All our logs should use APPLICATION category. The logs for other categories are not printed by default under the ""critical"" level."
1989,Disable sanitizer on debug builds,"On our Windows machine, the mingw ld.exe does not support sanitizers. Exclude them from the default debug build.",Disable sanitizer on debug builds,"On our Windows machine, the mingw ld.exe does not support sanitizers. Exclude them from the default debug build."
1990,Enable debug logs only for debug builds,"In release mode, use the default log priorities.",Enable debug logs only for debug builds,"In release mode, use the default log priorities."
1991,Enable link-time optimization for release,Because why not.,Enable link-time optimization for release,Because why not.
1992,Decompose accented characters,"Characters like '' or '' are not resolved by getEvents(). For example, getEvents("""") returns null. However, it is possible to decompose them. For example, getEvents(""\u0301e"") returns the events generating """". Thank you Philippe! ;)",Decompose accented characters,"Characters like '' or '' are not resolved by getEvents(). For example, getEvents("""") returns null. However, it is possible to decompose them. For example, getEvents(""\u0301e"") returns the events generating """". Thank you Philippe! ;)"
1993,Properly clean up on exit,"The SDL clean up does not crash anymore on exit, probably since the memory corruption caused by calling SDLNet_TCP_Close() too early has been resolved.",Properly clean up on exit,"The SDL clean up does not crash anymore on exit, probably since the memory corruption caused by calling SDLNet_TCP_Close() too early has been resolved."
1994,Timeout the server socket connection,"Wait no more than 2 seconds for accepting the connection from the device, since it blocks the event loop, preventing to react to SIGTERM (Ctrl+C).",Timeout the server socket connection,"Wait no more than 2 seconds for accepting the connection from the device, since it blocks the event loop, preventing to react to SIGTERM (Ctrl+C)."
1995,Improve startup time,"On startup, the client has to:  1. listen on a port  2. push and start the server to the device  3. wait for the server to connect (accept)  4. read device name and size  5. initialize SDL  6. initialize the window and renderer  7. show the window From the execution of the app_process command to start the server on the device, to the execution of the java main method, it takes ~800ms. As a consequence, step 3 also takes ~800ms on the client. Once complete, the client initializes SDL, which takes ~500ms. These two expensive actions are executed sequentially:                  HOST              DEVICE  listen on port        |                  | push/start the server |----------------->|| app_process loads the jar accept the connection .   ^              ||                       .   |              ||                       .   | WASTE        ||                       .   |  OF          ||                       .   | TIME         ||                       .   |              ||                       .   |              ||                       .   v              X execution of our java main connection accepted   |<-----------------| connect to the host init SDL             ||                  |                      || ,----------------| send frames                      || |,---------------|                      || ||,--------------|                      || |||,-------------|                      || ||||,------------| init window/renderer  | |||||,-----------| display frames        |<++++++-----------| (many frames skipped) The rationale for step 3 occuring before step 5 is that initializing SDL replaces the SIGTERM handler to receive the event in the event loop, so pressing Ctrl+C during step 5 would not work (since it blocks the event loop). But this is not so important; let's parallelize the SDL initialization with the app_process execution (we'll just add a timeout to the connection):                  HOST              DEVICE  listen on port        |                  | push/start the server |----------------->||app_process loads the jar init SDL             ||                  ||                      ||                  ||                      ||                  ||                      ||                  ||                      ||                  ||                      ||                  || accept the connection .                  ||                       .                  X execution of our java main connection accepted   |<-----------------| connect to the host init window/renderer  |                  | display frames        |<-----------------| send frames                       |<-----------------| In addition, show the window only once the first frame is available to avoid flickering (opening a black window for 100~200ms). Note: the window and renderer are initialized after the connection is accepted because they use the device information received from the device.",Improve startup time,"On startup, the client has to:  1. listen on a port  2. push and start the server to the device  3. wait for the server to connect (accept)  4. read device name and size  5. initialize SDL  6. initialize the window and renderer  7. show the window From the execution of the app_process command to start the server on the device, to the execution of the java main method, it takes ~800ms. As a consequence, step 3 also takes ~800ms on the client. Once complete, the client initializes SDL, which takes ~500ms. These two expensive actions are executed sequentially:                  HOST              DEVICE listen on port        |                  | push/start the server |----------------->|| app_process loads the jar accept the connection .   ^              ||                       .   |              ||                       .   | WASTE        ||                       .   |  OF          ||                       .   | TIME         ||                       .   |              ||                       .   |              ||                       .   v              X execution of our java main connection accepted   |<-----------------| connect to the host init SDL             ||                  |                      || ,----------------| send frames                      || |,---------------|                      || ||,--------------|                      || |||,-------------|                      || ||||,------------| init window/renderer  | |||||,-----------| display frames        |<++++++-----------| (many frames skipped) The rationale for step 3 occuring before step 5 is that initializing SDL replaces the SIGTERM handler to receive the event in the event loop, so pressing Ctrl+C during step 5 would not work (since it blocks the event loop). But this is not so important; let's parallelize the SDL initialization with the app_process execution (we'll just add a timeout to the connection):                  HOST              DEVICE listen on port        |                  | push/start the server |----------------->||app_process loads the jar init SDL             ||                  ||                      ||                  ||                      ||                  ||                      ||                  ||                      ||                  ||                      ||                  || accept the connection .                  ||                       .                  X execution of our java main connection accepted   |<-----------------| connect to the host init window/renderer  |                  | display frames        |<-----------------| send frames                       |<-----------------| In addition, show the window only once the first frame is available to avoid flickering (opening a black window for 100~200ms). Note: the window and renderer are initialized after the connection is accepted because they use the device information received from the device."
1996,Turn screen on in control(),Turning the screen on is semantically associated to control(): only creating the EventController object should not turn the screen on.,Turn screen on in control(),Turning the screen on is semantically associated to control(): only creating the EventController object should not turn the screen on.
1997,Provide decoder_init(),Expose an initializer so that the caller does not have to guess what fields must be initialized.,Provide decoder_init(),Expose an initializer so that the caller does not have to guess what fields must be initialized.
1998,Do not release TCP sockets while still in use,"SDLNet_TCP_Close() not only closes, but also release the resources. Therefore, we must not close the socket if another thread attempts to read it. For that purpose, move socket closing from server_stop() to server_destroy().",Do not release TCP sockets while still in use,"SDLNet_TCP_Close() not only closes, but also release the resources. Therefore, we must not close the socket if another thread attempts to read it. For that purpose, move socket closing from server_stop() to server_destroy()."
1999,Enable sanitizer in debug builds,"""make build-debug"" will build with ASAN and USAN enabled.",Enable sanitizer in debug builds,"""make build-debug"" will build with ASAN and USAN enabled."
2000,Move frame updating to screen.c,"Replace screen_update() by a higher-level screen_update_frame() handling the whole frame updating, so that scrcpy.c just call it without managing implementation details.",Move frame updating to screen.c,"Replace screen_update() by a higher-level screen_update_frame() handling the whole frame updating, so that scrcpy.c just call it without managing implementation details."
2001,Kill the server immediately on close,"Do not wait 100ms anymore to let the server print any exception: we justly want to ignore them. Moreover, there is no nanosleep() on Windows, so this solve another problem.",Kill the server immediately on close,"Do not wait 100ms anymore to let the server print any exception: we justly want to ignore them. Moreover, there is no nanosleep() on Windows, so this solve another problem."
2002,Avoid server stacktraces on close,"On close, the socket is closed by the client, and the server process is killed. This leads to (expected) exceptions, that should not be printed.",Avoid server stacktraces on close,"On close, the socket is closed by the client, and the server process is killed. This leads to (expected) exceptions, that should not be printed."
2003,Do not try to decode video when EOF is reached,"When the video stream socket is closed and read_packey() returns -1, av_read_frame() still returns 0. To detect EOF, check the flag eof_reached in the AVIOContext. This avoids garbage errors on closing.",Do not try to decode video when EOF is reached,"When the video stream socket is closed and read_packey() returns -1, av_read_frame() still returns 0. To detect EOF, check the flag eof_reached in the AVIOContext. This avoids garbage errors on closing."
2004,"Send ""screen on"" command only on mouse down","Avoid to send the command twice, once on mouse down, once on mouse up.","Send ""screen on"" command only on mouse down","Avoid to send the command twice, once on mouse down, once on mouse up."
2005,Fix deadlock on exit if SKIP_FRAMES disabled,"On exit, the renderer will not consume frames anymore, so signal the condition variable to wake up the decoder.",Fix deadlock on exit if SKIP_FRAMES disabled,"On exit, the renderer will not consume frames anymore, so signal the condition variable to wake up the decoder."
2006,Move frame swapping logic to frame.c,Expose frames_offer_decoded_frame() and frames_consume_rendered_frame() so that callers are not exposed to frame swapping (between the decoding and rendering frames) details.,Move frame swapping logic to frame.c,Expose frames_offer_decoded_frame() and frames_consume_rendered_frame() so that callers are not exposed to frame swapping (between the decoding and rendering frames) details.
2007,Unlock mutex on screen update failure,The mutex was not unlocked on all code paths.,Unlock mutex on screen update failure,The mutex was not unlocked on all code paths.
2008,Move control-related code to screencontrol.c,"Move the code handling user input from scrcpy.c to a separate file, screencontrol.c.",Move control-related code to screencontrol.c,"Move the code handling user input from scrcpy.c to a separate file, screencontrol.c."
2009,"Remove the ""adb reverse"" tunnel immediately","As soon as we accepted a connection, we can remove the ""adb reverse"" tunnel.","Remove the ""adb reverse"" tunnel immediately","As soon as we accepted a connection, we can remove the ""adb reverse"" tunnel."
2010,Move device-related code to device.c,"Move the code to read the initial device info from scrcpy.c to a separate file, device.c.",Move device-related code to device.c,"Move the code to read the initial device info from scrcpy.c to a separate file, device.c."
2011,Move server-related code to server.c,"The file server.c already existed, but exposed a low-level API. Make it higher-level, so that scrcpy.c does not handle server details directly.",Move server-related code to server.c,"The file server.c already existed, but exposed a low-level API. Make it higher-level, so that scrcpy.c does not handle server details directly."
2012,Move screen-related code to screen.c,"The file scrcpy.c contains too many different things in addition to the main logic, so move the screen code to a separate file, screen.c.",Move screen-related code to screen.c,"The file scrcpy.c contains too many different things in addition to the main logic, so move the screen code to a separate file, screen.c."
2013,Add missing include guards,"In practice, these headers are included only once, but it's a good practice to always use include guards.",Add missing include guards,"In practice, these headers are included only once, but it's a good practice to always use include guards."
2014,Rename control to controller,"The struct decoder is defined in decoder.h. For naming consistency, define the struct controller in controller.h.",Rename control to controller,"The struct decoder is defined in decoder.h. For naming consistency, define the struct controller in controller.h."
2015,Add missing static,"Some functions in scrcpy.c are not used outside the file, so declare them static.",Add missing static,"Some functions in scrcpy.c are not used outside the file, so declare them static."
2016,Apply Genymobile rules for Android projects,Apply Genymobile checkstyle and gradle build files organization.,Apply Genymobile rules for Android projects,Apply Genymobile checkstyle and gradle build files organization.
2017,Fix horizontal scrolling constant,Use AXIS_HSCROLL (available since API 12) instead of AXIS_SCROLL (since API 26).,Fix horizontal scrolling constant,Use AXIS_HSCROLL (available since API 12) instead of AXIS_SCROLL (since API 26).
2018,Simplify EventController,"In handleEvent(), connection.receiveControlEvent() may never return null: either it returns a valid ControlEvent, either it throws an Exception. Therefore, there is no need to propagate a flag to indicate whether it returned a valid ControlEvent.",Simplify EventController,"In handleEvent(), connection.receiveControlEvent() may never return null: either it returns a valid ControlEvent, either it throws an Exception. Therefore, there is no need to propagate a flag to indicate whether it returned a valid ControlEvent."
2019,Extract control event parsing to separate methods,Use one parse method per control event type.,Extract control event parsing to separate methods,Use one parse method per control event type.
2020,Remove instrumented test dependencies,"The server is not a real Android application, it's just a jar with a main method. Instrumented tests are meaningless in this context.",Remove instrumented test dependencies,"The server is not a real Android application, it's just a jar with a main method. Instrumented tests are meaningless in this context."
2021,Recreate codec and display on rotation changed,"On some devices, we can reuse the same codec and display, but on some others (e.g. Nexus 5X with Android 7.1.2), it crashes on codec.stop() with an IllegalStateException. Therefore, always recreate the codec and display, so that it works on all devices.",Recreate codec and display on rotation changed,"On some devices, we can reuse the same codec and display, but on some others (e.g. Nexus 5X with Android 7.1.2), it crashes on codec.stop() with an IllegalStateException. Therefore, always recreate the codec and display, so that it works on all devices."
2022,Always release output buffer,"If rotation changed, the dequeued output buffer was never released. Move it to a finally block to avoid the leak.",Always release output buffer,"If rotation changed, the dequeued output buffer was never released. Move it to a finally block to avoid the leak."
2023,Add delay before stopping server,Let some time to print any exception trace before killing it.,Add delay before stopping server,Let some time to print any exception trace before killing it.
2024,Log user request to quit,Log at debug level user requests to quit.,Log user request to quit,Log at debug level user requests to quit.
2025,Include dependencies version,"On --version, also print the dependencies version scrcpy has been compiled against.",Include dependencies version,"On --version, also print the dependencies version scrcpy has been compiled against."
2026,Expose application version,Expose scrcpy version via -v or --version.,Expose application version,Expose scrcpy version via -v or --version.
2027,Make SKIP_FRAMES a compilation flag,"The skip_frames flag was a non-configurable runtime flag. Since it is not exposed to the user, there is no need for a (possible) runtime cost. For testing purpose, we still want it to be configurable, so make it a compilation flag.",Make SKIP_FRAMES a compilation flag,"The skip_frames flag was a non-configurable runtime flag. Since it is not exposed to the user, there is no need for a (possible) runtime cost. For testing purpose, we still want it to be configurable, so make it a compilation flag."
2028,Use meson to configure default values,Make meson generate config.h with configured values.,Use meson to configure default values,Make meson generate config.h with configured values.
2029,Change the window icon color in debug mode,"To highlight the debug/release mode of the running application, use a different window icon color in debug mode.",Change the window icon color in debug mode,"To highlight the debug/release mode of the running application, use a different window icon color in debug mode."
2030,Add Makefile recipe for debug build,Expose commands to build the application in debug mode.,Add Makefile recipe for debug build,Expose commands to build the application in debug mode.
2031,Parse XPM without SDL_image,"We encounter some problems with SDL2_image on MSYS2 (Windows), so implement our own XPM parsing which does not depend on SDL_image. The input XPM is considered safe (it's in our source repo), so do not check XPM format errors. This implies that read_xpm() is not safe to call on any unsafe input. Although less straightforward, use SDL_CreateRGBSurfaceFrom() instead of SDL_CreateRGBSurfaceWithFormatFrom() because it is available with SDL versions older than 2.0.5.",Parse XPM without SDL_image,"We encounter some problems with SDL2_image on MSYS2 (Windows), so implement our own XPM parsing which does not depend on SDL_image. The input XPM is considered safe (it's in our source repo), so do not check XPM format errors. This implies that read_xpm() is not safe to call on any unsafe input. Although less straightforward, use SDL_CreateRGBSurfaceFrom() instead of SDL_CreateRGBSurfaceWithFormatFrom() because it is available with SDL versions older than 2.0.5."
2032,"Revert ""Fix Makefile for Windows""","In MSYS2 on Windows, the behavior is the same as on Linux. On systems where the behavior is not the same, just customize the GRADLE variable: GRADLE=gradlew make release  This reverts commit de192cab1b5f0829fedd34d4feb569445c02346c.","Revert ""Fix Makefile for Windows""","In MSYS2 on Windows, the behavior is the same as on Linux. On systems where the behavior is not the same, just customize the GRADLE variable: GRADLE=gradlew make release This reverts commit de192cab1b5f0829fedd34d4feb569445c02346c."
2033,Enable mouse focus clickthrough only if available,The hint SDL_HINT_MOUSE_FOCUS_CLICKTHROUGH appeared in SDL 2.0.5. Ignore it if the SDL version is older.,Enable mouse focus clickthrough only if available,The hint SDL_HINT_MOUSE_FOCUS_CLICKTHROUGH appeared in SDL 2.0.5. Ignore it if the SDL version is older.
2034,Fix Makefile for Windows,"The default value of GRADLE is ""./gradlew"", which is the correct value on Linux. On Windows, it should use gradlew.bat (by calling ""gradlew"") instead.",Fix Makefile for Windows,"The default value of GRADLE is ""./gradlew"", which is the correct value on Linux. On Windows, it should use gradlew.bat (by calling ""gradlew"") instead."
2035,Add window icon,Add a bugdroid icon loaded from an XPM.,Add window icon,Add a bugdroid icon loaded from an XPM.
2036,Fix scrcpy() return value,"The scrcpy() function returns a SDL_bool to indicate its success, but was initialized to 0 (SDL_FALSE) instead of SDL_TRUE.",Fix scrcpy() return value,"The scrcpy() function returns a SDL_bool to indicate its success, but was initialized to 0 (SDL_FALSE) instead of SDL_TRUE."
2037,"Add ""make run""","To run the app during development, add a recipe ""run"" to the Makefile.","Add ""make run""","To run the app during development, add a recipe ""run"" to the Makefile."
2038,Hide services in Device,"Expose useful methods directly in Device, without exposing the service managers.",Hide services in Device,"Expose useful methods directly in Device, without exposing the service managers."
2039,Cache managers in ServiceManager,"To guarantee that we instantiate services only one, cache the value the first time.",Cache managers in ServiceManager,"To guarantee that we instantiate services only one, cache the value the first time."
2040,Refactor actions calls,"The purpose of handle_shortcut() was to group all actions together, whether they are initiated from a text input event or a keycode event. However, it did not handle the case where it was initiated from a mouse event (a right-click must turn the screen on), since the action was identified by the shortcut char. Instead, expose one function per action, to be called directly from where the event is handled.",Refactor actions calls,"The purpose of handle_shortcut() was to group all actions together, whether they are initiated from a text input event or a keycode event. However, it did not handle the case where it was initiated from a mouse event (a right-click must turn the screen on), since the action was identified by the shortcut char. Instead, expose one function per action, to be called directly from where the event is handled."
2041,fixup! Handle all shortcuts in the same function,,fixup! Handle all shortcuts in the same function,
2042,Add new shortcuts description in help,Document the new shortcuts in the help (scrcpy --help).,Add new shortcuts description in help,Document the new shortcuts in the help (scrcpy --help).
2043,Turn screen on on start,"When starting scrcpy, immediately turn the screen on.",Turn screen on on start,"When starting scrcpy, immediately turn the screen on."
2044,Turn screen on on right-click,"The right-click is almost useless on Android, so use it to turn the screen on. Add a new control event type (command) to request the server to turn the screen on.",Turn screen on on right-click,"The right-click is almost useless on Android, so use it to turn the screen on. Add a new control event type (command) to request the server to turn the screen on."
2045,Reformat EventController,Reformated by Android Studio.,Reformat EventController,Reformated by Android Studio.
2046,Handle all shortcuts in the same function,"Shortcuts are sometimes initiated from a keycode event, and sometimes from a text input event. Move the handling to a unique function.",Handle all shortcuts in the same function,"Shortcuts are sometimes initiated from a keycode event, and sometimes from a text input event. Move the handling to a unique function."
2047,Extract shortcut actions to separate functions,"To simplify event handling code, move all actions to separate functions.",Extract shortcut actions to separate functions,"To simplify event handling code, move all actions to separate functions."
2048,Move switch fullscreen logs,Logs were printed by the caller of switch_fullscreen(). Move them inside the function to simplify event handling code.,Move switch fullscreen logs,Logs were printed by the caller of switch_fullscreen(). Move them inside the function to simplify event handling code.
2049,Add shortcuts for physical keys,"Add shortcuts for HOME, BACK, APPS, POWER, VOLUME_UP and VOLUME_DOWN.",Add shortcuts for physical keys,"Add shortcuts for HOME, BACK, APPS, POWER, VOLUME_UP and VOLUME_DOWN."
2050,Rename the server scrcpy-server.jar,"The server is built as an APK to simplify the build, but in fact this is a simple jar (it is not even signed). In order to avoid confusion, rename it to .jar, so that users do not try to ""adb install"" it. Also rename it from ""scrcpy"" to ""scrcpy-server"" to distinguish from the client-side.",Rename the server scrcpy-server.jar,"The server is built as an APK to simplify the build, but in fact this is a simple jar (it is not even signed). In order to avoid confusion, rename it to .jar, so that users do not try to ""adb install"" it. Also rename it from ""scrcpy"" to ""scrcpy-server"" to distinguish from the client-side."
2051,Force the server target filename,"The server path may be customized using SCRCPY_APK. If its basename is different from ""scrcpy.apk"", it will be pushed with a different name, so the execution would fail. Therefore, force the push target filename.",Force the server target filename,"The server path may be customized using SCRCPY_APK. If its basename is different from ""scrcpy.apk"", it will be pushed with a different name, so the execution would fail. Therefore, force the push target filename."
2052,Do not send simple mouse move events,"Moving the mouse without any button pressed has no effect on Android. Therefore, do not even send these very frequent events.",Do not send simple mouse move events,"Moving the mouse without any button pressed has no effect on Android. Therefore, do not even send these very frequent events."
2053,Enable mouse focus clickthrough,Consider a click to gain focus as a click on the device.,Enable mouse focus clickthrough,Consider a click to gain focus as a click on the device.
2054,Add bit-rate command-line option,Add a command-line option (-b/--bit-rate) to customize the video bit-rate.,Add bit-rate command-line option,Add a command-line option (-b/--bit-rate) to customize the video bit-rate.
2055,Check empty string before strtol(),There is no need to call strtol() if the input string is empty.,Check empty string before strtol(),There is no need to call strtol() if the input string is empty.
2056,Remove useless newlines in SDL_Log*,Trailing new line is not necessary in SDL_Log* methods.,Remove useless newlines in SDL_Log,Trailing new line is not necessary in SDL_Log methods.
2057,Add debug log for shortcuts,Add a debug log for every succeeded shortcut action.,Add debug log for shortcuts,Add a debug log for every succeeded shortcut action.
2058,Fix rotation bug in fullscreen mode on X11,"On rotation, scrcpy resize the window to match the new rotation. However, in fullscreen mode, setting the window size does not change the windowed size on X11, so the behavior is incorrect. To avoid the problem, apply the resize only after fullscreen is disabled.",Fix rotation bug in fullscreen mode on X11,"On rotation, scrcpy resize the window to match the new rotation. However, in fullscreen mode, setting the window size does not change the windowed size on X11, so the behavior is incorrect. To avoid the problem, apply the resize only after fullscreen is disabled."
2059,Add --help,"Provide command-line help, with -h/--help option.",Add --help,"Provide command-line help, with -h/--help option."
2060,Rename maximum_size to max_size,"The long option is --max-size, so for consistency, adapt the code accordingly.",Rename maximum_size to max_size,"The long option is --max-size, so for consistency, adapt the code accordingly."
2061,Use long command-line options,"In addition to the short form (e.g. ""-p""), add the long form (""--port"").",Use long command-line options,"In addition to the short form (e.g. ""-p""), add the long form (""--port"")."
2062,Indent switch blocks content,"For readability, indent ""case"" in switch blocks. Replace: switch (x) { case 1:     // ... case 2:     // ... case 3: { // a local scope block     int i = 42;     // ... } }  By: switch (x) {     case 1:         // ...     case 2:         // ...     case 3: { // a local scope block         int i = 42;         // ...     } }",Indent switch blocks content,"For readability, indent ""case"" in switch blocks. Replace: switch (x) { case 1:     // ... case 2:     // ... case 3: { // a local scope block     int i = 42;     // ... } } By: switch (x) {     case 1:         // ...     case 2:         // ...     case 3: { // a local scope block         int i = 42;         // ...     } }"
2063,Use ADB environment variable,Use the ADB environment variable to provide a custom adb path.,Use ADB environment variable,Use the ADB environment variable to provide a custom adb path.
2064,Encode video using MediaCodec API,"Replace screenrecord execution by manual screen encoding using the MediaCodec API. The ""screenrecord"" solution had several drawbacks:  - screenrecord output is buffered, so tiny frames may not be accessible    immediately;  - it did not output a frame until the surface changed, leading to a    black screen on start;  - it is limited to 3 minutes recording, so it needed to be restarted;  - screenrecord added black borders in the video when the requested    dimensions did not preserve aspect-ratio exactly (sometimes    unavoidable since video dimensions must be multiple of 8);  - rotation handling was hacky (killing the process and starting a new    one). Handling the encoding manually allows to solve all these problems.",Encode video using MediaCodec API,"Replace screenrecord execution by manual screen encoding using the MediaCodec API. The ""screenrecord"" solution had several drawbacks:  - screenrecord output is buffered, so tiny frames may not be accessible    immediately;  - it did not output a frame until the surface changed, leading to a    black screen on start;  - it is limited to 3 minutes recording, so it needed to be restarted;  - screenrecord added black borders in the video when the requested    dimensions did not preserve aspect-ratio exactly (sometimes    unavoidable since video dimensions must be multiple of 8);  - rotation handling was hacky (killing the process and starting a new    one). Handling the encoding manually allows to solve all these problems."
2065,Register uncaught exception handler,Never miss an exception by using an uncaught exception handler.,Register uncaught exception handler,Never miss an exception by using an uncaught exception handler.
2066,Extract argument parsing,Move argument parsing to a separate method.,Extract argument parsing,Move argument parsing to a separate method.
2067,Use the Point class from the framework,Replace our custom Point class by android.graphics.Point.,Use the Point class from the framework,Replace our custom Point class by android.graphics.Point.
2068,Convert server to an Android project,"To simplify the device server-side build, use gradle to create an APK, even if we use it as a simple jar, by running its main() method.",Convert server to an Android project,"To simplify the device server-side build, use gradle to create an APK, even if we use it as a simple jar, by running its main() method."
2069,Handle resized video stream,"Accept a parameter to limit the video size. For instance, with ""-m 960"", the great side of the video will be scaled down to 960 (if necessary), while the other side will be scaled down so that the aspect ratio is preserved. Both dimensions must be a multiple of 8, so black bands might be added, and the mouse positions must be computed accordingly.",Handle resized video stream,"Accept a parameter to limit the video size. For instance, with ""-m 960"", the great side of the video will be scaled down to 960 (if necessary), while the other side will be scaled down so that the aspect ratio is preserved. Both dimensions must be a multiple of 8, so black bands might be added, and the mouse positions must be computed accordingly."
2070,Do not use device as a singleton,"The device instance should be able to store a state (e.g. the maximum size requested by the user), so it should not be a singleton.",Do not use device as a singleton,"The device instance should be able to store a state (e.g. the maximum size requested by the user), so it should not be a singleton."
2071,Swap position/point names,A point is a 2D vector. A position represent a point relative to the screen size.,Swap position/point names,A point is a 2D vector. A position represent a point relative to the screen size.
2072,Inject mouse events as touchscreen,"As a mouse, some clicks on close prositions are sometimes not generated on some devices.",Inject mouse events as touchscreen,"As a mouse, some clicks on close prositions are sometimes not generated on some devices."
2073,Add toString() methods to java point classes,Useful for debugging.,Add toString() methods to java point classes,Useful for debugging.
2074,Add missing source files in server Makefile,"All classes were still built, but make was not able to detect changes on missing files.",Add missing source files in server Makefile,"All classes were still built, but make was not able to detect changes on missing files."
2075,Add shortcut to resize to ratio 1:1,Make Ctrl+g resize the window to the size of the video (pixel-perfect).,Add shortcut to resize to ratio 1:1,Make Ctrl+g resize the window to the size of the video (pixel-perfect).
2076,Capture all Ctrl events,"For consistency, capture all Ctrl events (not only those we react to).",Capture all Ctrl events,"For consistency, capture all Ctrl events (not only those we react to)."
2077,Rename screen -> scrcpy -> main,"Rename scrcpy.c to main.c (this file handles the command line parsing), and screen.c to scrcpy.c (it exposes the entry point scrcpy()).",Rename screen -> scrcpy -> main,"Rename scrcpy.c to main.c (this file handles the command line parsing), and screen.c to scrcpy.c (it exposes the entry point scrcpy())."
2078,Scale mouse events,"The video screen size on the client may differ from the real device screen size (e.g. the video stream may be scaled down). As a consequence, mouse events must be scaled to match the real device coordinates. For this purpose, make the client send the video screen size along with the absolute pointer location, and the server scale the location to match the real device size before injecting mouse events.",Scale mouse events,"The video screen size on the client may differ from the real device screen size (e.g. the video stream may be scaled down). As a consequence, mouse events must be scaled to match the real device coordinates. For this purpose, make the client send the video screen size along with the absolute pointer location, and the server scale the location to match the real device size before injecting mouse events."
2079,Keep screen info in cache,"Currently, we only use screen information (width, height, rotation) once at initialization, to send the device size to the client. To be able to scale mouse events, make it accessible in memory. For this purpose, replace the ""static"" DeviceUtil to a singleton Device, and update it on every screen rotation.",Keep screen info in cache,"Currently, we only use screen information (width, height, rotation) once at initialization, to send the device size to the client. To be able to scale mouse events, make it accessible in memory. For this purpose, replace the ""static"" DeviceUtil to a singleton Device, and update it on every screen rotation."
2080,Move server-related functions to server.c,"In addition to the functions to start/stop the server, move the functions to push the jar and enable/disable the ""adb reverse"" tunnel.",Move server-related functions to server.c,"In addition to the functions to start/stop the server, move the functions to push the jar and enable/disable the ""adb reverse"" tunnel."
2081,Add debug log on new screenrecord execution,"To easily notice problems with screenrecord execution, log every new instance started.",Add debug log on new screenrecord execution,"To easily notice problems with screenrecord execution, log every new instance started."
2082,Extract server-related functions,"To lighten screen.c, move start_server() and stop_server() to a separate file.",Extract server-related functions,"To lighten screen.c, move start_server() and stop_server() to a separate file."
2083,Add unit tests for control event serialization,"Test serialization of the 4 types of events (keycode, text, mouse, scroll).",Add unit tests for control event serialization,"Test serialization of the 4 types of events (keycode, text, mouse, scroll)."
2084,Use pointers-to-const where relevant,Explicitly declare const a function parameter intended to be read-only.,Use pointers-to-const where relevant,Explicitly declare const a function parameter intended to be read-only.
2085,Ignore keycodes generating unwanted events,"Ctrl, Alt, Shift and Meta should not be transmitted to the Android device: they may generate unwanted events. For instance, resizing the window using Alt+click will generate an Alt event which may open a menu on the device. All keycodes that generate a text input must also be excluded, to avoid the text input to be written twice.",Ignore keycodes generating unwanted events,"Ctrl, Alt, Shift and Meta should not be transmitted to the Android device: they may generate unwanted events. For instance, resizing the window using Alt+click will generate an Alt event which may open a menu on the device. All keycodes that generate a text input must also be excluded, to avoid the text input to be written twice."
2086,Fix includes windows-specific source,"The header strutil.h is two levels above sys/win/command.c, and SDL_log.h was missing.",Fix includes windows-specific source,"The header strutil.h is two levels above sys/win/command.c, and SDL_log.h was missing."
2087,Add unit testing instructions in README,,Add unit testing instructions in README,
2088,Add tests for strutil,Test our custom string handling functions.,Add tests for strutil,Test our custom string handling functions.
2089,Implement keyboard/mouse control,To control the device from the computer:  - retrieve mouse and keyboard SDL events;  - convert them to Android events;  - serialize them;  - send them on the same socket used by the video stream (but in the  opposite direction);  - deserialize the events on the Android side;  - inject them using the InputManager.,Implement keyboard/mouse control,To control the device from the computer:  - retrieve mouse and keyboard SDL events;  - convert them to Android events;  - serialize them;  - send them on the same socket used by the video stream (but in the  opposite direction);  - deserialize the events on the Android side;  - inject them using the InputManager.
2090,Log to android logger and stdout/stderr,,Log to android logger and stdout/stderr,
2091,Move platform specific to sys/,"Move unix/ and win/ to sys/, so that we can use android/ for android headers without confusion.",Move platform specific to sys/,"Move unix/ and win/ to sys/, so that we can use android/ for android headers without confusion."
2092,Use _exit() instead of exit() in child process,"exit() should not be called from within a child process, since it would call functions registered with atexit(), and flush stdio streams. Use _exit() instead.",Use _exit() instead of exit() in child process,"exit() should not be called from within a child process, since it would call functions registered with atexit(), and flush stdio streams. Use _exit() instead."
2093,Do not call SDL_Quit(),"It may crash in i965_dri.so when calling SDL_Quit (probably a driver bug). To avoid a segmentation fault, do not call SDL_Quit().",Do not call SDL_Quit(),"It may crash in i965_dri.so when calling SDL_Quit (probably a driver bug). To avoid a segmentation fault, do not call SDL_Quit()."
2094,Always destroy in reverse order,"For consistency and safety, always destroy objects in reverse order they were initialized.",Always destroy in reverse order,"For consistency and safety, always destroy objects in reverse order they were initialized."
2095,Improve main() error handling,"Parse the command-line arguments first, and do not ignore avformat network init failure. At the end, deinit the avformat network.",Improve main() error handling,"Parse the command-line arguments first, and do not ignore avformat network init failure. At the end, deinit the avformat network."
2096,Fix comment about data sent over the socket,We now send the device name in addition to the screen dimensions on the socket. Update the comment accordingly.,Fix comment about data sent over the socket,We now send the device name in addition to the screen dimensions on the socket. Update the comment accordingly.
2097,Optimize includes,"Only include SDL_stdinc.h for SDL_bool, not the whole SDL.h.",Optimize includes,"Only include SDL_stdinc.h for SDL_bool, not the whole SDL.h."
2098,Do not inline lockutil functions,This duplicates chars in the final binary.,Do not inline lockutil functions,This duplicates chars in the final binary.
2099,Remove useless forward declarations,The required headers are included anyway.,Remove useless forward declarations,The required headers are included anyway.
2100,Handle condition variable failure,Add condition variables function wrappers to handle unexpected failure.,Handle condition variable failure,Add condition variables function wrappers to handle unexpected failure.
2101,Rename (un)lock_mutex to mutex_(un)lock,"For consistency, rename lock_mutex and unlock_mutex to mutex_lock and mutex_unlock.",Rename (un)lock_mutex to mutex_(un)lock,"For consistency, rename lock_mutex and unlock_mutex to mutex_lock and mutex_unlock."
2102,Fix function signature,Use void for parameters (this project is in C).,Fix function signature,Use void for parameters (this project is in C).
2103,Use SDL_bool return type instead of int,"Many functions returned an int to indicate their success. For clarity, use SDL_bool instead.",Use SDL_bool return type instead of int,"Many functions returned an int to indicate their success. For clarity, use SDL_bool instead."
2104,Destroy condition variable on frames destruction,"A condition variable was init for the ""struct frames"", but was never destroyed.",Destroy condition variable on frames destruction,"A condition variable was init for the ""struct frames"", but was never destroyed."
2105,Implement framework wrappers separately,"Move the DeviceUtil internal static classes to public classes, in a separate package ("".wrappers""). This paves the way to implement InputManager properly.",Implement framework wrappers separately,"Move the DeviceUtil internal static classes to public classes, in a separate package ("".wrappers""). This paves the way to implement InputManager properly."
2106,Send device name on the socket,"Make the server send the device name along with the width and height, so that the client may use it as the window title.",Send device name on the socket,"Make the server send the device name along with the width and height, so that the client may use it as the window title."
2107,Add README,,Add README,
2108,Initial commit,Start a new clean history from here.,Initial commit,Start a new clean history from here.
